{"ast":null,"code":"/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'mode strict';\n\nconst {\n  hasAttribute\n} = require('./NodeUtils');\n\nmodule.exports = {\n  AMP_TAGS: ['amp', '⚡', '⚡4ads', 'amp4ads', '⚡4email', 'amp4email'],\n  AMP_CACHE_HOST: 'https://cdn.ampproject.org',\n  AMP_VALIDATION_RULES_URL: 'https://cdn.ampproject.org/v0/validator.json',\n  AMP_FORMATS: ['AMP', 'AMP4EMAIL', 'AMP4ADS'],\n  AMP_RUNTIME_CSS_PATH: '/v0.css',\n  appendRuntimeVersion: (prefix, version) => prefix + '/rtv/' + version,\n  isTemplate: node => {\n    if (node.tagName === 'template') {\n      return true;\n    }\n\n    if (node.tagName === 'script' && hasAttribute(node, 'template') && node.attribs.template === 'amp-mustache') {\n      return true;\n    }\n\n    return false;\n  },\n  isAmpStory: head => {\n    for (const node of head.children) {\n      if (isAmpScriptImport(node) && node.attribs['custom-element'] === 'amp-story') {\n        return true;\n      }\n    }\n\n    return false;\n  }\n};\n\nfunction isAmpScriptImport(scriptNode) {\n  if (scriptNode.tagName !== 'script') {\n    return false;\n  }\n\n  if (!scriptNode.attribs) {\n    return false;\n  }\n\n  const customElement = scriptNode.attribs['custom-element'] || scriptNode.attribs['custom-template'] || '';\n\n  if (!customElement.startsWith('amp-')) {\n    return false;\n  }\n\n  return true;\n}","map":{"version":3,"sources":["/Users/bruceseymour/ra-video/client/node_modules/@ampproject/toolbox-optimizer/lib/AmpConstants.js"],"names":["hasAttribute","require","module","exports","AMP_TAGS","AMP_CACHE_HOST","AMP_VALIDATION_RULES_URL","AMP_FORMATS","AMP_RUNTIME_CSS_PATH","appendRuntimeVersion","prefix","version","isTemplate","node","tagName","attribs","template","isAmpStory","head","children","isAmpScriptImport","scriptNode","customElement","startsWith"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAM;AAACA,EAAAA;AAAD,IAAiBC,OAAO,CAAC,aAAD,CAA9B;;AAEAC,MAAM,CAACC,OAAP,GAAiB;AACfC,EAAAA,QAAQ,EAAE,CAAC,KAAD,EAAQ,GAAR,EAAa,OAAb,EAAsB,SAAtB,EAAiC,SAAjC,EAA4C,WAA5C,CADK;AAEfC,EAAAA,cAAc,EAAE,4BAFD;AAGfC,EAAAA,wBAAwB,EAAE,8CAHX;AAIfC,EAAAA,WAAW,EAAE,CAAC,KAAD,EAAQ,WAAR,EAAqB,SAArB,CAJE;AAKfC,EAAAA,oBAAoB,EAAE,SALP;AAMfC,EAAAA,oBAAoB,EAAE,CAACC,MAAD,EAASC,OAAT,KAAqBD,MAAM,GAAG,OAAT,GAAmBC,OAN/C;AAOfC,EAAAA,UAAU,EAAGC,IAAD,IAAU;AACpB,QAAIA,IAAI,CAACC,OAAL,KAAiB,UAArB,EAAiC;AAC/B,aAAO,IAAP;AACD;;AACD,QACED,IAAI,CAACC,OAAL,KAAiB,QAAjB,IACAd,YAAY,CAACa,IAAD,EAAO,UAAP,CADZ,IAEAA,IAAI,CAACE,OAAL,CAAaC,QAAb,KAA0B,cAH5B,EAIE;AACA,aAAO,IAAP;AACD;;AACD,WAAO,KAAP;AACD,GAnBc;AAoBfC,EAAAA,UAAU,EAAGC,IAAD,IAAU;AACpB,SAAK,MAAML,IAAX,IAAmBK,IAAI,CAACC,QAAxB,EAAkC;AAChC,UAAIC,iBAAiB,CAACP,IAAD,CAAjB,IAA2BA,IAAI,CAACE,OAAL,CAAa,gBAAb,MAAmC,WAAlE,EAA+E;AAC7E,eAAO,IAAP;AACD;AACF;;AACD,WAAO,KAAP;AACD;AA3Bc,CAAjB;;AA8BA,SAASK,iBAAT,CAA2BC,UAA3B,EAAuC;AACrC,MAAIA,UAAU,CAACP,OAAX,KAAuB,QAA3B,EAAqC;AACnC,WAAO,KAAP;AACD;;AACD,MAAI,CAACO,UAAU,CAACN,OAAhB,EAAyB;AACvB,WAAO,KAAP;AACD;;AACD,QAAMO,aAAa,GACjBD,UAAU,CAACN,OAAX,CAAmB,gBAAnB,KAAwCM,UAAU,CAACN,OAAX,CAAmB,iBAAnB,CAAxC,IAAiF,EADnF;;AAEA,MAAI,CAACO,aAAa,CAACC,UAAd,CAAyB,MAAzB,CAAL,EAAuC;AACrC,WAAO,KAAP;AACD;;AACD,SAAO,IAAP;AACD","sourcesContent":["/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'mode strict';\n\nconst {hasAttribute} = require('./NodeUtils');\n\nmodule.exports = {\n  AMP_TAGS: ['amp', '⚡', '⚡4ads', 'amp4ads', '⚡4email', 'amp4email'],\n  AMP_CACHE_HOST: 'https://cdn.ampproject.org',\n  AMP_VALIDATION_RULES_URL: 'https://cdn.ampproject.org/v0/validator.json',\n  AMP_FORMATS: ['AMP', 'AMP4EMAIL', 'AMP4ADS'],\n  AMP_RUNTIME_CSS_PATH: '/v0.css',\n  appendRuntimeVersion: (prefix, version) => prefix + '/rtv/' + version,\n  isTemplate: (node) => {\n    if (node.tagName === 'template') {\n      return true;\n    }\n    if (\n      node.tagName === 'script' &&\n      hasAttribute(node, 'template') &&\n      node.attribs.template === 'amp-mustache'\n    ) {\n      return true;\n    }\n    return false;\n  },\n  isAmpStory: (head) => {\n    for (const node of head.children) {\n      if (isAmpScriptImport(node) && node.attribs['custom-element'] === 'amp-story') {\n        return true;\n      }\n    }\n    return false;\n  },\n};\n\nfunction isAmpScriptImport(scriptNode) {\n  if (scriptNode.tagName !== 'script') {\n    return false;\n  }\n  if (!scriptNode.attribs) {\n    return false;\n  }\n  const customElement =\n    scriptNode.attribs['custom-element'] || scriptNode.attribs['custom-template'] || '';\n  if (!customElement.startsWith('amp-')) {\n    return false;\n  }\n  return true;\n}\n"]},"metadata":{},"sourceType":"script"}