{"ast":null,"code":"var _jsxFileName = \"/Users/bruceseymour/ra-video/client/src/App.js\";\nimport React, { useEffect, useState, useRef, Suspense } from 'react';\nimport io from \"socket.io-client\";\nimport Peer from \"simple-peer\";\nimport Rodal from 'rodal';\nimport { Howl } from 'howler';\nimport Navigation from './Components/Navigation/Navigation';\nimport Footer from './Components/Footer/Footer';\nimport 'rodal/lib/rodal.css';\nimport camera from \"./Icons/camera.svg\";\nimport camerastop from \"./Icons/camera-stop.svg\";\nimport microphone from \"./Icons/microphone.svg\";\nimport microphonestop from \"./Icons/microphone-stop.svg\";\nimport share from \"./Icons/share.svg\";\nimport hangup from \"./Icons/hang-up.svg\";\nimport fullscreen from \"./Icons/fullscreen.svg\";\nimport minimize from \"./Icons/minimize.svg\";\nimport ringtone from './Sounds/ringtone.mp3'; //const Watermark = React.lazy(()=>import('./Components/Watermark/Watermark'))\n\nconsole.log(\"Starting App\");\nconst ringtoneSound = new Howl({\n  src: [ringtone],\n  loop: true,\n  preload: true\n});\n\nfunction App() {\n  const [yourID, setYourID] = useState(\"\");\n  const [users, setUsers] = useState({});\n  const [stream, setStream] = useState();\n  const [receivingCall, setReceivingCall] = useState(false);\n  const [caller, setCaller] = useState(\"\");\n  const [callingFriend, setCallingFriend] = useState(false);\n  const [callerSignal, setCallerSignal] = useState();\n  const [callAccepted, setCallAccepted] = useState(false);\n  const [callRejected, setCallRejected] = useState(false);\n  const [receiverID, setReceiverID] = useState('');\n  const [modalVisible, setModalVisible] = useState(false);\n  const [modalMessage, setModalMessage] = useState('');\n  const [audioMuted, setAudioMuted] = useState(false);\n  const [videoMuted, setVideoMuted] = useState(false);\n  const [isfullscreen, setFullscreen] = useState(false);\n  const [copied, setCopied] = useState(false);\n  const userVideo = useRef();\n  const partnerVideo = useRef();\n  const socket = useRef();\n  const myPeer = useRef();\n  const [autoAccepted, setAutoAccepted] = useState(false);\n  let landingHTML = /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Navigation, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(\"main\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"u-margin-top-xxlarge u-margin-bottom-xxlarge\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"o-wrapper-l\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"hero flex flex-column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"descriptionText\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"actionText\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 17\n    }\n  }, \"Session ID:\", /*#__PURE__*/React.createElement(\"span\", {\n    className: copied ? \"username highlight copied\" : \"username highlight\",\n    onClick: () => {\n      showCopiedMessage();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 56\n    }\n  }, yourID))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"callBox flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Session ID\",\n    value: receiverID,\n    onChange: e => setReceiverID(e.target.value),\n    className: \"form-input\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => callPeer(receiverID.toLowerCase().trim()),\n    className: \"primaryButton\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  }, \"Connect\")))))), /*#__PURE__*/React.createElement(Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 5\n    }\n  }));\n  useEffect(() => {\n    socket.current = io.connect(\"/\");\n    socket.current.on(\"yourID\", id => {\n      setYourID(id);\n    });\n    socket.current.on(\"allUsers\", users => {\n      setUsers(users);\n    });\n    socket.current.on(\"hey\", data => {\n      setReceivingCall(true);\n      ringtoneSound.play();\n      setCaller(data.from);\n      setCallerSignal(data.signal);\n    });\n  }, []);\n\n  function callPeer(id) {\n    if (id !== '' && users[id] && id !== yourID) {\n      navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      }).then(stream => {\n        setStream(stream);\n        setCallingFriend(true);\n        setCaller(id);\n\n        if (userVideo.current) {\n          userVideo.current.srcObject = stream;\n        }\n\n        const peer = new Peer({\n          initiator: true,\n          trickle: false,\n          config: {\n            iceServers: [{\n              urls: \"stun:numb.viagenie.ca\",\n              username: \"sultan1640@gmail.com\",\n              credential: \"98376683\"\n            }, {\n              urls: \"turn:numb.viagenie.ca\",\n              username: \"sultan1640@gmail.com\",\n              credential: \"98376683\"\n            }]\n          },\n          stream: stream\n        });\n        myPeer.current = peer;\n        peer.on(\"signal\", data => {\n          socket.current.emit(\"callUser\", {\n            userToCall: id,\n            signalData: data,\n            from: yourID\n          });\n        });\n        peer.on(\"stream\", stream => {\n          if (partnerVideo.current) {\n            partnerVideo.current.srcObject = stream;\n          }\n        });\n        peer.on('error', err => {\n          endCall();\n        });\n        socket.current.on(\"callAccepted\", signal => {\n          setCallAccepted(true);\n          peer.signal(signal);\n        });\n        socket.current.on('close', () => {\n          window.location.reload();\n        });\n        socket.current.on('rejected', () => {\n          window.location.reload();\n        });\n      }).catch(() => {\n        setModalMessage('You cannot place/ receive a call without granting video and audio permissions! Please change your settings to use Cuckoo.');\n        setModalVisible(true);\n      });\n    } else {\n      setModalMessage('We think the username entered is wrong. Please check again and retry!');\n      setModalVisible(true);\n      return;\n    }\n  }\n\n  function autoAcceptCall() {\n    setAutoAccepted(true);\n    renderCall();\n    ringtoneSound.unload(); //   console.log(\n    //     navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(console.log(\"here\"))\n    // );\n\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(stream => {\n      setStream(stream);\n      console.log(\"Stream\", stream);\n      userVideo.current.srcObject = stream;\n      setCallAccepted(true);\n      console.log(\"Call Accepted: \", callAccepted);\n      const peer = new Peer({\n        initiator: false,\n        trickle: false,\n        stream: stream\n      });\n      console.log(\"Peer: \", peer);\n      peer.on(\"signal\", data => {\n        socket.current.emit(\"acceptCall\", {\n          signal: data,\n          to: caller\n        });\n      });\n      peer.on(\"stream\", stream => {\n        partnerVideo.current.srcObject = stream;\n      });\n      peer.on('error', err => {\n        console.log(\"Error: \", err);\n        endCall();\n      });\n      peer.signal(callerSignal);\n      socket.current.on('close', () => {\n        window.location.reload();\n      });\n    }).catch(() => {\n      setModalMessage('You cannot place/ receive a call without granting video and audio permissions! Please change your settings to use Cuckoo.');\n      setModalVisible(true);\n    });\n    console.log(\"Auto Accept Call: \", \"Receiving:\", receivingCall, \"Accepted\", callAccepted, \"Rejected: \", callRejected, \"AutoAccept: \", autoAccepted);\n  }\n\n  function acceptCall() {\n    console.log(\"Manually Accepting Call\");\n    ringtoneSound.unload();\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(stream => {\n      setStream(stream);\n      console.log(\"Stream\", stream);\n\n      if (userVideo.current) {\n        userVideo.current.srcObject = stream;\n      }\n\n      setCallAccepted(true);\n      console.log(\"Manual Call Accepted: \", callAccepted);\n      const peer = new Peer({\n        initiator: false,\n        trickle: false,\n        stream: stream\n      });\n      console.log(\"Manual Call Peer: \", peer);\n      myPeer.current = peer;\n      peer.on(\"signal\", data => {\n        socket.current.emit(\"acceptCall\", {\n          signal: data,\n          to: caller\n        });\n      });\n      peer.on(\"stream\", stream => {\n        partnerVideo.current.srcObject = stream;\n      });\n      peer.on('error', err => {\n        console.log(\"Error: \", err);\n        endCall();\n      });\n      peer.signal(callerSignal);\n      socket.current.on('close', () => {\n        window.location.reload();\n      });\n    }).catch(() => {\n      setModalMessage('You cannot place/ receive a call without granting video and audio permissions! Please change your settings to use Cuckoo.');\n      setModalVisible(true);\n    });\n    console.log(\"Manual Accept Call: \", \"Receiving:\", receivingCall, \"Accepted\", callAccepted, \"Rejected: \", callRejected, \"AutoAccept: \", autoAccepted);\n  }\n\n  function wait(ms) {\n    var start = new Date().getTime();\n    var end = start;\n\n    while (end < start + ms) {\n      end = new Date().getTime();\n    }\n  }\n\n  function rejectCall() {\n    ringtoneSound.unload();\n    setCallRejected(true);\n    socket.current.emit('rejected', {\n      to: caller\n    });\n    window.location.reload();\n  }\n\n  function endCall() {\n    myPeer.current.destroy();\n    socket.current.emit('close', {\n      to: caller\n    });\n    window.location.reload();\n  }\n\n  function shareScreen() {\n    navigator.mediaDevices.getDisplayMedia({\n      cursor: true\n    }).then(screenStream => {\n      myPeer.current.replaceTrack(stream.getVideoTracks()[0], screenStream.getVideoTracks()[0], stream);\n      userVideo.current.srcObject = screenStream;\n\n      screenStream.getTracks()[0].onended = () => {\n        myPeer.current.replaceTrack(screenStream.getVideoTracks()[0], stream.getVideoTracks()[0], stream);\n        userVideo.current.srcObject = stream;\n      };\n    });\n  }\n\n  function toggleMuteAudio() {\n    if (stream) {\n      setAudioMuted(!audioMuted);\n      stream.getAudioTracks()[0].enabled = audioMuted;\n    }\n  }\n\n  function toggleMuteVideo() {\n    if (stream) {\n      setVideoMuted(!videoMuted);\n      stream.getVideoTracks()[0].enabled = videoMuted;\n    }\n  }\n\n  function renderLanding() {\n    if (!callRejected && !callAccepted && !callingFriend) return 'block';\n    return 'none';\n  }\n\n  function renderCall() {\n    if (!callRejected && !callAccepted && !callingFriend) return 'none';\n    return 'block';\n  }\n\n  function isMobileDevice() {\n    let check = false;\n\n    (function (a) {\n      if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true;\n    })(navigator.userAgent || navigator.vendor || window.opera);\n\n    return check;\n  }\n\n  ;\n\n  function showCopiedMessage() {\n    navigator.clipboard.writeText(yourID);\n    setCopied(true);\n    setInterval(() => {\n      setCopied(false);\n    }, 1000);\n  }\n\n  let UserVideo;\n\n  if (stream) {\n    UserVideo = /*#__PURE__*/React.createElement(\"video\", {\n      className: \"userVideo\",\n      playsInline: true,\n      muted: true,\n      ref: userVideo,\n      autoPlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 7\n      }\n    });\n  }\n\n  let PartnerVideo;\n\n  if (callAccepted && isfullscreen) {\n    PartnerVideo = /*#__PURE__*/React.createElement(\"video\", {\n      className: \"partnerVideo cover\",\n      playsInline: true,\n      ref: partnerVideo,\n      autoPlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 7\n      }\n    });\n  } else if (callAccepted && !isfullscreen) {\n    PartnerVideo = /*#__PURE__*/React.createElement(\"video\", {\n      className: \"partnerVideo\",\n      playsInline: true,\n      ref: partnerVideo,\n      autoPlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 7\n      }\n    });\n  } //  let incomingCall= (<div>{autoAcceptCall}</div>);\n  // let incomingCall;\n  // console.log(receivingCall, callAccepted, callRejected);\n  //\n  // if (receivingCall && !callAccepted && !callRejected){\n  //   console.log(receivingCall, callAccepted, callRejected);\n  //   incomingCall= \"\";\n  //   setCallAccepted(true);\n  //   acceptCall();\n  // }\n\n\n  let incomingCall;\n\n  if (receivingCall && !callAccepted && !callRejected && !autoAccepted) {\n    //  console.log(\"Receiving:\", receivingCall, \"Accepted\", callAccepted, \"Rejected: \",callRejected, \"AutoAccept: \",autoAccepted)\n    autoAcceptCall();\n    incomingCall = /*#__PURE__*/React.createElement(\"div\", {\n      className: \"incomingCallContainer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"incomingCall flex flex-column\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"callerID\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 16\n      }\n    }, caller), \" is calling you!\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"incomingCallButtons flex\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      name: \"accept\",\n      className: \"alertButtonPrimary\",\n      onClick: () => acceptCall(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 11\n      }\n    }, \"Accept\"), /*#__PURE__*/React.createElement(\"button\", {\n      name: \"reject\",\n      className: \"alertButtonSecondary\",\n      onClick: () => rejectCall(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 11\n      }\n    }, \"Reject\"))));\n  }\n\n  let audioControl;\n\n  if (audioMuted) {\n    audioControl = /*#__PURE__*/React.createElement(\"span\", {\n      className: \"iconContainer\",\n      onClick: () => toggleMuteAudio(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 18\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: microphonestop,\n      alt: \"Unmute audio\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 7\n      }\n    }));\n  } else {\n    audioControl = /*#__PURE__*/React.createElement(\"span\", {\n      className: \"iconContainer\",\n      onClick: () => toggleMuteAudio(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 18\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: microphone,\n      alt: \"Mute audio\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 7\n      }\n    }));\n  }\n\n  let videoControl;\n\n  if (videoMuted) {\n    videoControl = /*#__PURE__*/React.createElement(\"span\", {\n      className: \"iconContainer\",\n      onClick: () => toggleMuteVideo(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 18\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: camerastop,\n      alt: \"Resume video\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 7\n      }\n    }));\n  } else {\n    videoControl = /*#__PURE__*/React.createElement(\"span\", {\n      className: \"iconContainer\",\n      onClick: () => toggleMuteVideo(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 433,\n        columnNumber: 18\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: camera,\n      alt: \"Stop audio\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 7\n      }\n    }));\n  }\n\n  let screenShare = /*#__PURE__*/React.createElement(\"span\", {\n    className: \"iconContainer\",\n    onClick: () => shareScreen(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: share,\n    alt: \"Share screen\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 439,\n      columnNumber: 5\n    }\n  }));\n\n  if (isMobileDevice()) {\n    screenShare = /*#__PURE__*/React.createElement(React.Fragment, null);\n  }\n\n  let hangUp = /*#__PURE__*/React.createElement(\"span\", {\n    className: \"iconContainer\",\n    onClick: () => endCall(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 14\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: hangup,\n    alt: \"End call\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 5\n    }\n  }));\n  let fullscreenButton;\n\n  if (isfullscreen) {\n    fullscreenButton = /*#__PURE__*/React.createElement(\"span\", {\n      className: \"iconContainer\",\n      onClick: () => {\n        setFullscreen(false);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 22\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: minimize,\n      alt: \"fullscreen\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 7\n      }\n    }));\n  } else {\n    fullscreenButton = /*#__PURE__*/React.createElement(\"span\", {\n      className: \"iconContainer\",\n      onClick: () => {\n        setFullscreen(true);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 455,\n        columnNumber: 22\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: fullscreen,\n      alt: \"fullscreen\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 7\n      }\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: renderLanding()\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 462,\n      columnNumber: 7\n    }\n  }, landingHTML, /*#__PURE__*/React.createElement(Rodal, {\n    visible: modalVisible,\n    onClose: () => setModalVisible(false),\n    width: 20,\n    height: 5,\n    measure: 'em',\n    closeOnEsc: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 11\n    }\n  }, modalMessage)), incomingCall), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"callContainer\",\n    style: {\n      display: renderCall()\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 476,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Suspense, {\n    fallback: /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 29\n      }\n    }, \"Loading...\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"partnerVideoContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 480,\n      columnNumber: 9\n    }\n  }, PartnerVideo), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"userVideoContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 483,\n      columnNumber: 9\n    }\n  }, UserVideo), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"controlsContainer flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 486,\n      columnNumber: 9\n    }\n  }, audioControl, videoControl, screenShare, fullscreenButton, hangUp)));\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/bruceseymour/ra-video/client/src/App.js"],"names":["React","useEffect","useState","useRef","Suspense","io","Peer","Rodal","Howl","Navigation","Footer","ringtone","console","log","ringtoneSound","src","loop","preload","App","yourID","setYourID","users","setUsers","stream","setStream","receivingCall","setReceivingCall","caller","setCaller","callingFriend","setCallingFriend","callerSignal","setCallerSignal","callAccepted","setCallAccepted","callRejected","setCallRejected","receiverID","setReceiverID","modalVisible","setModalVisible","modalMessage","setModalMessage","audioMuted","setAudioMuted","videoMuted","setVideoMuted","isfullscreen","setFullscreen","copied","setCopied","userVideo","partnerVideo","socket","myPeer","autoAccepted","setAutoAccepted","landingHTML","showCopiedMessage","e","target","value","callPeer","toLowerCase","trim","current","connect","on","id","data","play","from","signal","navigator","mediaDevices","getUserMedia","video","audio","then","srcObject","peer","initiator","trickle","config","iceServers","urls","username","credential","emit","userToCall","signalData","err","endCall","window","location","reload","catch","autoAcceptCall","renderCall","unload","to","acceptCall","wait","ms","start","Date","getTime","end","rejectCall","destroy","shareScreen","getDisplayMedia","cursor","screenStream","replaceTrack","getVideoTracks","getTracks","onended","toggleMuteAudio","getAudioTracks","enabled","toggleMuteVideo","renderLanding","isMobileDevice","check","a","test","substr","userAgent","vendor","opera","clipboard","writeText","setInterval","UserVideo","PartnerVideo","incomingCall","audioControl","microphonestop","microphone","videoControl","camerastop","camera","screenShare","share","hangUp","hangup","fullscreenButton","minimize","fullscreen","display"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef, Suspense } from 'react';\nimport io from \"socket.io-client\";\nimport Peer from \"simple-peer\";\nimport Rodal from 'rodal'\nimport {Howl} from 'howler'\n\nimport Navigation from './Components/Navigation/Navigation'\nimport Footer from './Components/Footer/Footer'\n\nimport  'rodal/lib/rodal.css'\n\nimport camera from './Icons/camera.svg'\nimport camerastop from './Icons/camera-stop.svg'\nimport microphone from './Icons/microphone.svg'\nimport microphonestop from './Icons/microphone-stop.svg'\nimport share from './Icons/share.svg'\nimport hangup from './Icons/hang-up.svg'\nimport fullscreen from './Icons/fullscreen.svg'\nimport minimize from './Icons/minimize.svg'\nimport ringtone from './Sounds/ringtone.mp3'\n\n//const Watermark = React.lazy(()=>import('./Components/Watermark/Watermark'))\nconsole.log(\"Starting App\");\n\nconst ringtoneSound = new Howl({\n  src: [ringtone],\n  loop: true,\n  preload: true\n})\n\nfunction App() {\n  const [yourID, setYourID] = useState(\"\");\n  const [users, setUsers] = useState({});\n  const [stream, setStream] = useState();\n  const [receivingCall, setReceivingCall] = useState(false);\n  const [caller, setCaller] = useState(\"\");\n  const [callingFriend, setCallingFriend] = useState(false);\n  const [callerSignal, setCallerSignal] = useState();\n  const [callAccepted, setCallAccepted] = useState(false);\n  const [callRejected, setCallRejected] = useState(false);\n  const [receiverID, setReceiverID] = useState('')\n  const [modalVisible, setModalVisible] = useState(false)\n  const [modalMessage, setModalMessage] = useState('')\n  const [audioMuted, setAudioMuted] = useState(false)\n  const [videoMuted, setVideoMuted] = useState(false)\n  const [isfullscreen, setFullscreen] = useState(false)\n  const [copied, setCopied] = useState(false)\n  const userVideo = useRef();\n  const partnerVideo = useRef();\n  const socket = useRef();\n  const myPeer = useRef();\n\n  const [autoAccepted, setAutoAccepted] = useState(false)\n\n\n  let landingHTML=<>\n    <Navigation/>\n    <main>\n      <div className=\"u-margin-top-xxlarge u-margin-bottom-xxlarge\">\n    <div className=\"o-wrapper-l\">\n        <div className=\"hero flex flex-column\">\n            <div>\n                <div className=\"descriptionText\">\n\n                </div>\n            </div>\n            <div>\n                <div className=\"actionText\">Session ID:<span className={copied?\"username highlight copied\":\"username highlight\"} onClick={()=>{showCopiedMessage()}}>{yourID}</span></div>\n            </div>\n            <div className=\"callBox flex\">\n                <input type=\"text\" placeholder=\"Session ID\" value={receiverID} onChange={e => setReceiverID(e.target.value)} className=\"form-input\"/>\n                <button onClick={() => callPeer(receiverID.toLowerCase().trim())} className=\"primaryButton\">Connect</button>\n            </div>\n        </div>\n    </div>\n    </div>\n    </main>\n    <Footer/>\n  </>\n\n  useEffect(() => {\n    socket.current = io.connect(\"/\");\n\n    socket.current.on(\"yourID\", (id) => {\n      setYourID(id);\n    })\n    socket.current.on(\"allUsers\", (users) => {\n      setUsers(users);\n    })\n\n    socket.current.on(\"hey\", (data) => {\n      setReceivingCall(true);\n      ringtoneSound.play();\n      setCaller(data.from);\n      setCallerSignal(data.signal);\n    })\n  }, []);\n\n  function callPeer(id) {\n    if(id!=='' && users[id] && id!==yourID){\n      navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {\n        setStream(stream);\n        setCallingFriend(true)\n        setCaller(id)\n        if (userVideo.current) {\n          userVideo.current.srcObject = stream;\n        }\n        const peer = new Peer({\n          initiator: true,\n          trickle: false,\n          config: {\n\n            iceServers: [\n                {\n                    urls: \"stun:numb.viagenie.ca\",\n                    username: \"sultan1640@gmail.com\",\n                    credential: \"98376683\"\n                },\n                {\n                    urls: \"turn:numb.viagenie.ca\",\n                    username: \"sultan1640@gmail.com\",\n                    credential: \"98376683\"\n                }\n            ]\n        },\n          stream: stream,\n        });\n\n        myPeer.current=peer;\n\n        peer.on(\"signal\", data => {\n          socket.current.emit(\"callUser\", { userToCall: id, signalData: data, from: yourID })\n        })\n\n        peer.on(\"stream\", stream => {\n          if (partnerVideo.current) {\n            partnerVideo.current.srcObject = stream;\n          }\n        });\n\n        peer.on('error', (err)=>{\n          endCall()\n        })\n\n        socket.current.on(\"callAccepted\", signal => {\n          setCallAccepted(true);\n          peer.signal(signal);\n        })\n\n        socket.current.on('close', ()=>{\n          window.location.reload()\n        })\n\n        socket.current.on('rejected', ()=>{\n          window.location.reload()\n        })\n      })\n      .catch(()=>{\n        setModalMessage('You cannot place/ receive a call without granting video and audio permissions! Please change your settings to use Cuckoo.')\n        setModalVisible(true)\n      })\n    } else {\n      setModalMessage('We think the username entered is wrong. Please check again and retry!')\n      setModalVisible(true)\n      return\n    }\n  }\n\n\nfunction autoAcceptCall(){\n setAutoAccepted(true);\n renderCall();\n\n    ringtoneSound.unload();\n\n  //   console.log(\n  //     navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(console.log(\"here\"))\n  // );\n\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {\n      setStream(stream);\n        console.log(\"Stream\", stream);\n        userVideo.current.srcObject = stream;\n\n      setCallAccepted(true);\n        console.log(\"Call Accepted: \", callAccepted);\n\n      const peer = new Peer({\n        initiator: false,\n        trickle: false,\n        stream: stream,\n      });\n\n      console.log(\"Peer: \", peer);\n\n\n      peer.on(\"signal\", data => {\n        socket.current.emit(\"acceptCall\", { signal: data, to: caller })\n      })\n\n      peer.on(\"stream\", stream => {\n        partnerVideo.current.srcObject = stream;\n      });\n\n      peer.on('error', (err)=>{\n        console.log(\"Error: \", err)\n        endCall()\n      })\n\n      peer.signal(callerSignal);\n\n      socket.current.on('close', ()=>{\n        window.location.reload()\n      })\n\n\n    })\n    .catch(()=>{\n      setModalMessage('You cannot place/ receive a call without granting video and audio permissions! Please change your settings to use Cuckoo.')\n      setModalVisible(true)\n    })\n\nconsole.log(\"Auto Accept Call: \", \"Receiving:\", receivingCall, \"Accepted\", callAccepted, \"Rejected: \",callRejected, \"AutoAccept: \",autoAccepted)\n\n\n}\n\n\nfunction acceptCall() {\n    console.log(\"Manually Accepting Call\");\n\n    ringtoneSound.unload();\n\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {\n      setStream(stream);\n      console.log(\"Stream\", stream);\n      if (userVideo.current) {\n        userVideo.current.srcObject = stream;\n      }\n\n      setCallAccepted(true);\n      console.log(\"Manual Call Accepted: \", callAccepted);\n      const peer = new Peer({\n        initiator: false,\n        trickle: false,\n        stream: stream,\n      });\n      console.log(\"Manual Call Peer: \", peer);\n\n\n      myPeer.current=peer\n\n      peer.on(\"signal\", data => {\n        socket.current.emit(\"acceptCall\", { signal: data, to: caller })\n      })\n\n      peer.on(\"stream\", stream => {\n        partnerVideo.current.srcObject = stream;\n      });\n\n      peer.on('error', (err)=>{\n        console.log(\"Error: \", err)\n        endCall()\n      })\n\n      peer.signal(callerSignal);\n\n      socket.current.on('close', ()=>{\n        window.location.reload()\n      })\n\n\n    })\n    .catch(()=>{\n      setModalMessage('You cannot place/ receive a call without granting video and audio permissions! Please change your settings to use Cuckoo.')\n      setModalVisible(true)\n    })\n\n    console.log(\"Manual Accept Call: \", \"Receiving:\", receivingCall, \"Accepted\", callAccepted, \"Rejected: \",callRejected, \"AutoAccept: \",autoAccepted)\n\n\n  }\n\n  function wait(ms){\n     var start = new Date().getTime();\n     var end = start;\n     while(end < start + ms) {\n       end = new Date().getTime();\n    }\n  }\n\n  function rejectCall(){\n    ringtoneSound.unload();\n    setCallRejected(true)\n    socket.current.emit('rejected', {to:caller})\n    window.location.reload()\n  }\n\n  function endCall(){\n    myPeer.current.destroy()\n    socket.current.emit('close',{to:caller})\n    window.location.reload()\n  }\n\n  function shareScreen(){\n    navigator.mediaDevices.getDisplayMedia({cursor:true})\n    .then(screenStream=>{\n      myPeer.current.replaceTrack(stream.getVideoTracks()[0],screenStream.getVideoTracks()[0],stream)\n      userVideo.current.srcObject=screenStream\n      screenStream.getTracks()[0].onended = () =>{\n      myPeer.current.replaceTrack(screenStream.getVideoTracks()[0],stream.getVideoTracks()[0],stream)\n      userVideo.current.srcObject=stream\n      }\n    })\n  }\n\n  function toggleMuteAudio(){\n    if(stream){\n      setAudioMuted(!audioMuted)\n      stream.getAudioTracks()[0].enabled = audioMuted\n    }\n  }\n\n  function toggleMuteVideo(){\n    if(stream){\n      setVideoMuted(!videoMuted)\n      stream.getVideoTracks()[0].enabled = videoMuted\n    }\n  }\n\n  function renderLanding() {\n    if(!callRejected && !callAccepted && !callingFriend)\n      return 'block'\n    return 'none'\n  }\n\n  function renderCall() {\n    if(!callRejected && !callAccepted && !callingFriend)\n      return 'none'\n    return 'block'\n  }\n\n  function isMobileDevice() {\n    let check = false;\n    (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);\n    return check;\n  };\n\n  function showCopiedMessage(){\n    navigator.clipboard.writeText(yourID)\n    setCopied(true)\n    setInterval(()=>{\n      setCopied(false)\n    },1000)\n  }\n\n  let UserVideo;\n  if (stream) {\n    UserVideo = (\n      <video className=\"userVideo\" playsInline muted ref={userVideo} autoPlay />\n    );\n  }\n\n  let PartnerVideo;\n  if (callAccepted && isfullscreen) {\n    PartnerVideo = (\n      <video className=\"partnerVideo cover\" playsInline ref={partnerVideo} autoPlay />\n    );\n  } else if (callAccepted && !isfullscreen){\n    PartnerVideo = (\n      <video className=\"partnerVideo\" playsInline ref={partnerVideo} autoPlay />\n    );\n  }\n\n//  let incomingCall= (<div>{autoAcceptCall}</div>);\n  // let incomingCall;\n  // console.log(receivingCall, callAccepted, callRejected);\n  //\n  // if (receivingCall && !callAccepted && !callRejected){\n  //   console.log(receivingCall, callAccepted, callRejected);\n  //   incomingCall= \"\";\n  //   setCallAccepted(true);\n  //   acceptCall();\n  // }\n\n\n  let incomingCall;\n  if (receivingCall && !callAccepted && !callRejected &&!autoAccepted) {\n  //  console.log(\"Receiving:\", receivingCall, \"Accepted\", callAccepted, \"Rejected: \",callRejected, \"AutoAccept: \",autoAccepted)\n    autoAcceptCall();\n\n    incomingCall = (\n      <div className=\"incomingCallContainer\">\n        <div className=\"incomingCall flex flex-column\">\n          <div><span className=\"callerID\">{caller}</span> is calling you!</div>\n          <div className=\"incomingCallButtons flex\">\n          <button name=\"accept\" className=\"alertButtonPrimary\" onClick={()=>acceptCall()}>Accept</button>\n          <button name=\"reject\" className=\"alertButtonSecondary\" onClick={()=>rejectCall()}>Reject</button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n\n\n\n\n\n\n\n\n\n\n\n  let audioControl;\n  if(audioMuted){\n    audioControl=<span className=\"iconContainer\" onClick={()=>toggleMuteAudio()}>\n      <img src={microphonestop} alt=\"Unmute audio\"/>\n    </span>\n  } else {\n    audioControl=<span className=\"iconContainer\" onClick={()=>toggleMuteAudio()}>\n      <img src={microphone} alt=\"Mute audio\"/>\n    </span>\n  }\n\n  let videoControl;\n  if(videoMuted){\n    videoControl=<span className=\"iconContainer\" onClick={()=>toggleMuteVideo()}>\n      <img src={camerastop} alt=\"Resume video\"/>\n    </span>\n  } else {\n    videoControl=<span className=\"iconContainer\" onClick={()=>toggleMuteVideo()}>\n      <img src={camera} alt=\"Stop audio\"/>\n    </span>\n  }\n\n  let screenShare=<span className=\"iconContainer\" onClick={()=>shareScreen()}>\n    <img src={share} alt=\"Share screen\"/>\n  </span>\n  if(isMobileDevice()){\n    screenShare=<></>\n  }\n\n  let hangUp=<span className=\"iconContainer\" onClick={()=>endCall()}>\n    <img src={hangup} alt=\"End call\"/>\n  </span>\n\n  let fullscreenButton;\n  if(isfullscreen){\n    fullscreenButton=<span className=\"iconContainer\" onClick={()=>{setFullscreen(false)}}>\n      <img src={minimize} alt=\"fullscreen\"/>\n    </span>\n  } else {\n    fullscreenButton=<span className=\"iconContainer\" onClick={()=>{setFullscreen(true)}}>\n      <img src={fullscreen} alt=\"fullscreen\"/>\n    </span>\n  }\n\n  return (\n    <>\n      <div style={{display: renderLanding()}}>\n        {landingHTML}\n        <Rodal\n          visible={modalVisible}\n          onClose={()=>setModalVisible(false)}\n          width={20}\n          height={5}\n          measure={'em'}\n          closeOnEsc={true}\n        >\n          <div>{modalMessage}</div>\n        </Rodal>\n        {incomingCall}\n      </div>\n      <div className=\"callContainer\" style={{display: renderCall()}}>\n        <Suspense fallback={<div>Loading...</div>}>\n\n        </Suspense>\n        <div className=\"partnerVideoContainer\">\n          {PartnerVideo}\n        </div>\n        <div className=\"userVideoContainer\">\n          {UserVideo}\n        </div>\n        <div className=\"controlsContainer flex\">\n          {audioControl}\n          {videoControl}\n          {screenShare}\n          {fullscreenButton}\n          {hangUp}\n        </div>\n      </div>\n    </>\n  )\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}