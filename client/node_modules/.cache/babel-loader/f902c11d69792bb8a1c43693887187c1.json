{"ast":null,"code":"/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nconst VALID_UNITS = ['px', 'em', 'rem', 'vh', 'vw', 'vmin', 'vmax'];\nconst AMP_LAYOUTS = ['nodisplay', 'fixed', 'responsive', 'fixed-height', 'fill', 'container', 'flex-item', 'fluid', 'intrinsic'];\nconst SIZE_DEFINED_LAYOUTS = ['fixed', 'fixed-height', 'responsive', 'fill', 'flex-item', 'intrinsic'];\nconst CSS_LENGTH_ONE_PX = cssLength('1', false, false);\nconst CSS_LENGTH_AUTO = cssLength('auto', true, false);\nconst CSS_LENGTH_FOURTY_FOUR_PX = cssLength('44px', false, false);\nconst CSS_LENGTH_SIXTY_PX = cssLength('60px', false, false);\n\nfunction getLayoutClass(layout) {\n  if (!layout) {\n    return layout;\n  }\n\n  return 'i-amphtml-layout-' + layout;\n}\n\nfunction calculateHeight(inputLayout, inputHeight, tagName) {\n  if ((inputLayout === '' || inputLayout === 'fixed' || inputLayout === 'fixed-height') && !inputHeight.isSet) {\n    // These values come from AMP's runtime and can be found in\n    // https://github.com/ampproject/amphtml/blob/master/src/layout.js#L70\n    switch (tagName) {\n      case 'amp-analytics':\n        return CSS_LENGTH_ONE_PX;\n\n      case 'amp-audio':\n        return CSS_LENGTH_AUTO;\n\n      case 'amp-pixel':\n        return CSS_LENGTH_ONE_PX;\n\n      case 'amp-social-share':\n        return CSS_LENGTH_FOURTY_FOUR_PX;\n\n      default:\n    }\n  }\n\n  return inputHeight;\n}\n\nfunction calculateWidth(inputLayout, inputWidth, tagname) {\n  if ((inputLayout === '' || inputLayout === 'fixed') && !inputWidth.isSet) {\n    // These values come from AMP's runtime and can be found in\n    // https://github.com/ampproject/amphtml/blob/master/src/layout.js#L70\n    switch (tagname) {\n      case 'amp-analytics':\n        return CSS_LENGTH_ONE_PX;\n\n      case 'amp-audio':\n        return CSS_LENGTH_AUTO;\n\n      case 'amp-pixel':\n        return CSS_LENGTH_ONE_PX;\n\n      case 'amp-social-share':\n        return CSS_LENGTH_SIXTY_PX;\n\n      default:\n    }\n  }\n\n  return inputWidth;\n}\n\nfunction isLayoutSizeDefined(layout) {\n  return SIZE_DEFINED_LAYOUTS.indexOf(layout) > -1;\n}\n\nfunction getCssLengthStyle(cssLength, type) {\n  if (!cssLength.isSet) {\n    return '';\n  }\n\n  if (cssLength.isAuto) {\n    return `${type}:auto;`;\n  }\n\n  return `${type}:${cssLength.numeral}${cssLength.unit};`;\n}\n\nfunction parseLayout(layout) {\n  if (!layout) {\n    return '';\n  }\n\n  layout = layout.toLowerCase();\n\n  if (AMP_LAYOUTS.indexOf(layout) > -1) {\n    return layout;\n  }\n\n  return ''; // unknown layout\n}\n\nfunction calculateLayout(inputLayout, width, height, sizesAttr, heightsAttr) {\n  if (inputLayout !== '') {\n    return inputLayout;\n  }\n\n  if (!width.isSet && !height.isSet) {\n    return 'container';\n  }\n\n  if (height.isSet && (!width.isSet || width.isAuto)) {\n    return 'fixed-height';\n  }\n\n  if (height.isSet && width.isSet && (sizesAttr || heightsAttr)) {\n    return 'responsive';\n  }\n\n  return 'fixed';\n}\n\nfunction cssLength(input, allowAuto = false, allowFluid = false) {\n  const result = {\n    isValid: false,\n    isSet: false,\n    isAuto: false,\n    isFluid: false,\n    numeral: Number.NaN,\n    unit: 'px'\n  };\n\n  if (input === null) {\n    result.isValid = true;\n    return result;\n  }\n\n  result.isSet = true;\n\n  if (input === 'auto') {\n    result.isAuto = true;\n    result.isValid = allowAuto;\n    return result;\n  }\n\n  if (input === 'fluid') {\n    result.isFluid = true;\n    result.isValid = allowFluid;\n    return result;\n  }\n\n  const leadingNumber = /(\\d+(?:\\.\\d+)?)(.*)/;\n  const match = leadingNumber.exec(input);\n\n  if (!match) {\n    return result;\n  }\n\n  result.numeral = Number.parseFloat(match[1]);\n  input = match[2];\n\n  if (input === '') {\n    result.unit = 'px';\n    result.isValid = true;\n    return result;\n  }\n\n  if (VALID_UNITS.indexOf(input) > -1) {\n    result.isValid = true;\n    result.unit = input;\n  }\n\n  return result;\n}\n\nfunction getLayoutSizeDefinedClass() {\n  return 'i-amphtml-layout-size-defined';\n}\n\nmodule.exports = {\n  parseLayout: parseLayout,\n  cssLength: cssLength,\n  getLayoutClass: getLayoutClass,\n  calculateHeight: calculateHeight,\n  calculateWidth: calculateWidth,\n  isLayoutSizeDefined: isLayoutSizeDefined,\n  getCssLengthStyle: getCssLengthStyle,\n  calculateLayout: calculateLayout,\n  getLayoutSizeDefinedClass: getLayoutSizeDefinedClass\n};","map":{"version":3,"sources":["/Users/bruceseymour/ra-video/client/node_modules/@ampproject/toolbox-optimizer/lib/ParseLayout.js"],"names":["VALID_UNITS","AMP_LAYOUTS","SIZE_DEFINED_LAYOUTS","CSS_LENGTH_ONE_PX","cssLength","CSS_LENGTH_AUTO","CSS_LENGTH_FOURTY_FOUR_PX","CSS_LENGTH_SIXTY_PX","getLayoutClass","layout","calculateHeight","inputLayout","inputHeight","tagName","isSet","calculateWidth","inputWidth","tagname","isLayoutSizeDefined","indexOf","getCssLengthStyle","type","isAuto","numeral","unit","parseLayout","toLowerCase","calculateLayout","width","height","sizesAttr","heightsAttr","input","allowAuto","allowFluid","result","isValid","isFluid","Number","NaN","leadingNumber","match","exec","parseFloat","getLayoutSizeDefinedClass","module","exports"],"mappings":"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","sourcesContent":["/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nconst VALID_UNITS = ['px', 'em', 'rem', 'vh', 'vw', 'vmin', 'vmax'];\nconst AMP_LAYOUTS = [\n  'nodisplay',\n  'fixed',\n  'responsive',\n  'fixed-height',\n  'fill',\n  'container',\n  'flex-item',\n  'fluid',\n  'intrinsic',\n];\nconst SIZE_DEFINED_LAYOUTS = [\n  'fixed',\n  'fixed-height',\n  'responsive',\n  'fill',\n  'flex-item',\n  'intrinsic',\n];\nconst CSS_LENGTH_ONE_PX = cssLength('1', false, false);\nconst CSS_LENGTH_AUTO = cssLength('auto', true, false);\nconst CSS_LENGTH_FOURTY_FOUR_PX = cssLength('44px', false, false);\nconst CSS_LENGTH_SIXTY_PX = cssLength('60px', false, false);\n\nfunction getLayoutClass(layout) {\n  if (!layout) {\n    return layout;\n  }\n  return 'i-amphtml-layout-' + layout;\n}\n\nfunction calculateHeight(inputLayout, inputHeight, tagName) {\n  if (\n    (inputLayout === '' || inputLayout === 'fixed' || inputLayout === 'fixed-height') &&\n    !inputHeight.isSet\n  ) {\n    // These values come from AMP's runtime and can be found in\n    // https://github.com/ampproject/amphtml/blob/master/src/layout.js#L70\n    switch (tagName) {\n      case 'amp-analytics':\n        return CSS_LENGTH_ONE_PX;\n      case 'amp-audio':\n        return CSS_LENGTH_AUTO;\n      case 'amp-pixel':\n        return CSS_LENGTH_ONE_PX;\n      case 'amp-social-share':\n        return CSS_LENGTH_FOURTY_FOUR_PX;\n      default:\n    }\n  }\n  return inputHeight;\n}\n\nfunction calculateWidth(inputLayout, inputWidth, tagname) {\n  if ((inputLayout === '' || inputLayout === 'fixed') && !inputWidth.isSet) {\n    // These values come from AMP's runtime and can be found in\n    // https://github.com/ampproject/amphtml/blob/master/src/layout.js#L70\n    switch (tagname) {\n      case 'amp-analytics':\n        return CSS_LENGTH_ONE_PX;\n      case 'amp-audio':\n        return CSS_LENGTH_AUTO;\n      case 'amp-pixel':\n        return CSS_LENGTH_ONE_PX;\n      case 'amp-social-share':\n        return CSS_LENGTH_SIXTY_PX;\n      default:\n    }\n  }\n  return inputWidth;\n}\n\nfunction isLayoutSizeDefined(layout) {\n  return SIZE_DEFINED_LAYOUTS.indexOf(layout) > -1;\n}\n\nfunction getCssLengthStyle(cssLength, type) {\n  if (!cssLength.isSet) {\n    return '';\n  }\n  if (cssLength.isAuto) {\n    return `${type}:auto;`;\n  }\n  return `${type}:${cssLength.numeral}${cssLength.unit};`;\n}\n\nfunction parseLayout(layout) {\n  if (!layout) {\n    return '';\n  }\n  layout = layout.toLowerCase();\n  if (AMP_LAYOUTS.indexOf(layout) > -1) {\n    return layout;\n  }\n  return ''; // unknown layout\n}\n\nfunction calculateLayout(inputLayout, width, height, sizesAttr, heightsAttr) {\n  if (inputLayout !== '') {\n    return inputLayout;\n  }\n\n  if (!width.isSet && !height.isSet) {\n    return 'container';\n  }\n\n  if (height.isSet && (!width.isSet || width.isAuto)) {\n    return 'fixed-height';\n  }\n\n  if (height.isSet && width.isSet && (sizesAttr || heightsAttr)) {\n    return 'responsive';\n  }\n\n  return 'fixed';\n}\n\nfunction cssLength(input, allowAuto = false, allowFluid = false) {\n  const result = {\n    isValid: false,\n    isSet: false,\n    isAuto: false,\n    isFluid: false,\n    numeral: Number.NaN,\n    unit: 'px',\n  };\n\n  if (input === null) {\n    result.isValid = true;\n    return result;\n  }\n\n  result.isSet = true;\n\n  if (input === 'auto') {\n    result.isAuto = true;\n    result.isValid = allowAuto;\n    return result;\n  }\n\n  if (input === 'fluid') {\n    result.isFluid = true;\n    result.isValid = allowFluid;\n    return result;\n  }\n\n  const leadingNumber = /(\\d+(?:\\.\\d+)?)(.*)/;\n  const match = leadingNumber.exec(input);\n  if (!match) {\n    return result;\n  }\n  result.numeral = Number.parseFloat(match[1]);\n  input = match[2];\n  if (input === '') {\n    result.unit = 'px';\n    result.isValid = true;\n    return result;\n  }\n\n  if (VALID_UNITS.indexOf(input) > -1) {\n    result.isValid = true;\n    result.unit = input;\n  }\n  return result;\n}\n\nfunction getLayoutSizeDefinedClass() {\n  return 'i-amphtml-layout-size-defined';\n}\n\nmodule.exports = {\n  parseLayout: parseLayout,\n  cssLength: cssLength,\n  getLayoutClass: getLayoutClass,\n  calculateHeight: calculateHeight,\n  calculateWidth: calculateWidth,\n  isLayoutSizeDefined: isLayoutSizeDefined,\n  getCssLengthStyle: getCssLengthStyle,\n  calculateLayout: calculateLayout,\n  getLayoutSizeDefinedClass: getLayoutSizeDefinedClass,\n};\n"]},"metadata":{},"sourceType":"script"}