{"ast":null,"code":"\"use strict\";\n/* eslint-disable */\n// @ts-nocheck\n// Copied from https://github.com/medialize/ally.js\n// License: MIT\n// Copyright (c) 2015 Rodney Rehm\n//\n// Entrypoint: ally.js/maintain/tab-focus\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nexports.__esModule = true;\n\nvar platform_1 = __importDefault(require(\"platform\"));\n\nvar css_escape_1 = __importDefault(require(\"css.escape\")); // input may be undefined, selector-tring, Node, NodeList, HTMLCollection, array of Nodes\n// yes, to some extent this is a bad replica of jQuery's constructor function\n\n\nfunction nodeArray(input) {\n  if (!input) {\n    return [];\n  }\n\n  if (Array.isArray(input)) {\n    return input;\n  } // instanceof Node - does not work with iframes\n\n\n  if (input.nodeType !== undefined) {\n    return [input];\n  }\n\n  if (typeof input === 'string') {\n    input = document.querySelectorAll(input);\n  }\n\n  if (input.length !== undefined) {\n    return [].slice.call(input, 0);\n  }\n\n  throw new TypeError('unexpected input ' + String(input));\n}\n\nfunction contextToElement(_ref) {\n  var context = _ref.context,\n      _ref$label = _ref.label,\n      label = _ref$label === undefined ? 'context-to-element' : _ref$label,\n      resolveDocument = _ref.resolveDocument,\n      defaultToDocument = _ref.defaultToDocument;\n  var element = nodeArray(context)[0];\n\n  if (resolveDocument && element && element.nodeType === Node.DOCUMENT_NODE) {\n    element = element.documentElement;\n  }\n\n  if (!element && defaultToDocument) {\n    return document.documentElement;\n  }\n\n  if (!element) {\n    throw new TypeError(label + ' requires valid options.context');\n  }\n\n  if (element.nodeType !== Node.ELEMENT_NODE && element.nodeType !== Node.DOCUMENT_FRAGMENT_NODE) {\n    throw new TypeError(label + ' requires options.context to be an Element');\n  }\n\n  return element;\n}\n\nfunction getShadowHost() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context;\n\n  var element = contextToElement({\n    label: 'get/shadow-host',\n    context: context\n  }); // walk up to the root\n\n  var container = null;\n\n  while (element) {\n    container = element;\n    element = element.parentNode;\n  } // https://developer.mozilla.org/en-US/docs/Web/API/Node.nodeType\n  // NOTE: Firefox 34 does not expose ShadowRoot.host (but 37 does)\n\n\n  if (container.nodeType === container.DOCUMENT_FRAGMENT_NODE && container.host) {\n    // the root is attached to a fragment node that has a host\n    return container.host;\n  }\n\n  return null;\n}\n\nfunction getDocument(node) {\n  if (!node) {\n    return document;\n  }\n\n  if (node.nodeType === Node.DOCUMENT_NODE) {\n    return node;\n  }\n\n  return node.ownerDocument || document;\n}\n\nfunction isActiveElement(context) {\n  var element = contextToElement({\n    label: 'is/active-element',\n    resolveDocument: true,\n    context: context\n  });\n\n  var _document = getDocument(element);\n\n  if (_document.activeElement === element) {\n    return true;\n  }\n\n  var shadowHost = getShadowHost({\n    context: element\n  });\n\n  if (shadowHost && shadowHost.shadowRoot.activeElement === element) {\n    return true;\n  }\n\n  return false;\n} // [elem, elem.parent, elem.parent.parent, â€¦, html]\n// will not contain the shadowRoot (DOCUMENT_FRAGMENT_NODE) and shadowHost\n\n\nfunction getParents() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context;\n\n  var list = [];\n  var element = contextToElement({\n    label: 'get/parents',\n    context: context\n  });\n\n  while (element) {\n    list.push(element); // IE does know support parentElement on SVGElement\n\n    element = element.parentNode;\n\n    if (element && element.nodeType !== Node.ELEMENT_NODE) {\n      element = null;\n    }\n  }\n\n  return list;\n} // Element.prototype.matches may be available at a different name\n// https://developer.mozilla.org/en/docs/Web/API/Element/matches\n\n\nvar names = ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector'];\nvar name = null;\n\nfunction findMethodName(element) {\n  names.some(function (_name) {\n    if (!element[_name]) {\n      return false;\n    }\n\n    name = _name;\n    return true;\n  });\n}\n\nfunction elementMatches(element, selector) {\n  if (!name) {\n    findMethodName(element);\n  }\n\n  return element[name](selector);\n} // deep clone of original platform\n\n\nvar platform = JSON.parse(JSON.stringify(platform_1[\"default\"])); // operating system\n\nvar os = platform.os.family || '';\nvar ANDROID = os === 'Android';\nvar WINDOWS = os.slice(0, 7) === 'Windows';\nvar OSX = os === 'OS X';\nvar IOS = os === 'iOS'; // layout\n\nvar BLINK = platform.layout === 'Blink';\nvar GECKO = platform.layout === 'Gecko';\nvar TRIDENT = platform.layout === 'Trident';\nvar EDGE = platform.layout === 'EdgeHTML';\nvar WEBKIT = platform.layout === 'WebKit'; // browser version (not layout engine version!)\n\nvar version = parseFloat(platform.version);\nvar majorVersion = Math.floor(version);\nplatform.majorVersion = majorVersion;\nplatform.is = {\n  // operating system\n  ANDROID: ANDROID,\n  WINDOWS: WINDOWS,\n  OSX: OSX,\n  IOS: IOS,\n  // layout\n  BLINK: BLINK,\n  GECKO: GECKO,\n  TRIDENT: TRIDENT,\n  EDGE: EDGE,\n  WEBKIT: WEBKIT,\n  // INTERNET EXPLORERS\n  IE9: TRIDENT && majorVersion === 9,\n  IE10: TRIDENT && majorVersion === 10,\n  IE11: TRIDENT && majorVersion === 11\n};\n\nfunction before() {\n  var data = {\n    // remember what had focus to restore after test\n    activeElement: document.activeElement,\n    // remember scroll positions to restore after test\n    windowScrollTop: window.scrollTop,\n    windowScrollLeft: window.scrollLeft,\n    bodyScrollTop: document.body.scrollTop,\n    bodyScrollLeft: document.body.scrollLeft\n  }; // wrap tests in an element hidden from screen readers to prevent them\n  // from announcing focus, which can be quite irritating to the user\n\n  var iframe = document.createElement('iframe');\n  iframe.setAttribute('style', 'position:absolute; position:fixed; top:0; left:-2px; width:1px; height:1px; overflow:hidden;');\n  iframe.setAttribute('aria-live', 'off');\n  iframe.setAttribute('aria-busy', 'true');\n  iframe.setAttribute('aria-hidden', 'true');\n  document.body.appendChild(iframe);\n  var _window = iframe.contentWindow;\n  var _document = _window.document;\n\n  _document.open();\n\n  _document.close();\n\n  var wrapper = _document.createElement('div');\n\n  _document.body.appendChild(wrapper);\n\n  data.iframe = iframe;\n  data.wrapper = wrapper;\n  data.window = _window;\n  data.document = _document;\n  return data;\n} // options.element:\n//  {string} element name\n//  {function} callback(wrapper, document) to generate an element\n// options.mutate: (optional)\n//  {function} callback(element, wrapper, document) to manipulate element prior to focus-test.\n//             Can return DOMElement to define focus target (default: element)\n// options.validate: (optional)\n//  {function} callback(element, focusTarget, document) to manipulate test-result\n\n\nfunction test(data, options) {\n  // make sure we operate on a clean slate\n  data.wrapper.innerHTML = ''; // create dummy element to test focusability of\n\n  var element = typeof options.element === 'string' ? data.document.createElement(options.element) : options.element(data.wrapper, data.document); // allow callback to further specify dummy element\n  // and optionally define element to focus\n\n  var focus = options.mutate && options.mutate(element, data.wrapper, data.document);\n\n  if (!focus && focus !== false) {\n    focus = element;\n  } // element needs to be part of the DOM to be focusable\n\n\n  !element.parentNode && data.wrapper.appendChild(element); // test if the element with invalid tabindex can be focused\n\n  focus && focus.focus && focus.focus(); // validate test's result\n\n  return options.validate ? options.validate(element, focus, data.document) : data.document.activeElement === focus;\n}\n\nfunction after(data) {\n  // restore focus to what it was before test and cleanup\n  if (data.activeElement === document.body) {\n    document.activeElement && document.activeElement.blur && document.activeElement.blur();\n\n    if (platform.is.IE10) {\n      // IE10 does not redirect focus to <body> when the activeElement is removed\n      document.body.focus();\n    }\n  } else {\n    data.activeElement && data.activeElement.focus && data.activeElement.focus();\n  }\n\n  document.body.removeChild(data.iframe); // restore scroll position\n\n  window.scrollTop = data.windowScrollTop;\n  window.scrollLeft = data.windowScrollLeft;\n  document.body.scrollTop = data.bodyScrollTop;\n  document.body.scrollLeft = data.bodyScrollLeft;\n}\n\nfunction detectFocus(tests) {\n  var data = before();\n  var results = {};\n  Object.keys(tests).map(function (key) {\n    results[key] = test(data, tests[key]);\n  });\n  after(data);\n  return results;\n} // this file is overwritten by `npm run build:pre`\n\n\nvar version$1 = '1.4.1';\n/*\n    Facility to cache test results in localStorage.\n\n    USAGE:\n      cache.get('key');\n      cache.set('key', 'value');\n */\n\nfunction readLocalStorage(key) {\n  // allow reading from storage to retrieve previous support results\n  // even while the document does not have focus\n  var data = void 0;\n\n  try {\n    data = window.localStorage && window.localStorage.getItem(key);\n    data = data ? JSON.parse(data) : {};\n  } catch (e) {\n    data = {};\n  }\n\n  return data;\n}\n\nfunction writeLocalStorage(key, value) {\n  if (!document.hasFocus()) {\n    // if the document does not have focus when tests are executed, focus() may\n    // not be handled properly and events may not be dispatched immediately.\n    // This can happen when a document is reloaded while Developer Tools have focus.\n    try {\n      window.localStorage && window.localStorage.removeItem(key);\n    } catch (e) {// ignore\n    }\n\n    return;\n  }\n\n  try {\n    window.localStorage && window.localStorage.setItem(key, JSON.stringify(value));\n  } catch (e) {// ignore\n  }\n}\n\nvar userAgent = typeof window !== 'undefined' && window.navigator.userAgent || '';\nvar cacheKey = 'ally-supports-cache';\nvar cache = readLocalStorage(cacheKey); // update the cache if ally or the user agent changed (newer version, etc)\n\nif (cache.userAgent !== userAgent || cache.version !== version$1) {\n  cache = {};\n}\n\ncache.userAgent = userAgent;\ncache.version = version$1;\nvar cache$1 = {\n  get: function get() {\n    return cache;\n  },\n  set: function set(values) {\n    Object.keys(values).forEach(function (key) {\n      cache[key] = values[key];\n    });\n    cache.time = new Date().toISOString();\n    writeLocalStorage(cacheKey, cache);\n  }\n};\n\nfunction cssShadowPiercingDeepCombinator() {\n  var combinator = void 0; // see https://dev.w3.org/csswg/css-scoping-1/#deep-combinator\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1117572\n  // https://code.google.com/p/chromium/issues/detail?id=446051\n\n  try {\n    document.querySelector('html >>> :first-child');\n    combinator = '>>>';\n  } catch (noArrowArrowArrow) {\n    try {\n      // old syntax supported at least up to Chrome 41\n      // https://code.google.com/p/chromium/issues/detail?id=446051\n      document.querySelector('html /deep/ :first-child');\n      combinator = '/deep/';\n    } catch (noDeep) {\n      combinator = '';\n    }\n  }\n\n  return combinator;\n}\n\nvar gif = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'; // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\n\nvar focusAreaImgTabindex = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = '<map name=\"image-map-tabindex-test\">' + '<area shape=\"rect\" coords=\"63,19,144,45\"></map>' + '<img usemap=\"#image-map-tabindex-test\" tabindex=\"-1\" alt=\"\" src=\"' + gif + '\">';\n    return element.querySelector('area');\n  }\n}; // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\n\nvar focusAreaTabindex = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = '<map name=\"image-map-tabindex-test\">' + '<area href=\"#void\" tabindex=\"-1\" shape=\"rect\" coords=\"63,19,144,45\"></map>' + '<img usemap=\"#image-map-tabindex-test\" alt=\"\" src=\"' + gif + '\">';\n    return false;\n  },\n  validate: function validate(element, focusTarget, _document) {\n    if (platform.is.GECKO) {\n      // fixes https://github.com/medialize/ally.js/issues/35\n      // Firefox loads the DataURI asynchronously, causing a false-negative\n      return true;\n    }\n\n    var focus = element.querySelector('area');\n    focus.focus();\n    return _document.activeElement === focus;\n  }\n}; // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\n\nvar focusAreaWithoutHref = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = '<map name=\"image-map-area-href-test\">' + '<area shape=\"rect\" coords=\"63,19,144,45\"></map>' + '<img usemap=\"#image-map-area-href-test\" alt=\"\" src=\"' + gif + '\">';\n    return element.querySelector('area');\n  },\n  validate: function validate(element, focusTarget, _document) {\n    if (platform.is.GECKO) {\n      // fixes https://github.com/medialize/ally.js/issues/35\n      // Firefox loads the DataURI asynchronously, causing a false-negative\n      return true;\n    }\n\n    return _document.activeElement === focusTarget;\n  }\n};\nvar focusAudioWithoutControls = {\n  name: 'can-focus-audio-without-controls',\n  element: 'audio',\n  mutate: function mutate(element) {\n    try {\n      // invalid media file can trigger warning in console, data-uri to prevent HTTP request\n      element.setAttribute('src', gif);\n    } catch (e) {// IE9 may throw \"Error: Not implemented\"\n    }\n  }\n};\nvar invalidGif = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ'; // NOTE: https://github.com/medialize/ally.js/issues/35\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\n\nvar focusBrokenImageMap = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = '<map name=\"broken-image-map-test\"><area href=\"#void\" shape=\"rect\" coords=\"63,19,144,45\"></map>' + '<img usemap=\"#broken-image-map-test\" alt=\"\" src=\"' + invalidGif + '\">';\n    return element.querySelector('area');\n  }\n}; // Children of focusable elements with display:flex are focusable in IE10-11\n\nvar focusChildrenOfFocusableFlexbox = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.setAttribute('tabindex', '-1');\n    element.setAttribute('style', 'display: -webkit-flex; display: -ms-flexbox; display: flex;');\n    element.innerHTML = '<span style=\"display: block;\">hello</span>';\n    return element.querySelector('span');\n  }\n}; // fieldset[tabindex=0][disabled] should not be focusable, but Blink and WebKit disagree\n// @specification https://www.w3.org/TR/html5/disabled-elements.html#concept-element-disabled\n// @browser-issue Chromium https://crbug.com/453847\n// @browser-issue WebKit https://bugs.webkit.org/show_bug.cgi?id=141086\n\nvar focusFieldsetDisabled = {\n  element: 'fieldset',\n  mutate: function mutate(element) {\n    element.setAttribute('tabindex', 0);\n    element.setAttribute('disabled', 'disabled');\n  }\n};\nvar focusFieldset = {\n  element: 'fieldset',\n  mutate: function mutate(element) {\n    element.innerHTML = '<legend>legend</legend><p>content</p>';\n  }\n}; // elements with display:flex are focusable in IE10-11\n\nvar focusFlexboxContainer = {\n  element: 'span',\n  mutate: function mutate(element) {\n    element.setAttribute('style', 'display: -webkit-flex; display: -ms-flexbox; display: flex;');\n    element.innerHTML = '<span style=\"display: block;\">hello</span>';\n  }\n}; // form[tabindex=0][disabled] should be focusable as the\n// specification doesn't know the disabled attribute on the form element\n// @specification https://www.w3.org/TR/html5/forms.html#the-form-element\n\nvar focusFormDisabled = {\n  element: 'form',\n  mutate: function mutate(element) {\n    element.setAttribute('tabindex', 0);\n    element.setAttribute('disabled', 'disabled');\n  }\n}; // NOTE: https://github.com/medialize/ally.js/issues/35\n// fixes https://github.com/medialize/ally.js/issues/20\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-ismap\n\nvar focusImgIsmap = {\n  element: 'a',\n  mutate: function mutate(element) {\n    element.href = '#void';\n    element.innerHTML = '<img ismap src=\"' + gif + '\" alt=\"\">';\n    return element.querySelector('img');\n  }\n}; // NOTE: https://github.com/medialize/ally.js/issues/35\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\n\nvar focusImgUsemapTabindex = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = '<map name=\"image-map-tabindex-test\"><area href=\"#void\" shape=\"rect\" coords=\"63,19,144,45\"></map>' + '<img usemap=\"#image-map-tabindex-test\" tabindex=\"-1\" alt=\"\" ' + 'src=\"' + gif + '\">';\n    return element.querySelector('img');\n  }\n};\nvar focusInHiddenIframe = {\n  element: function element(wrapper, _document) {\n    var iframe = _document.createElement('iframe'); // iframe must be part of the DOM before accessing the contentWindow is possible\n\n\n    wrapper.appendChild(iframe); // create the iframe's default document (<html><head></head><body></body></html>)\n\n    var iframeDocument = iframe.contentWindow.document;\n    iframeDocument.open();\n    iframeDocument.close();\n    return iframe;\n  },\n  mutate: function mutate(iframe) {\n    iframe.style.visibility = 'hidden';\n    var iframeDocument = iframe.contentWindow.document;\n    var input = iframeDocument.createElement('input');\n    iframeDocument.body.appendChild(input);\n    return input;\n  },\n  validate: function validate(iframe) {\n    var iframeDocument = iframe.contentWindow.document;\n    var focus = iframeDocument.querySelector('input');\n    return iframeDocument.activeElement === focus;\n  }\n};\nvar result = !platform.is.WEBKIT;\n\nfunction focusInZeroDimensionObject() {\n  return result;\n} // Firefox allows *any* value and treats invalid values like tabindex=\"-1\"\n// @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=1128054\n\n\nvar focusInvalidTabindex = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.setAttribute('tabindex', 'invalid-value');\n  }\n};\nvar focusLabelTabindex = {\n  element: 'label',\n  mutate: function mutate(element) {\n    element.setAttribute('tabindex', '-1');\n  },\n  validate: function validate(element, focusTarget, _document) {\n    // force layout in Chrome 49, otherwise the element won't be focusable\n\n    /* eslint-disable no-unused-vars */\n    var variableToPreventDeadCodeElimination = element.offsetHeight;\n    /* eslint-enable no-unused-vars */\n\n    element.focus();\n    return _document.activeElement === element;\n  }\n};\nvar svg = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtb' + 'G5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0ic3ZnIj48dGV4dCB4PSIxMCIgeT0iMjAiIGlkPSJ' + 'zdmctbGluay10ZXh0Ij50ZXh0PC90ZXh0Pjwvc3ZnPg=='; // Note: IE10 on BrowserStack does not like this test\n\nvar focusObjectSvgHidden = {\n  element: 'object',\n  mutate: function mutate(element) {\n    element.setAttribute('type', 'image/svg+xml');\n    element.setAttribute('data', svg);\n    element.setAttribute('width', '200');\n    element.setAttribute('height', '50');\n    element.style.visibility = 'hidden';\n  }\n}; // Note: IE10 on BrowserStack does not like this test\n\nvar focusObjectSvg = {\n  name: 'can-focus-object-svg',\n  element: 'object',\n  mutate: function mutate(element) {\n    element.setAttribute('type', 'image/svg+xml');\n    element.setAttribute('data', svg);\n    element.setAttribute('width', '200');\n    element.setAttribute('height', '50');\n  },\n  validate: function validate(element, focusTarget, _document) {\n    if (platform.is.GECKO) {\n      // Firefox seems to be handling the object creation asynchronously and thereby produces a false negative test result.\n      // Because we know Firefox is able to focus object elements referencing SVGs, we simply cheat by sniffing the user agent string\n      return true;\n    }\n\n    return _document.activeElement === element;\n  }\n}; // Every Environment except IE9 considers SWF objects focusable\n\nvar result$1 = !platform.is.IE9;\n\nfunction focusObjectSwf() {\n  return result$1;\n}\n\nvar focusRedirectImgUsemap = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = '<map name=\"focus-redirect-img-usemap\"><area href=\"#void\" shape=\"rect\" coords=\"63,19,144,45\"></map>' + '<img usemap=\"#focus-redirect-img-usemap\" alt=\"\" ' + 'src=\"' + gif + '\">'; // focus the <img>, not the <div>\n\n    return element.querySelector('img');\n  },\n  validate: function validate(element, focusTarget, _document) {\n    var target = element.querySelector('area');\n    return _document.activeElement === target;\n  }\n}; // see https://jsbin.com/nenirisage/edit?html,js,console,output\n\nvar focusRedirectLegend = {\n  element: 'fieldset',\n  mutate: function mutate(element) {\n    element.innerHTML = '<legend>legend</legend><input tabindex=\"-1\"><input tabindex=\"0\">'; // take care of focus in validate();\n\n    return false;\n  },\n  validate: function validate(element, focusTarget, _document) {\n    var focusable = element.querySelector('input[tabindex=\"-1\"]');\n    var tabbable = element.querySelector('input[tabindex=\"0\"]'); // Firefox requires this test to focus the <fieldset> first, while this is not necessary in\n    // https://jsbin.com/nenirisage/edit?html,js,console,output\n\n    element.focus();\n    element.querySelector('legend').focus();\n    return _document.activeElement === focusable && 'focusable' || _document.activeElement === tabbable && 'tabbable' || '';\n  }\n}; // https://github.com/medialize/ally.js/issues/21\n\nvar focusScrollBody = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.setAttribute('style', 'width: 100px; height: 50px; overflow: auto;');\n    element.innerHTML = '<div style=\"width: 500px; height: 40px;\">scrollable content</div>';\n    return element.querySelector('div');\n  }\n}; // https://github.com/medialize/ally.js/issues/21\n\nvar focusScrollContainerWithoutOverflow = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.setAttribute('style', 'width: 100px; height: 50px;');\n    element.innerHTML = '<div style=\"width: 500px; height: 40px;\">scrollable content</div>';\n  }\n}; // https://github.com/medialize/ally.js/issues/21\n\nvar focusScrollContainer = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.setAttribute('style', 'width: 100px; height: 50px; overflow: auto;');\n    element.innerHTML = '<div style=\"width: 500px; height: 40px;\">scrollable content</div>';\n  }\n};\nvar focusSummary = {\n  element: 'details',\n  mutate: function mutate(element) {\n    element.innerHTML = '<summary>foo</summary><p>content</p>';\n    return element.firstElementChild;\n  }\n};\n\nfunction makeFocusableForeignObject() {\n  var fragment = document.createElement('div');\n  fragment.innerHTML = '<svg><foreignObject width=\"30\" height=\"30\">\\n      <input type=\"text\"/>\\n  </foreignObject></svg>';\n  return fragment.firstChild.firstChild;\n}\n\nfunction focusSvgForeignObjectHack(element) {\n  // Edge13, Edge14: foreignObject focus hack\n  // https://jsbin.com/kunehinugi/edit?html,js,output\n  // https://jsbin.com/fajagi/3/edit?html,js,output\n  var isSvgElement = element.ownerSVGElement || element.nodeName.toLowerCase() === 'svg';\n\n  if (!isSvgElement) {\n    return false;\n  } // inject and focus an <input> element into the SVG element to receive focus\n\n\n  var foreignObject = makeFocusableForeignObject();\n  element.appendChild(foreignObject);\n  var input = foreignObject.querySelector('input');\n  input.focus(); // upon disabling the activeElement, IE and Edge\n  // will not shift focus to <body> like all the other\n  // browsers, but instead find the first focusable\n  // ancestor and shift focus to that\n\n  input.disabled = true; // clean up\n\n  element.removeChild(foreignObject);\n  return true;\n}\n\nfunction generate(element) {\n  return '<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">' + element + '</svg>';\n}\n\nfunction focus(element) {\n  if (element.focus) {\n    return;\n  }\n\n  try {\n    HTMLElement.prototype.focus.call(element);\n  } catch (e) {\n    focusSvgForeignObjectHack(element);\n  }\n}\n\nfunction validate(element, focusTarget, _document) {\n  focus(focusTarget);\n  return _document.activeElement === focusTarget;\n}\n\nvar focusSvgFocusableAttribute = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = generate('<text focusable=\"true\">a</text>');\n    return element.querySelector('text');\n  },\n  validate: validate\n};\nvar focusSvgTabindexAttribute = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = generate('<text tabindex=\"0\">a</text>');\n    return element.querySelector('text');\n  },\n  validate: validate\n};\nvar focusSvgNegativeTabindexAttribute = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = generate('<text tabindex=\"-1\">a</text>');\n    return element.querySelector('text');\n  },\n  validate: validate\n};\nvar focusSvgUseTabindex = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = generate(['<g id=\"ally-test-target\"><a xlink:href=\"#void\"><text>link</text></a></g>', '<use xlink:href=\"#ally-test-target\" x=\"0\" y=\"0\" tabindex=\"-1\" />'].join(''));\n    return element.querySelector('use');\n  },\n  validate: validate\n};\nvar focusSvgForeignobjectTabindex = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = generate('<foreignObject tabindex=\"-1\"><input type=\"text\" /></foreignObject>'); // Safari 8's quersSelector() can't identify foreignObject, but getElementyByTagName() can\n\n    return element.querySelector('foreignObject') || element.getElementsByTagName('foreignObject')[0];\n  },\n  validate: validate\n}; // Firefox seems to be handling the SVG-document-in-iframe creation asynchronously\n// and thereby produces a false negative test result. Thus the test is pointless\n// and we resort to UA sniffing once again.\n// see http://jsbin.com/vunadohoko/1/edit?js,console,output\n\nvar result$2 = Boolean(platform.is.GECKO && typeof SVGElement !== 'undefined' && SVGElement.prototype.focus);\n\nfunction focusSvgInIframe() {\n  return result$2;\n}\n\nvar focusSvg = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.innerHTML = generate('');\n    return element.firstChild;\n  },\n  validate: validate\n}; // Firefox allows *any* value and treats invalid values like tabindex=\"-1\"\n// @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=1128054\n\nvar focusTabindexTrailingCharacters = {\n  element: 'div',\n  mutate: function mutate(element) {\n    element.setAttribute('tabindex', '3x');\n  }\n};\nvar focusTable = {\n  element: 'table',\n  mutate: function mutate(element, wrapper, _document) {\n    // IE9 has a problem replacing TBODY contents with innerHTML.\n    // https://stackoverflow.com/a/8097055/515124\n    // element.innerHTML = '<tr><td>cell</td></tr>';\n    var fragment = _document.createDocumentFragment();\n\n    fragment.innerHTML = '<tr><td>cell</td></tr>';\n    element.appendChild(fragment);\n  }\n};\nvar focusVideoWithoutControls = {\n  element: 'video',\n  mutate: function mutate(element) {\n    try {\n      // invalid media file can trigger warning in console, data-uri to prevent HTTP request\n      element.setAttribute('src', gif);\n    } catch (e) {// IE9 may throw \"Error: Not implemented\"\n    }\n  }\n}; // https://jsbin.com/vafaba/3/edit?html,js,console,output\n\nvar result$3 = platform.is.GECKO || platform.is.TRIDENT || platform.is.EDGE;\n\nfunction tabsequenceAreaAtImgPosition() {\n  return result$3;\n}\n\nvar testCallbacks = {\n  cssShadowPiercingDeepCombinator: cssShadowPiercingDeepCombinator,\n  focusInZeroDimensionObject: focusInZeroDimensionObject,\n  focusObjectSwf: focusObjectSwf,\n  focusSvgInIframe: focusSvgInIframe,\n  tabsequenceAreaAtImgPosition: tabsequenceAreaAtImgPosition\n};\nvar testDescriptions = {\n  focusAreaImgTabindex: focusAreaImgTabindex,\n  focusAreaTabindex: focusAreaTabindex,\n  focusAreaWithoutHref: focusAreaWithoutHref,\n  focusAudioWithoutControls: focusAudioWithoutControls,\n  focusBrokenImageMap: focusBrokenImageMap,\n  focusChildrenOfFocusableFlexbox: focusChildrenOfFocusableFlexbox,\n  focusFieldsetDisabled: focusFieldsetDisabled,\n  focusFieldset: focusFieldset,\n  focusFlexboxContainer: focusFlexboxContainer,\n  focusFormDisabled: focusFormDisabled,\n  focusImgIsmap: focusImgIsmap,\n  focusImgUsemapTabindex: focusImgUsemapTabindex,\n  focusInHiddenIframe: focusInHiddenIframe,\n  focusInvalidTabindex: focusInvalidTabindex,\n  focusLabelTabindex: focusLabelTabindex,\n  focusObjectSvg: focusObjectSvg,\n  focusObjectSvgHidden: focusObjectSvgHidden,\n  focusRedirectImgUsemap: focusRedirectImgUsemap,\n  focusRedirectLegend: focusRedirectLegend,\n  focusScrollBody: focusScrollBody,\n  focusScrollContainerWithoutOverflow: focusScrollContainerWithoutOverflow,\n  focusScrollContainer: focusScrollContainer,\n  focusSummary: focusSummary,\n  focusSvgFocusableAttribute: focusSvgFocusableAttribute,\n  focusSvgTabindexAttribute: focusSvgTabindexAttribute,\n  focusSvgNegativeTabindexAttribute: focusSvgNegativeTabindexAttribute,\n  focusSvgUseTabindex: focusSvgUseTabindex,\n  focusSvgForeignobjectTabindex: focusSvgForeignobjectTabindex,\n  focusSvg: focusSvg,\n  focusTabindexTrailingCharacters: focusTabindexTrailingCharacters,\n  focusTable: focusTable,\n  focusVideoWithoutControls: focusVideoWithoutControls\n};\n\nfunction executeTests() {\n  var results = detectFocus(testDescriptions);\n  Object.keys(testCallbacks).forEach(function (key) {\n    results[key] = testCallbacks[key]();\n  });\n  return results;\n}\n\nvar supportsCache = null;\n\nfunction _supports() {\n  if (supportsCache) {\n    return supportsCache;\n  }\n\n  supportsCache = cache$1.get();\n\n  if (!supportsCache.time) {\n    cache$1.set(executeTests());\n    supportsCache = cache$1.get();\n  }\n\n  return supportsCache;\n}\n\nvar supports = void 0; // https://www.w3.org/TR/html5/infrastructure.html#rules-for-parsing-integers\n// NOTE: all browsers agree to allow trailing spaces as well\n\nvar validIntegerPatternNoTrailing = /^\\s*(-|\\+)?[0-9]+\\s*$/;\nvar validIntegerPatternWithTrailing = /^\\s*(-|\\+)?[0-9]+.*$/;\n\nfunction isValidTabindex(context) {\n  if (!supports) {\n    supports = _supports();\n  }\n\n  var validIntegerPattern = supports.focusTabindexTrailingCharacters ? validIntegerPatternWithTrailing : validIntegerPatternNoTrailing;\n  var element = contextToElement({\n    label: 'is/valid-tabindex',\n    resolveDocument: true,\n    context: context\n  }); // Edge 14 has a capitalization problem on SVG elements,\n  // see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/9282058/\n\n  var hasTabindex = element.hasAttribute('tabindex');\n  var hasTabIndex = element.hasAttribute('tabIndex');\n\n  if (!hasTabindex && !hasTabIndex) {\n    return false;\n  } // older Firefox and Internet Explorer don't support tabindex on SVG elements\n\n\n  var isSvgElement = element.ownerSVGElement || element.nodeName.toLowerCase() === 'svg';\n\n  if (isSvgElement && !supports.focusSvgTabindexAttribute) {\n    return false;\n  } // @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=1128054\n\n\n  if (supports.focusInvalidTabindex) {\n    return true;\n  } // an element matches the tabindex selector even if its value is invalid\n\n\n  var tabindex = element.getAttribute(hasTabindex ? 'tabindex' : 'tabIndex'); // IE11 parses tabindex=\"\" as the value \"-32768\"\n  // @browser-issue Trident https://connect.microsoft.com/IE/feedback/details/1072965\n\n  if (tabindex === '-32768') {\n    return false;\n  }\n\n  return Boolean(tabindex && validIntegerPattern.test(tabindex));\n}\n\nfunction tabindexValue(element) {\n  if (!isValidTabindex(element)) {\n    return null;\n  } // Edge 14 has a capitalization problem on SVG elements,\n  // see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/9282058/\n\n\n  var hasTabindex = element.hasAttribute('tabindex');\n  var attributeName = hasTabindex ? 'tabindex' : 'tabIndex'; // @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=1128054\n\n  var tabindex = parseInt(element.getAttribute(attributeName), 10);\n  return isNaN(tabindex) ? -1 : tabindex;\n} // this is a shared utility file for focus-relevant.js and tabbable.js\n// separate testing of this file's functions is not necessary,\n// as they're implicitly tested by way of the consumers\n\n\nfunction isUserModifyWritable(style) {\n  // https://www.w3.org/TR/1999/WD-css3-userint-19990916#user-modify\n  // https://github.com/medialize/ally.js/issues/17\n  var userModify = style.webkitUserModify || '';\n  return Boolean(userModify && userModify.indexOf('write') !== -1);\n}\n\nfunction hasCssOverflowScroll(style) {\n  return [style.getPropertyValue('overflow'), style.getPropertyValue('overflow-x'), style.getPropertyValue('overflow-y')].some(function (overflow) {\n    return overflow === 'auto' || overflow === 'scroll';\n  });\n}\n\nfunction hasCssDisplayFlex(style) {\n  return style.display.indexOf('flex') > -1;\n}\n\nfunction isScrollableContainer(element, nodeName, parentNodeName, parentStyle) {\n  if (nodeName !== 'div' && nodeName !== 'span') {\n    // Internet Explorer advances scrollable containers and bodies to focusable\n    // only if the scrollable container is <div> or <span> - this does *not*\n    // happen for <section>, <article>, â€¦\n    return false;\n  }\n\n  if (parentNodeName && parentNodeName !== 'div' && parentNodeName !== 'span' && !hasCssOverflowScroll(parentStyle)) {\n    return false;\n  }\n\n  return element.offsetHeight < element.scrollHeight || element.offsetWidth < element.scrollWidth;\n}\n\nvar supports$1 = void 0;\n\nfunction isFocusRelevantRules() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      _ref$except = _ref.except,\n      except = _ref$except === undefined ? {\n    flexbox: false,\n    scrollable: false,\n    shadow: false\n  } : _ref$except;\n\n  if (!supports$1) {\n    supports$1 = _supports();\n  }\n\n  var element = contextToElement({\n    label: 'is/focus-relevant',\n    resolveDocument: true,\n    context: context\n  });\n\n  if (!except.shadow && element.shadowRoot) {\n    // a ShadowDOM host receives focus when the focus moves to its content\n    return true;\n  }\n\n  var nodeName = element.nodeName.toLowerCase();\n\n  if (nodeName === 'input' && element.type === 'hidden') {\n    // input[type=\"hidden\"] supports.cannot be focused\n    return false;\n  }\n\n  if (nodeName === 'input' || nodeName === 'select' || nodeName === 'button' || nodeName === 'textarea') {\n    return true;\n  }\n\n  if (nodeName === 'legend' && supports$1.focusRedirectLegend) {\n    // specifics filtered in is/focusable\n    return true;\n  }\n\n  if (nodeName === 'label') {\n    // specifics filtered in is/focusable\n    return true;\n  }\n\n  if (nodeName === 'area') {\n    // specifics filtered in is/focusable\n    return true;\n  }\n\n  if (nodeName === 'a' && element.hasAttribute('href')) {\n    return true;\n  }\n\n  if (nodeName === 'object' && element.hasAttribute('usemap')) {\n    // object[usemap] is not focusable in any browser\n    return false;\n  }\n\n  if (nodeName === 'object') {\n    var svgType = element.getAttribute('type');\n\n    if (!supports$1.focusObjectSvg && svgType === 'image/svg+xml') {\n      // object[type=\"image/svg+xml\"] is not focusable in Internet Explorer\n      return false;\n    } else if (!supports$1.focusObjectSwf && svgType === 'application/x-shockwave-flash') {\n      // object[type=\"application/x-shockwave-flash\"] is not focusable in Internet Explorer 9\n      return false;\n    }\n  }\n\n  if (nodeName === 'iframe' || nodeName === 'object') {\n    // browsing context containers\n    return true;\n  }\n\n  if (nodeName === 'embed' || nodeName === 'keygen') {\n    // embed is considered focus-relevant but not focusable\n    // see https://github.com/medialize/ally.js/issues/82\n    return true;\n  }\n\n  if (element.hasAttribute('contenteditable')) {\n    // also see CSS property user-modify below\n    return true;\n  }\n\n  if (nodeName === 'audio' && (supports$1.focusAudioWithoutControls || element.hasAttribute('controls'))) {\n    return true;\n  }\n\n  if (nodeName === 'video' && (supports$1.focusVideoWithoutControls || element.hasAttribute('controls'))) {\n    return true;\n  }\n\n  if (supports$1.focusSummary && nodeName === 'summary') {\n    return true;\n  }\n\n  var validTabindex = isValidTabindex(element);\n\n  if (nodeName === 'img' && element.hasAttribute('usemap')) {\n    // Gecko, Trident and Edge do not allow an image with an image map and tabindex to be focused,\n    // it appears the tabindex is overruled so focus is still forwarded to the <map>\n    return validTabindex && supports$1.focusImgUsemapTabindex || supports$1.focusRedirectImgUsemap;\n  }\n\n  if (supports$1.focusTable && (nodeName === 'table' || nodeName === 'td')) {\n    // IE10-11 supports.can focus <table> and <td>\n    return true;\n  }\n\n  if (supports$1.focusFieldset && nodeName === 'fieldset') {\n    // IE10-11 supports.can focus <fieldset>\n    return true;\n  }\n\n  var isSvgElement = nodeName === 'svg';\n  var isSvgContent = element.ownerSVGElement;\n  var focusableAttribute = element.getAttribute('focusable');\n  var tabindex = tabindexValue(element);\n\n  if (nodeName === 'use' && tabindex !== null && !supports$1.focusSvgUseTabindex) {\n    // <use> cannot be made focusable by adding a tabindex attribute anywhere but Blink and WebKit\n    return false;\n  }\n\n  if (nodeName === 'foreignobject') {\n    // <use> can only be made focusable in Blink and WebKit\n    return tabindex !== null && supports$1.focusSvgForeignobjectTabindex;\n  }\n\n  if (elementMatches(element, 'svg a') && element.hasAttribute('xlink:href')) {\n    return true;\n  }\n\n  if ((isSvgElement || isSvgContent) && element.focus && !supports$1.focusSvgNegativeTabindexAttribute && tabindex < 0) {\n    // Firefox 51 and 52 treat any natively tabbable SVG element with\n    // tabindex=\"-1\" as tabbable and everything else as inert\n    // see https://bugzilla.mozilla.org/show_bug.cgi?id=1302340\n    return false;\n  }\n\n  if (isSvgElement) {\n    return validTabindex || supports$1.focusSvg || supports$1.focusSvgInIframe || // Internet Explorer understands the focusable attribute introduced in SVG Tiny 1.2\n    Boolean(supports$1.focusSvgFocusableAttribute && focusableAttribute && focusableAttribute === 'true');\n  }\n\n  if (isSvgContent) {\n    if (supports$1.focusSvgTabindexAttribute && validTabindex) {\n      return true;\n    }\n\n    if (supports$1.focusSvgFocusableAttribute) {\n      // Internet Explorer understands the focusable attribute introduced in SVG Tiny 1.2\n      return focusableAttribute === 'true';\n    }\n  } // https://www.w3.org/TR/html5/editing.html#sequential-focus-navigation-and-the-tabindex-attribute\n\n\n  if (validTabindex) {\n    return true;\n  }\n\n  var style = window.getComputedStyle(element, null);\n\n  if (isUserModifyWritable(style)) {\n    return true;\n  }\n\n  if (supports$1.focusImgIsmap && nodeName === 'img' && element.hasAttribute('ismap')) {\n    // IE10-11 considers the <img> in <a href><img ismap> focusable\n    // https://github.com/medialize/ally.js/issues/20\n    var hasLinkParent = getParents({\n      context: element\n    }).some(function (parent) {\n      return parent.nodeName.toLowerCase() === 'a' && parent.hasAttribute('href');\n    });\n\n    if (hasLinkParent) {\n      return true;\n    }\n  } // https://github.com/medialize/ally.js/issues/21\n\n\n  if (!except.scrollable && supports$1.focusScrollContainer) {\n    if (supports$1.focusScrollContainerWithoutOverflow) {\n      // Internet Explorer does will consider the scrollable area focusable\n      // if the element is a <div> or a <span> and it is in fact scrollable,\n      // regardless of the CSS overflow property\n      if (isScrollableContainer(element, nodeName)) {\n        return true;\n      }\n    } else if (hasCssOverflowScroll(style)) {\n      // Firefox requires proper overflow setting, IE does not necessarily\n      // https://developer.mozilla.org/en-US/docs/Web/CSS/overflow\n      return true;\n    }\n  }\n\n  if (!except.flexbox && supports$1.focusFlexboxContainer && hasCssDisplayFlex(style)) {\n    // elements with display:flex are focusable in IE10-11\n    return true;\n  }\n\n  var parent = element.parentElement;\n\n  if (!except.scrollable && parent) {\n    var parentNodeName = parent.nodeName.toLowerCase();\n    var parentStyle = window.getComputedStyle(parent, null);\n\n    if (supports$1.focusScrollBody && isScrollableContainer(parent, nodeName, parentNodeName, parentStyle)) {\n      // scrollable bodies are focusable Internet Explorer\n      // https://github.com/medialize/ally.js/issues/21\n      return true;\n    } // Children of focusable elements with display:flex are focusable in IE10-11\n\n\n    if (supports$1.focusChildrenOfFocusableFlexbox) {\n      if (hasCssDisplayFlex(parentStyle)) {\n        return true;\n      }\n    }\n  } // NOTE: elements marked as inert are not focusable,\n  // but that property is not exposed to the DOM\n  // https://www.w3.org/TR/html5/editing.html#inert\n\n\n  return false;\n} // bind exceptions to an iterator callback\n\n\nisFocusRelevantRules.except = function () {\n  var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var isFocusRelevant = function isFocusRelevant(context) {\n    return isFocusRelevantRules({\n      context: context,\n      except: except\n    });\n  };\n\n  isFocusRelevant.rules = isFocusRelevantRules;\n  return isFocusRelevant;\n}; // provide isFocusRelevant(context) as default iterator callback\n\n\nvar isFocusRelevant = isFocusRelevantRules.except({});\n\nfunction findIndex(array, callback) {\n  // attempt to use native or polyfilled Array#findIndex first\n  if (array.findIndex) {\n    return array.findIndex(callback);\n  }\n\n  var length = array.length; // shortcut if the array is empty\n\n  if (length === 0) {\n    return -1;\n  } // otherwise loop over array\n\n\n  for (var i = 0; i < length; i++) {\n    if (callback(array[i], i, array)) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\nfunction getContentDocument(node) {\n  try {\n    // works on <object> and <iframe>\n    return node.contentDocument || // works on <object> and <iframe>\n    node.contentWindow && node.contentWindow.document || // works on <object> and <iframe> that contain SVG\n    node.getSVGDocument && node.getSVGDocument() || null;\n  } catch (e) {\n    // SecurityError: Failed to read the 'contentDocument' property from 'HTMLObjectElement'\n    // also IE may throw member not found exception e.g. on <object type=\"image/png\">\n    return null;\n  }\n}\n\nfunction getWindow(node) {\n  var _document = getDocument(node);\n\n  return _document.defaultView || window;\n}\n\nvar shadowPrefix = void 0;\n\nfunction selectInShadows(selector) {\n  if (typeof shadowPrefix !== 'string') {\n    var operator = cssShadowPiercingDeepCombinator();\n\n    if (operator) {\n      shadowPrefix = ', html ' + operator + ' ';\n    }\n  }\n\n  if (!shadowPrefix) {\n    return selector;\n  }\n\n  return selector + shadowPrefix + selector.replace(/\\s*,\\s*/g, ',').split(',').join(shadowPrefix);\n}\n\nvar selector = void 0;\n\nfunction findDocumentHostElement(_window) {\n  if (!selector) {\n    selector = selectInShadows('object, iframe');\n  }\n\n  if (_window._frameElement !== undefined) {\n    return _window._frameElement;\n  }\n\n  _window._frameElement = null;\n\n  var potentialHosts = _window.parent.document.querySelectorAll(selector);\n\n  [].some.call(potentialHosts, function (element) {\n    var _document = getContentDocument(element);\n\n    if (_document !== _window.document) {\n      return false;\n    }\n\n    _window._frameElement = element;\n    return true;\n  });\n  return _window._frameElement;\n}\n\nfunction getFrameElement(element) {\n  var _window = getWindow(element);\n\n  if (!_window.parent || _window.parent === _window) {\n    // if there is no parent browsing context,\n    // we're not going to get a frameElement either way\n    return null;\n  }\n\n  try {\n    // see https://developer.mozilla.org/en-US/docs/Web/API/Window/frameElement\n    // does not work within <embed> anywhere, and not within in <object> in IE\n    return _window.frameElement || findDocumentHostElement(_window);\n  } catch (e) {\n    return null;\n  }\n} // https://www.w3.org/TR/html5/rendering.html#being-rendered\n// <area> is not rendered, but we *consider* it visible to simplfiy this function's usage\n\n\nvar notRenderedElementsPattern = /^(area)$/;\n\nfunction computedStyle(element, property) {\n  return window.getComputedStyle(element, null).getPropertyValue(property);\n}\n\nfunction notDisplayed(_path) {\n  return _path.some(function (element) {\n    // display:none is not visible (optimized away at layout)\n    return computedStyle(element, 'display') === 'none';\n  });\n}\n\nfunction notVisible(_path) {\n  // https://github.com/jquery/jquery-ui/blob/master/ui/core.js#L109-L114\n  // NOTE: a nested element can reverse visibility:hidden|collapse by explicitly setting visibility:visible\n  // NOTE: visibility can be [\"\", \"visible\", \"hidden\", \"collapse\"]\n  var hidden = findIndex(_path, function (element) {\n    var visibility = computedStyle(element, 'visibility');\n    return visibility === 'hidden' || visibility === 'collapse';\n  });\n\n  if (hidden === -1) {\n    // there is no hidden element\n    return false;\n  }\n\n  var visible = findIndex(_path, function (element) {\n    return computedStyle(element, 'visibility') === 'visible';\n  });\n\n  if (visible === -1) {\n    // there is no visible element (but a hidden element)\n    return true;\n  }\n\n  if (hidden < visible) {\n    // there is a hidden element and it's closer than the first visible element\n    return true;\n  } // there may be a hidden element, but the closest element is visible\n\n\n  return false;\n}\n\nfunction collapsedParent(_path) {\n  var offset = 1;\n\n  if (_path[0].nodeName.toLowerCase() === 'summary') {\n    offset = 2;\n  }\n\n  return _path.slice(offset).some(function (element) {\n    // \"content children\" of a closed details element are not visible\n    return element.nodeName.toLowerCase() === 'details' && element.open === false;\n  });\n}\n\nfunction isVisibleRules() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      _ref$except = _ref.except,\n      except = _ref$except === undefined ? {\n    notRendered: false,\n    cssDisplay: false,\n    cssVisibility: false,\n    detailsElement: false,\n    browsingContext: false\n  } : _ref$except;\n\n  var element = contextToElement({\n    label: 'is/visible',\n    resolveDocument: true,\n    context: context\n  });\n  var nodeName = element.nodeName.toLowerCase();\n\n  if (!except.notRendered && notRenderedElementsPattern.test(nodeName)) {\n    return true;\n  }\n\n  var _path = getParents({\n    context: element\n  }); // in Internet Explorer <audio> has a default display: none, where others have display: inline\n  // but IE allows focusing <audio style=\"display:none\">, but not <div display:none><audio>\n  // this is irrelevant to other browsers, as the controls attribute is required to make <audio> focusable\n\n\n  var isAudioWithoutControls = nodeName === 'audio' && !element.hasAttribute('controls');\n\n  if (!except.cssDisplay && notDisplayed(isAudioWithoutControls ? _path.slice(1) : _path)) {\n    return false;\n  }\n\n  if (!except.cssVisibility && notVisible(_path)) {\n    return false;\n  }\n\n  if (!except.detailsElement && collapsedParent(_path)) {\n    return false;\n  }\n\n  if (!except.browsingContext) {\n    // elements within a browsing context are affected by the\n    // browsing context host element's visibility and tabindex\n    var frameElement = getFrameElement(element);\n\n    var _isVisible = isVisibleRules.except(except);\n\n    if (frameElement && !_isVisible(frameElement)) {\n      return false;\n    }\n  }\n\n  return true;\n} // bind exceptions to an iterator callback\n\n\nisVisibleRules.except = function () {\n  var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var isVisible = function isVisible(context) {\n    return isVisibleRules({\n      context: context,\n      except: except\n    });\n  };\n\n  isVisible.rules = isVisibleRules;\n  return isVisible;\n}; // provide isVisible(context) as default iterator callback\n\n\nvar isVisible = isVisibleRules.except({});\n\nfunction getMapByName(name, _document) {\n  // apparently getElementsByName() also considers id attribute in IE & opera\n  // https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByName\n  var map = _document.querySelector('map[name=\"' + css_escape_1[\"default\"](name) + '\"]');\n\n  return map || null;\n}\n\nfunction getImageOfArea(element) {\n  var map = element.parentElement;\n\n  if (!map.name || map.nodeName.toLowerCase() !== 'map') {\n    return null;\n  } // NOTE: image maps can also be applied to <object> with image content,\n  // but no browser supports this at the moment\n  // HTML5 specifies HTMLMapElement.images to be an HTMLCollection of all\n  // <img> and <object> referencing the <map> element, but no browser implements this\n  //   https://www.w3.org/TR/html5/embedded-content-0.html#the-map-element\n  //   https://developer.mozilla.org/en-US/docs/Web/API/HTMLMapElement\n  // the image must be valid and loaded for the map to take effect\n\n\n  var _document = getDocument(element);\n\n  return _document.querySelector('img[usemap=\"#' + css_escape_1[\"default\"](map.name) + '\"]') || null;\n}\n\nvar supports$2 = void 0; // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/map\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\n// https://github.com/jquery/jquery-ui/blob/master/ui/core.js#L88-L107\n\nfunction isValidArea(context) {\n  if (!supports$2) {\n    supports$2 = _supports();\n  }\n\n  var element = contextToElement({\n    label: 'is/valid-area',\n    context: context\n  });\n  var nodeName = element.nodeName.toLowerCase();\n\n  if (nodeName !== 'area') {\n    return false;\n  }\n\n  var hasTabindex = element.hasAttribute('tabindex');\n\n  if (!supports$2.focusAreaTabindex && hasTabindex) {\n    // Blink and WebKit do not consider <area tabindex=\"-1\" href=\"#void\"> focusable\n    return false;\n  }\n\n  var img = getImageOfArea(element);\n\n  if (!img || !isVisible(img)) {\n    return false;\n  } // Firefox only allows fully loaded images to reference image maps\n  // https://stereochro.me/ideas/detecting-broken-images-js\n\n\n  if (!supports$2.focusBrokenImageMap && (!img.complete || !img.naturalHeight || img.offsetWidth <= 0 || img.offsetHeight <= 0)) {\n    return false;\n  } // Firefox supports.can focus area elements even if they don't have an href attribute\n\n\n  if (!supports$2.focusAreaWithoutHref && !element.href) {\n    // Internet explorer supports.can focus area elements without href if either\n    // the area element or the image element has a tabindex attribute\n    return supports$2.focusAreaTabindex && hasTabindex || supports$2.focusAreaImgTabindex && img.hasAttribute('tabindex');\n  } // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\n\n\n  var childOfInteractive = getParents({\n    context: img\n  }).slice(1).some(function (_element) {\n    var name = _element.nodeName.toLowerCase();\n\n    return name === 'button' || name === 'a';\n  });\n\n  if (childOfInteractive) {\n    return false;\n  }\n\n  return true;\n}\n\nvar supports$3 = void 0; // https://www.w3.org/TR/html5/disabled-elements.html#concept-element-disabled\n\nvar disabledElementsPattern = void 0;\nvar disabledElements = {\n  input: true,\n  select: true,\n  textarea: true,\n  button: true,\n  fieldset: true,\n  form: true\n};\n\nfunction isNativeDisabledSupported(context) {\n  if (!supports$3) {\n    supports$3 = _supports();\n\n    if (supports$3.focusFieldsetDisabled) {\n      delete disabledElements.fieldset;\n    }\n\n    if (supports$3.focusFormDisabled) {\n      delete disabledElements.form;\n    }\n\n    disabledElementsPattern = new RegExp('^(' + Object.keys(disabledElements).join('|') + ')$');\n  }\n\n  var element = contextToElement({\n    label: 'is/native-disabled-supported',\n    context: context\n  });\n  var nodeName = element.nodeName.toLowerCase();\n  return Boolean(disabledElementsPattern.test(nodeName));\n}\n\nvar supports$4 = void 0;\n\nfunction isDisabledFieldset(element) {\n  var nodeName = element.nodeName.toLowerCase();\n  return nodeName === 'fieldset' && element.disabled;\n}\n\nfunction isDisabledForm(element) {\n  var nodeName = element.nodeName.toLowerCase();\n  return nodeName === 'form' && element.disabled;\n}\n\nfunction isDisabled(context) {\n  if (!supports$4) {\n    supports$4 = _supports();\n  }\n\n  var element = contextToElement({\n    label: 'is/disabled',\n    context: context\n  });\n\n  if (element.hasAttribute('data-ally-disabled')) {\n    // treat ally's element/disabled like the DOM native element.disabled\n    return true;\n  }\n\n  if (!isNativeDisabledSupported(element)) {\n    // non-form elements do not support the disabled attribute\n    return false;\n  }\n\n  if (element.disabled) {\n    // the element itself is disabled\n    return true;\n  }\n\n  var parents = getParents({\n    context: element\n  });\n\n  if (parents.some(isDisabledFieldset)) {\n    // a parental <fieldset> is disabld and inherits the state onto this element\n    return true;\n  }\n\n  if (!supports$4.focusFormDisabled && parents.some(isDisabledForm)) {\n    // a parental <form> is disabld and inherits the state onto this element\n    return true;\n  }\n\n  return false;\n}\n\nfunction isOnlyTabbableRules() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      _ref$except = _ref.except,\n      except = _ref$except === undefined ? {\n    onlyFocusableBrowsingContext: false,\n    visible: false\n  } : _ref$except;\n\n  var element = contextToElement({\n    label: 'is/only-tabbable',\n    resolveDocument: true,\n    context: context\n  });\n\n  if (!except.visible && !isVisible(element)) {\n    return false;\n  }\n\n  if (!except.onlyFocusableBrowsingContext && (platform.is.GECKO || platform.is.TRIDENT || platform.is.EDGE)) {\n    var frameElement = getFrameElement(element);\n\n    if (frameElement) {\n      if (tabindexValue(frameElement) < 0) {\n        // iframe[tabindex=\"-1\"] and object[tabindex=\"-1\"] inherit the\n        // tabbable demotion onto elements of their browsing contexts\n        return false;\n      }\n    }\n  }\n\n  var nodeName = element.nodeName.toLowerCase();\n  var tabindex = tabindexValue(element);\n\n  if (nodeName === 'label' && platform.is.GECKO) {\n    // Firefox cannot focus, but tab to: label[tabindex=0]\n    return tabindex !== null && tabindex >= 0;\n  } // SVG Elements were keyboard focusable but not script focusable before Firefox 51.\n  // Firefox 51 added the focus management DOM API (.focus and .blur) to SVGElement,\n  // see https://bugzilla.mozilla.org/show_bug.cgi?id=778654\n\n\n  if (platform.is.GECKO && element.ownerSVGElement && !element.focus) {\n    if (nodeName === 'a' && element.hasAttribute('xlink:href')) {\n      // any focusable child of <svg> cannot be focused, but tabbed to\n      if (platform.is.GECKO) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n} // bind exceptions to an iterator callback\n\n\nisOnlyTabbableRules.except = function () {\n  var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var isOnlyTabbable = function isOnlyTabbable(context) {\n    return isOnlyTabbableRules({\n      context: context,\n      except: except\n    });\n  };\n\n  isOnlyTabbable.rules = isOnlyTabbableRules;\n  return isOnlyTabbable;\n}; // provide isOnlyTabbable(context) as default iterator callback\n\n\nvar isOnlyTabbable = isOnlyTabbableRules.except({});\nvar supports$5 = void 0;\n\nfunction isOnlyFocusRelevant(element) {\n  var nodeName = element.nodeName.toLowerCase();\n\n  if (nodeName === 'embed' || nodeName === 'keygen') {\n    // embed is considered focus-relevant but not focusable\n    // see https://github.com/medialize/ally.js/issues/82\n    return true;\n  }\n\n  var _tabindex = tabindexValue(element);\n\n  if (element.shadowRoot && _tabindex === null) {\n    // ShadowDOM host elements *may* receive focus\n    // even though they are not considered focuable\n    return true;\n  }\n\n  if (nodeName === 'label') {\n    // <label tabindex=\"0\"> is only tabbable in Firefox, not script-focusable\n    // there's no way to make an element focusable other than by adding a tabindex,\n    // and focus behavior of the label element seems hard-wired to ignore tabindex\n    // in some browsers (like Gecko, Blink and WebKit)\n    return !supports$5.focusLabelTabindex || _tabindex === null;\n  }\n\n  if (nodeName === 'legend') {\n    return _tabindex === null;\n  }\n\n  if (supports$5.focusSvgFocusableAttribute && (element.ownerSVGElement || nodeName === 'svg')) {\n    // Internet Explorer understands the focusable attribute introduced in SVG Tiny 1.2\n    var focusableAttribute = element.getAttribute('focusable');\n    return focusableAttribute && focusableAttribute === 'false';\n  }\n\n  if (nodeName === 'img' && element.hasAttribute('usemap')) {\n    // Gecko, Trident and Edge do not allow an image with an image map and tabindex to be focused,\n    // it appears the tabindex is overruled so focus is still forwarded to the <map>\n    return _tabindex === null || !supports$5.focusImgUsemapTabindex;\n  }\n\n  if (nodeName === 'area') {\n    // all <area>s are considered relevant,\n    // but only the valid <area>s are focusable\n    return !isValidArea(element);\n  }\n\n  return false;\n}\n\nfunction isFocusableRules() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      _ref$except = _ref.except,\n      except = _ref$except === undefined ? {\n    disabled: false,\n    visible: false,\n    onlyTabbable: false\n  } : _ref$except;\n\n  if (!supports$5) {\n    supports$5 = _supports();\n  }\n\n  var _isOnlyTabbable = isOnlyTabbable.rules.except({\n    onlyFocusableBrowsingContext: true,\n    visible: except.visible\n  });\n\n  var element = contextToElement({\n    label: 'is/focusable',\n    resolveDocument: true,\n    context: context\n  });\n  var focusRelevant = isFocusRelevant.rules({\n    context: element,\n    except: except\n  });\n\n  if (!focusRelevant || isOnlyFocusRelevant(element)) {\n    return false;\n  }\n\n  if (!except.disabled && isDisabled(element)) {\n    return false;\n  }\n\n  if (!except.onlyTabbable && _isOnlyTabbable(element)) {\n    // some elements may be keyboard focusable, but not script focusable\n    return false;\n  } // elements that are not rendered, cannot be focused\n\n\n  if (!except.visible) {\n    var visibilityOptions = {\n      context: element,\n      except: {}\n    };\n\n    if (supports$5.focusInHiddenIframe) {\n      // WebKit and Blink can focus content in hidden <iframe> and <object>\n      visibilityOptions.except.browsingContext = true;\n    }\n\n    if (supports$5.focusObjectSvgHidden) {\n      // Blink allows focusing the object element, even if it has visibility: hidden;\n      // @browser-issue Blink https://code.google.com/p/chromium/issues/detail?id=586191\n      var _nodeName2 = element.nodeName.toLowerCase();\n\n      if (_nodeName2 === 'object') {\n        visibilityOptions.except.cssVisibility = true;\n      }\n    }\n\n    if (!isVisible.rules(visibilityOptions)) {\n      return false;\n    }\n  }\n\n  var frameElement = getFrameElement(element);\n\n  if (frameElement) {\n    var _nodeName = frameElement.nodeName.toLowerCase();\n\n    if (_nodeName === 'object' && !supports$5.focusInZeroDimensionObject) {\n      if (!frameElement.offsetWidth || !frameElement.offsetHeight) {\n        // WebKit can not focus content in <object> if it doesn't have dimensions\n        return false;\n      }\n    }\n  }\n\n  var nodeName = element.nodeName.toLowerCase();\n\n  if (nodeName === 'svg' && supports$5.focusSvgInIframe && !frameElement && element.getAttribute('tabindex') === null) {\n    return false;\n  }\n\n  return true;\n} // bind exceptions to an iterator callback\n\n\nisFocusableRules.except = function () {\n  var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var isFocusable = function isFocusable(context) {\n    return isFocusableRules({\n      context: context,\n      except: except\n    });\n  };\n\n  isFocusable.rules = isFocusableRules;\n  return isFocusable;\n}; // provide isFocusRelevant(context) as default iterator callback\n\n\nvar isFocusable = isFocusableRules.except({});\n\nfunction createFilter(condition) {\n  // see https://developer.mozilla.org/en-US/docs/Web/API/NodeFilter\n  var filter = function filter(node) {\n    if (node.shadowRoot) {\n      // return ShadowRoot elements regardless of them being focusable,\n      // so they can be walked recursively later\n      return NodeFilter.FILTER_ACCEPT;\n    }\n\n    if (condition(node)) {\n      // finds elements that could have been found by document.querySelectorAll()\n      return NodeFilter.FILTER_ACCEPT;\n    }\n\n    return NodeFilter.FILTER_SKIP;\n  }; // IE requires a function, Browsers require {acceptNode: function}\n  // see http://www.bennadel.com/blog/2607-finding-html-comment-nodes-in-the-dom-using-treewalker.htm\n\n\n  filter.acceptNode = filter;\n  return filter;\n}\n\nvar PossiblyFocusableFilter = createFilter(isFocusRelevant);\n\nfunction queryFocusableStrict() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      includeContext = _ref.includeContext,\n      includeOnlyTabbable = _ref.includeOnlyTabbable,\n      strategy = _ref.strategy;\n\n  if (!context) {\n    context = document.documentElement;\n  }\n\n  var _isFocusable = isFocusable.rules.except({\n    onlyTabbable: includeOnlyTabbable\n  });\n\n  var _document = getDocument(context); // see https://developer.mozilla.org/en-US/docs/Web/API/Document/createTreeWalker\n\n\n  var walker = _document.createTreeWalker( // root element to start search in\n  context, // element type filter\n  NodeFilter.SHOW_ELEMENT, // custom NodeFilter filter\n  strategy === 'all' ? PossiblyFocusableFilter : createFilter(_isFocusable), // deprecated, but IE requires it\n  false);\n\n  var list = [];\n\n  while (walker.nextNode()) {\n    if (walker.currentNode.shadowRoot) {\n      if (_isFocusable(walker.currentNode)) {\n        list.push(walker.currentNode);\n      }\n\n      list = list.concat(queryFocusableStrict({\n        context: walker.currentNode.shadowRoot,\n        includeOnlyTabbable: includeOnlyTabbable,\n        strategy: strategy\n      }));\n    } else {\n      list.push(walker.currentNode);\n    }\n  } // add context if requested and focusable\n\n\n  if (includeContext) {\n    if (strategy === 'all') {\n      if (isFocusRelevant(context)) {\n        list.unshift(context);\n      }\n    } else if (_isFocusable(context)) {\n      list.unshift(context);\n    }\n  }\n\n  return list;\n} // NOTE: this selector MUST *never* be used directly,\n\n\nvar supports$6 = void 0;\nvar selector$1 = void 0;\n\nfunction selector$2() {\n  if (!supports$6) {\n    supports$6 = _supports();\n  }\n\n  if (typeof selector$1 === 'string') {\n    return selector$1;\n  } // https://www.w3.org/TR/html5/editing.html#sequential-focus-navigation-and-the-tabindex-attribute\n\n\n  selector$1 = '' + ( // IE11 supports.can focus <table> and <td>\n  supports$6.focusTable ? 'table, td,' : '') + ( // IE11 supports.can focus <fieldset>\n  supports$6.focusFieldset ? 'fieldset,' : '') + // Namespace problems of [xlink:href] explained in https://stackoverflow.com/a/23047888/515124\n  // svg a[*|href] does not match in IE9, but since we're filtering\n  // through is/focusable we can include all <a> from SVG\n  'svg a,' + // may behave as 'svg, svg *,' in chrome as *every* svg element with a focus event listener is focusable\n  // navigational elements\n  'a[href],' + // validity determined by is/valid-area.js\n  'area[href],' + // validity determined by is/disabled.js\n  'input, select, textarea, button,' + // browsing context containers\n  'iframe, object, embed,' + // interactive content\n  'keygen,' + (supports$6.focusAudioWithoutControls ? 'audio,' : 'audio[controls],') + (supports$6.focusVideoWithoutControls ? 'video,' : 'video[controls],') + (supports$6.focusSummary ? 'summary,' : '') + // validity determined by is/valid-tabindex.js\n  '[tabindex],' + // editing hosts\n  '[contenteditable]'; // where ShadowDOM is supported, we also want the shadowed focusable elements (via \">>>\" or \"/deep/\")\n\n  selector$1 = selectInShadows(selector$1);\n  return selector$1;\n}\n\nfunction queryFocusableQuick() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      includeContext = _ref.includeContext,\n      includeOnlyTabbable = _ref.includeOnlyTabbable;\n\n  var _selector = selector$2();\n\n  var elements = context.querySelectorAll(_selector); // the selector potentially matches more than really is focusable\n\n  var _isFocusable = isFocusable.rules.except({\n    onlyTabbable: includeOnlyTabbable\n  });\n\n  var result = [].filter.call(elements, _isFocusable); // add context if requested and focusable\n\n  if (includeContext && _isFocusable(context)) {\n    result.unshift(context);\n  }\n\n  return result;\n}\n\nfunction queryFocusable() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      includeContext = _ref.includeContext,\n      includeOnlyTabbable = _ref.includeOnlyTabbable,\n      _ref$strategy = _ref.strategy,\n      strategy = _ref$strategy === undefined ? 'quick' : _ref$strategy;\n\n  var element = contextToElement({\n    label: 'query/focusable',\n    resolveDocument: true,\n    defaultToDocument: true,\n    context: context\n  });\n  var options = {\n    context: element,\n    includeContext: includeContext,\n    includeOnlyTabbable: includeOnlyTabbable,\n    strategy: strategy\n  };\n\n  if (strategy === 'quick') {\n    return queryFocusableQuick(options);\n  } else if (strategy === 'strict' || strategy === 'all') {\n    return queryFocusableStrict(options);\n  }\n\n  throw new TypeError('query/focusable requires option.strategy to be one of [\"quick\", \"strict\", \"all\"]');\n}\n\nvar supports$7 = void 0; // Internet Explorer 11 considers fieldset, table, td focusable, but not tabbable\n// Internet Explorer 11 considers body to have [tabindex=0], but does not allow tabbing to it\n\nvar focusableElementsPattern = /^(fieldset|table|td|body)$/;\n\nfunction isTabbableRules() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      _ref$except = _ref.except,\n      except = _ref$except === undefined ? {\n    flexbox: false,\n    scrollable: false,\n    shadow: false,\n    visible: false,\n    onlyTabbable: false\n  } : _ref$except;\n\n  if (!supports$7) {\n    supports$7 = _supports();\n  }\n\n  var element = contextToElement({\n    label: 'is/tabbable',\n    resolveDocument: true,\n    context: context\n  });\n\n  if (platform.is.BLINK && platform.is.ANDROID && platform.majorVersion > 42) {\n    // External keyboard support worked fine in CHrome 42, but stopped working in Chrome 45.\n    // The on-screen keyboard does not provide a way to focus the next input element (like iOS does).\n    // That leaves us with no option to advance focus by keyboard, ergo nothing is tabbable (keyboard focusable).\n    return false;\n  }\n\n  var frameElement = getFrameElement(element);\n\n  if (frameElement) {\n    if (platform.is.WEBKIT && platform.is.IOS) {\n      // iOS only does not consider anything from another browsing context keyboard focusable\n      return false;\n    } // iframe[tabindex=\"-1\"] and object[tabindex=\"-1\"] inherit the\n    // tabbable demotion onto elements of their browsing contexts\n\n\n    if (tabindexValue(frameElement) < 0) {\n      return false;\n    }\n\n    if (!except.visible && (platform.is.BLINK || platform.is.WEBKIT) && !isVisible(frameElement)) {\n      // Blink and WebKit consider elements in hidden browsing contexts focusable, but not tabbable\n      return false;\n    } // Webkit and Blink don't consider anything in <object> tabbable\n    // Blink fixed that fixed in Chrome 54, Opera 41\n\n\n    var frameNodeName = frameElement.nodeName.toLowerCase();\n\n    if (frameNodeName === 'object') {\n      var isFixedBlink = platform.name === 'Chrome' && platform.majorVersion >= 54 || platform.name === 'Opera' && platform.majorVersion >= 41;\n\n      if (platform.is.WEBKIT || platform.is.BLINK && !isFixedBlink) {\n        return false;\n      }\n    }\n  }\n\n  var nodeName = element.nodeName.toLowerCase();\n\n  var _tabindex = tabindexValue(element);\n\n  var tabindex = _tabindex === null ? null : _tabindex >= 0;\n\n  if (platform.is.EDGE && platform.majorVersion >= 14 && frameElement && element.ownerSVGElement && _tabindex < 0) {\n    // Edge 14+ considers <a xlink:href=\"â€¦\" tabindex=\"-1\"> keyboard focusable\n    // if the element is in a nested browsing context\n    return true;\n  }\n\n  var hasTabbableTabindexOrNone = tabindex !== false;\n  var hasTabbableTabindex = _tabindex !== null && _tabindex >= 0; // NOTE: Firefox 31 considers [contenteditable] to have [tabindex=-1], but allows tabbing to it\n  // fixed in Firefox 40 the latest - https://bugzilla.mozilla.org/show_bug.cgi?id=1185657\n\n  if (element.hasAttribute('contenteditable')) {\n    // tabbing can still be disabled by explicitly providing [tabindex=\"-1\"]\n    return hasTabbableTabindexOrNone;\n  }\n\n  if (focusableElementsPattern.test(nodeName) && tabindex !== true) {\n    return false;\n  }\n\n  if (platform.is.WEBKIT && platform.is.IOS) {\n    // iOS only considers a hand full of elements tabbable (keyboard focusable)\n    // this holds true even with external keyboards\n    var potentiallyTabbable = nodeName === 'input' && element.type === 'text' || element.type === 'password' || nodeName === 'select' || nodeName === 'textarea' || element.hasAttribute('contenteditable');\n\n    if (!potentiallyTabbable) {\n      var style = window.getComputedStyle(element, null);\n      potentiallyTabbable = isUserModifyWritable(style);\n    }\n\n    if (!potentiallyTabbable) {\n      return false;\n    }\n  }\n\n  if (nodeName === 'use' && _tabindex !== null) {\n    if (platform.is.BLINK || platform.is.WEBKIT && platform.majorVersion === 9) {\n      // In Chrome and Safari 9 the <use> element is keyboard focusable even for tabindex=\"-1\"\n      return true;\n    }\n  }\n\n  if (elementMatches(element, 'svg a') && element.hasAttribute('xlink:href')) {\n    if (hasTabbableTabindexOrNone) {\n      // in Trident and Gecko SVGElement does not handle the tabIndex property properly\n      return true;\n    }\n\n    if (element.focus && !supports$7.focusSvgNegativeTabindexAttribute) {\n      // Firefox 51 and 52 treat any natively tabbable SVG element with\n      // tabindex=\"-1\" as tabbable and everything else as inert\n      // see https://bugzilla.mozilla.org/show_bug.cgi?id=1302340\n      return true;\n    }\n  }\n\n  if (nodeName === 'svg' && supports$7.focusSvgInIframe && hasTabbableTabindexOrNone) {\n    return true;\n  }\n\n  if (platform.is.TRIDENT || platform.is.EDGE) {\n    if (nodeName === 'svg') {\n      if (supports$7.focusSvg) {\n        // older Internet Explorers consider <svg> keyboard focusable\n        // unless they have focsable=\"false\", but then they wouldn't\n        // be focusable and thus not even reach this filter\n        return true;\n      } // elements that have [focusable] are automatically keyboard focusable regardless of the attribute's value\n\n\n      return element.hasAttribute('focusable') || hasTabbableTabindex;\n    }\n\n    if (element.ownerSVGElement) {\n      if (supports$7.focusSvgTabindexAttribute && hasTabbableTabindex) {\n        return true;\n      } // elements that have [focusable] are automatically keyboard focusable regardless of the attribute's value\n\n\n      return element.hasAttribute('focusable');\n    }\n  }\n\n  if (element.tabIndex === undefined) {\n    return Boolean(except.onlyTabbable);\n  }\n\n  if (nodeName === 'audio') {\n    if (!element.hasAttribute('controls')) {\n      // In Internet Explorer the <audio> element is focusable, but not tabbable, and tabIndex property is wrong\n      return false;\n    } else if (platform.is.BLINK) {\n      // In Chrome <audio controls tabindex=\"-1\"> remains keyboard focusable\n      return true;\n    }\n  }\n\n  if (nodeName === 'video') {\n    if (!element.hasAttribute('controls')) {\n      if (platform.is.TRIDENT || platform.is.EDGE) {\n        // In Internet Explorer and Edge the <video> element is focusable, but not tabbable, and tabIndex property is wrong\n        return false;\n      }\n    } else if (platform.is.BLINK || platform.is.GECKO) {\n      // In Chrome and Firefox <video controls tabindex=\"-1\"> remains keyboard focusable\n      return true;\n    }\n  }\n\n  if (nodeName === 'object') {\n    if (platform.is.BLINK || platform.is.WEBKIT) {\n      // In all Blink and WebKit based browsers <embed> and <object> are never keyboard focusable, even with tabindex=\"0\" set\n      return false;\n    }\n  }\n\n  if (nodeName === 'iframe') {\n    // In Internet Explorer all iframes are only focusable\n    // In WebKit, Blink and Gecko iframes may be tabbable depending on content.\n    // Since we can't reliably investigate iframe documents because of the\n    // SameOriginPolicy, we're declaring everything only focusable.\n    return false;\n  }\n\n  if (!except.scrollable && platform.is.GECKO) {\n    // Firefox considers scrollable containers keyboard focusable,\n    // even though their tabIndex property is -1\n    var _style = window.getComputedStyle(element, null);\n\n    if (hasCssOverflowScroll(_style)) {\n      return hasTabbableTabindexOrNone;\n    }\n  }\n\n  if (platform.is.TRIDENT || platform.is.EDGE) {\n    // IE and Edge degrade <area> to script focusable, if the image\n    // using the <map> has been given tabindex=\"-1\"\n    if (nodeName === 'area') {\n      var img = getImageOfArea(element);\n\n      if (img && tabindexValue(img) < 0) {\n        return false;\n      }\n    }\n\n    var _style2 = window.getComputedStyle(element, null);\n\n    if (isUserModifyWritable(_style2)) {\n      // prevent being swallowed by the overzealous isScrollableContainer() below\n      return element.tabIndex >= 0;\n    }\n\n    if (!except.flexbox && hasCssDisplayFlex(_style2)) {\n      if (_tabindex !== null) {\n        return hasTabbableTabindex;\n      }\n\n      return isFocusRelevantWithoutFlexbox(element) && isTabbableWithoutFlexbox(element);\n    } // IE considers scrollable containers script focusable only,\n    // even though their tabIndex property is 0\n\n\n    if (isScrollableContainer(element, nodeName)) {\n      return false;\n    }\n\n    var parent = element.parentElement;\n\n    if (parent) {\n      var parentNodeName = parent.nodeName.toLowerCase();\n      var parentStyle = window.getComputedStyle(parent, null); // IE considers scrollable bodies script focusable only,\n\n      if (isScrollableContainer(parent, nodeName, parentNodeName, parentStyle)) {\n        return false;\n      } // Children of focusable elements with display:flex are focusable in IE10-11,\n      // even though their tabIndex property suggests otherwise\n\n\n      if (hasCssDisplayFlex(parentStyle)) {\n        // value of tabindex takes precedence\n        return hasTabbableTabindex;\n      }\n    }\n  } // https://www.w3.org/WAI/PF/aria-practices/#focus_tabindex\n\n\n  return element.tabIndex >= 0;\n} // bind exceptions to an iterator callback\n\n\nisTabbableRules.except = function () {\n  var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var isTabbable = function isTabbable(context) {\n    return isTabbableRules({\n      context: context,\n      except: except\n    });\n  };\n\n  isTabbable.rules = isTabbableRules;\n  return isTabbable;\n};\n\nvar isFocusRelevantWithoutFlexbox = isFocusRelevant.rules.except({\n  flexbox: true\n});\nvar isTabbableWithoutFlexbox = isTabbableRules.except({\n  flexbox: true\n}); // provide isTabbable(context) as default iterator callback\n\nvar isTabbable = isTabbableRules.except({});\n\nfunction queryTabbable() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      includeContext = _ref.includeContext,\n      includeOnlyTabbable = _ref.includeOnlyTabbable,\n      strategy = _ref.strategy;\n\n  var _isTabbable = isTabbable.rules.except({\n    onlyTabbable: includeOnlyTabbable\n  });\n\n  return queryFocusable({\n    context: context,\n    includeContext: includeContext,\n    includeOnlyTabbable: includeOnlyTabbable,\n    strategy: strategy\n  }).filter(_isTabbable);\n} // sorts a list of elements according to their order in the DOM\n\n\nfunction compareDomPosition(a, b) {\n  return a.compareDocumentPosition(b) & Node.DOCUMENT_POSITION_FOLLOWING ? -1 : 1;\n}\n\nfunction sortDomOrder(elements) {\n  return elements.sort(compareDomPosition);\n}\n\nfunction getFirstSuccessorOffset(list, target) {\n  // find the first element that comes AFTER the target element\n  return findIndex(list, function (element) {\n    return target.compareDocumentPosition(element) & Node.DOCUMENT_POSITION_FOLLOWING;\n  });\n}\n\nfunction findInsertionOffsets(list, elements, resolveElement) {\n  // instead of mutating the elements list directly, remember position and map\n  // to inject later, when we can do this more efficiently\n  var insertions = [];\n  elements.forEach(function (element) {\n    var replace = true;\n    var offset = list.indexOf(element);\n\n    if (offset === -1) {\n      // element is not in target list\n      offset = getFirstSuccessorOffset(list, element);\n      replace = false;\n    }\n\n    if (offset === -1) {\n      // there is no successor in the tabsequence,\n      // meaning the image must be the last element\n      offset = list.length;\n    } // allow the consumer to replace the injected element\n\n\n    var injections = nodeArray(resolveElement ? resolveElement(element) : element);\n\n    if (!injections.length) {\n      // we can't inject zero elements\n      return;\n    }\n\n    insertions.push({\n      offset: offset,\n      replace: replace,\n      elements: injections\n    });\n  });\n  return insertions;\n}\n\nfunction insertElementsAtOffsets(list, insertions) {\n  // remember the number of elements we have already injected\n  // so we account for the caused index offset\n  var inserted = 0; // make sure that we insert the elements in sequence,\n  // otherwise the offset compensation won't work\n\n  insertions.sort(function (a, b) {\n    return a.offset - b.offset;\n  });\n  insertions.forEach(function (insertion) {\n    // array.splice has an annoying function signature :(\n    var remove = insertion.replace ? 1 : 0;\n    var args = [insertion.offset + inserted, remove].concat(insertion.elements);\n    list.splice.apply(list, args);\n    inserted += insertion.elements.length - remove;\n  });\n}\n\nfunction mergeInDomOrder() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      list = _ref.list,\n      elements = _ref.elements,\n      resolveElement = _ref.resolveElement; // operate on a copy so we don't mutate the original array\n\n\n  var _list = list.slice(0); // make sure the elements we're injecting are provided in DOM order\n\n\n  var _elements = nodeArray(elements).slice(0);\n\n  sortDomOrder(_elements); // find the offsets within the target array (list) at which to inject\n  // each individual element (from elements)\n\n  var insertions = findInsertionOffsets(_list, _elements, resolveElement); // actually inject the elements into the target array at the identified positions\n\n  insertElementsAtOffsets(_list, insertions);\n  return _list;\n}\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError('Cannot call a class as a function');\n  }\n}\n\nvar Maps = function () {\n  function Maps(context) {\n    _classCallCheck(this, Maps);\n\n    this._document = getDocument(context);\n    this.maps = {};\n  }\n\n  _createClass(Maps, [{\n    key: 'getAreasFor',\n    value: function getAreasFor(name) {\n      if (!this.maps[name]) {\n        // the map is not defined within the context, so we\n        // have to go find it elsewhere in the document\n        this.addMapByName(name);\n      }\n\n      return this.maps[name];\n    }\n  }, {\n    key: 'addMapByName',\n    value: function addMapByName(name) {\n      var map = getMapByName(name, this._document);\n\n      if (!map) {\n        // if there is no map, the img[usemap] wasn't doing anything anyway\n        return;\n      }\n\n      this.maps[map.name] = queryTabbable({\n        context: map\n      });\n    }\n  }, {\n    key: 'extractAreasFromList',\n    value: function extractAreasFromList(elements) {\n      // remove all <area> elements from the elements list,\n      // but put them the map for later retrieval\n      return elements.filter(function (element) {\n        var nodeName = element.nodeName.toLowerCase();\n\n        if (nodeName !== 'area') {\n          return true;\n        }\n\n        var map = element.parentNode;\n\n        if (!this.maps[map.name]) {\n          this.maps[map.name] = [];\n        }\n\n        this.maps[map.name].push(element);\n        return false;\n      }, this);\n    }\n  }]);\n\n  return Maps;\n}();\n\nfunction sortArea(elements, context) {\n  // images - unless they are focusable themselves, likely not\n  // part of the elements list, so we'll have to find them and\n  // sort them into the elements list manually\n  var usemaps = context.querySelectorAll('img[usemap]');\n  var maps = new Maps(context); // remove all <area> elements from the elements list,\n  // but put them the map for later retrieval\n\n  var _elements = maps.extractAreasFromList(elements);\n\n  if (!usemaps.length) {\n    // the context does not contain any <area>s so no need\n    // to replace anything, just remove any maps\n    return _elements;\n  }\n\n  return mergeInDomOrder({\n    list: _elements,\n    elements: usemaps,\n    resolveElement: function resolveElement(image) {\n      var name = image.getAttribute('usemap').slice(1);\n      return maps.getAreasFor(name);\n    }\n  });\n}\n\nvar _createClass$1 = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nfunction _classCallCheck$1(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError('Cannot call a class as a function');\n  }\n}\n\nvar Shadows = function () {\n  function Shadows(context, sortElements) {\n    _classCallCheck$1(this, Shadows); // document context we're working with\n\n\n    this.context = context; // callback that sorts an array of elements\n\n    this.sortElements = sortElements; // reference to create unique IDs for each ShadowHost\n\n    this.hostCounter = 1; // reference map for child-ShadowHosts of a ShadowHost\n\n    this.inHost = {}; // reference map for child-ShadowHost of the document\n\n    this.inDocument = []; // reference map for ShadowHosts\n\n    this.hosts = {}; // reference map for tabbable elements of a ShadowHost\n\n    this.elements = {};\n  } // remember which hosts we have to sort within later\n\n\n  _createClass$1(Shadows, [{\n    key: '_registerHost',\n    value: function _registerHost(host) {\n      if (host._sortingId) {\n        return;\n      } // make the ShadowHost identifiable (see cleanup() for undo)\n\n\n      host._sortingId = 'shadow-' + this.hostCounter++;\n      this.hosts[host._sortingId] = host; // hosts may contain other hosts\n\n      var parentHost = getShadowHost({\n        context: host\n      });\n\n      if (parentHost) {\n        this._registerHost(parentHost);\n\n        this._registerHostParent(host, parentHost);\n      } else {\n        this.inDocument.push(host);\n      }\n    }\n  }, {\n    key: '_registerHostParent',\n    value: function _registerHostParent(host, parent) {\n      if (!this.inHost[parent._sortingId]) {\n        this.inHost[parent._sortingId] = [];\n      }\n\n      this.inHost[parent._sortingId].push(host);\n    }\n  }, {\n    key: '_registerElement',\n    value: function _registerElement(element, host) {\n      if (!this.elements[host._sortingId]) {\n        this.elements[host._sortingId] = [];\n      }\n\n      this.elements[host._sortingId].push(element);\n    }\n  }, {\n    key: 'extractElements',\n    value: function extractElements(elements) {\n      return elements.filter(function (element) {\n        var host = getShadowHost({\n          context: element\n        });\n\n        if (!host) {\n          return true;\n        }\n\n        this._registerHost(host);\n\n        this._registerElement(element, host);\n\n        return false;\n      }, this);\n    }\n  }, {\n    key: 'sort',\n    value: function sort(elements) {\n      var _elements = this._injectHosts(elements);\n\n      _elements = this._replaceHosts(_elements);\n\n      this._cleanup();\n\n      return _elements;\n    }\n  }, {\n    key: '_injectHosts',\n    value: function _injectHosts(elements) {\n      Object.keys(this.hosts).forEach(function (_sortingId) {\n        var _list = this.elements[_sortingId];\n        var _elements = this.inHost[_sortingId];\n        var _context = this.hosts[_sortingId].shadowRoot;\n        this.elements[_sortingId] = this._merge(_list, _elements, _context);\n      }, this);\n      return this._merge(elements, this.inDocument, this.context);\n    }\n  }, {\n    key: '_merge',\n    value: function _merge(list, elements, context) {\n      var merged = mergeInDomOrder({\n        list: list,\n        elements: elements\n      });\n      return this.sortElements(merged, context);\n    }\n  }, {\n    key: '_replaceHosts',\n    value: function _replaceHosts(elements) {\n      return mergeInDomOrder({\n        list: elements,\n        elements: this.inDocument,\n        resolveElement: this._resolveHostElement.bind(this)\n      });\n    }\n  }, {\n    key: '_resolveHostElement',\n    value: function _resolveHostElement(host) {\n      var merged = mergeInDomOrder({\n        list: this.elements[host._sortingId],\n        elements: this.inHost[host._sortingId],\n        resolveElement: this._resolveHostElement.bind(this)\n      });\n\n      var _tabindex = tabindexValue(host);\n\n      if (_tabindex !== null && _tabindex > -1) {\n        return [host].concat(merged);\n      }\n\n      return merged;\n    }\n  }, {\n    key: '_cleanup',\n    value: function _cleanup() {\n      // remove those identifers we put on the ShadowHost to avoid using Map()\n      Object.keys(this.hosts).forEach(function (key) {\n        delete this.hosts[key]._sortingId;\n      }, this);\n    }\n  }]);\n\n  return Shadows;\n}();\n\nfunction sortShadowed(elements, context, sortElements) {\n  var shadows = new Shadows(context, sortElements);\n\n  var _elements = shadows.extractElements(elements);\n\n  if (_elements.length === elements.length) {\n    // no shadowed content found, no need to continue\n    return sortElements(elements);\n  }\n\n  return shadows.sort(_elements);\n}\n\nfunction sortTabindex(elements) {\n  // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement.tabIndex\n  // elements with tabIndex \"0\" (including tabbableElements without tabIndex) should be navigated in the order they appear.\n  // elements with a positive tabIndex:\n  //   Elements that have identical tabIndexes should be navigated in the order they appear.\n  //   Navigation proceeds from the lowest tabIndex to the highest tabIndex.\n  // NOTE: sort implementation may be unstable and thus mess up DOM order,\n  // that's why we build a map that's being sorted instead. If we were able to rely\n  // on a stable sorting algorithm, sortTabindex() could be as simple as\n  // elements.sort(function(a, b) { return a.tabIndex - b.tabIndex; });\n  // at this time Chrome does not use a stable sorting algorithm\n  // see http://blog.rodneyrehm.de/archives/14-Sorting-Were-Doing-It-Wrong.html#stability\n  // NOTE: compareDocumentPosition seemed like more overhead than just sorting this with buckets\n  // https://developer.mozilla.org/en-US/docs/Web/API/Node.compareDocumentPosition\n  var map = {};\n  var indexes = [];\n  var normal = elements.filter(function (element) {\n    // in Trident and Gecko SVGElement does not know about the tabIndex property\n    var tabIndex = element.tabIndex;\n\n    if (tabIndex === undefined) {\n      tabIndex = tabindexValue(element);\n    } // extract elements that don't need sorting\n\n\n    if (tabIndex <= 0 || tabIndex === null || tabIndex === undefined) {\n      return true;\n    }\n\n    if (!map[tabIndex]) {\n      // create sortable bucket for dom-order-preservation of elements with the same tabIndex\n      map[tabIndex] = []; // maintain a list of unique tabIndexes\n\n      indexes.push(tabIndex);\n    } // sort element into the proper bucket\n\n\n    map[tabIndex].push(element); // element moved to sorting map, so not \"normal\" anymore\n\n    return false;\n  }); // sort the tabindex ascending,\n  // then resolve them to their appropriate buckets,\n  // then flatten the array of arrays to an array\n\n  var _elements = indexes.sort().map(function (tabIndex) {\n    return map[tabIndex];\n  }).reduceRight(function (previous, current) {\n    return current.concat(previous);\n  }, normal);\n\n  return _elements;\n}\n\nvar supports$8 = void 0;\n\nfunction moveContextToBeginning(elements, context) {\n  var pos = elements.indexOf(context);\n\n  if (pos > 0) {\n    var tmp = elements.splice(pos, 1);\n    return tmp.concat(elements);\n  }\n\n  return elements;\n}\n\nfunction sortElements(elements, _context) {\n  if (supports$8.tabsequenceAreaAtImgPosition) {\n    // Some browsers sort <area> in DOM order, some place the <area>s\n    // where the <img> referecing them would've been in DOM order.\n    // https://github.com/medialize/ally.js/issues/5\n    elements = sortArea(elements, _context);\n  }\n\n  elements = sortTabindex(elements);\n  return elements;\n}\n\nfunction queryTabsequence() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      context = _ref.context,\n      includeContext = _ref.includeContext,\n      includeOnlyTabbable = _ref.includeOnlyTabbable,\n      strategy = _ref.strategy;\n\n  if (!supports$8) {\n    supports$8 = _supports();\n  }\n\n  var _context = nodeArray(context)[0] || document.documentElement;\n\n  var elements = queryTabbable({\n    context: _context,\n    includeContext: includeContext,\n    includeOnlyTabbable: includeOnlyTabbable,\n    strategy: strategy\n  });\n\n  if (document.body.createShadowRoot && platform.is.BLINK) {\n    // sort tabindex localized to shadow dom\n    // see https://github.com/medialize/ally.js/issues/6\n    elements = sortShadowed(elements, _context, sortElements);\n  } else {\n    elements = sortElements(elements, _context);\n  }\n\n  if (includeContext) {\n    // if we include the context itself, it has to be the first\n    // element of the sequence\n    elements = moveContextToBeginning(elements, _context);\n  }\n\n  return elements;\n} // codes mostly cloned from https://github.com/keithamus/jwerty/blob/master/jwerty.js\n// deliberately not exposing characters like <,.-#* because they vary *wildly*\n// across keyboard layouts and may cause various problems\n// (e.g. \"*\" is \"Shift +\" on a German Mac keyboard)\n// (e.g. \"@\" is \"Alt L\" on a German Mac keyboard)\n\n\nvar keycode = {\n  // Element Focus\n  tab: 9,\n  // Navigation\n  left: 37,\n  up: 38,\n  right: 39,\n  down: 40,\n  pageUp: 33,\n  'page-up': 33,\n  pageDown: 34,\n  'page-down': 34,\n  end: 35,\n  home: 36,\n  // Action\n  enter: 13,\n  escape: 27,\n  space: 32,\n  // Modifier\n  shift: 16,\n  capsLock: 20,\n  'caps-lock': 20,\n  ctrl: 17,\n  alt: 18,\n  meta: 91,\n  // in firefox: 224\n  // on mac (chrome): meta-left=91, meta-right=93\n  // on win (IE11): meta-left=91, meta-right=92\n  pause: 19,\n  // Content Manipulation\n  insert: 45,\n  \"delete\": 46,\n  backspace: 8,\n  // the same logical key may be identified through different keyCodes\n  _alias: {\n    91: [92, 93, 224]\n  }\n}; // Function keys (112 - 137)\n// NOTE: not every keyboard knows F13+\n\nfor (var n = 1; n < 26; n++) {\n  keycode['f' + n] = n + 111;\n} // Number keys (48-57, numpad 96-105)\n// NOTE: not every keyboard knows num-0+\n\n\nfor (var _n = 0; _n < 10; _n++) {\n  var code = _n + 48;\n  var numCode = _n + 96;\n  keycode[_n] = code;\n  keycode['num-' + _n] = numCode;\n  keycode._alias[code] = [numCode];\n} // Latin characters (65 - 90)\n\n\nfor (var _n2 = 0; _n2 < 26; _n2++) {\n  var _code = _n2 + 65;\n\n  var name$1 = String.fromCharCode(_code).toLowerCase();\n  keycode[name$1] = _code;\n}\n\nvar modifier = {\n  alt: 'altKey',\n  ctrl: 'ctrlKey',\n  meta: 'metaKey',\n  shift: 'shiftKey'\n};\nvar modifierSequence = Object.keys(modifier).map(function (name) {\n  return modifier[name];\n});\n\nfunction createExpectedModifiers(ignoreModifiers) {\n  var value = ignoreModifiers ? null : false;\n  return {\n    altKey: value,\n    ctrlKey: value,\n    metaKey: value,\n    shiftKey: value\n  };\n}\n\nfunction resolveModifiers(modifiers) {\n  var ignoreModifiers = modifiers.indexOf('*') !== -1;\n  var expected = createExpectedModifiers(ignoreModifiers);\n  modifiers.forEach(function (token) {\n    if (token === '*') {\n      // we've already covered the all-in operator\n      return;\n    } // we want the modifier pressed\n\n\n    var value = true;\n    var operator = token.slice(0, 1);\n\n    if (operator === '?') {\n      // we don't care if the modifier is pressed\n      value = null;\n    } else if (operator === '!') {\n      // we do not want the modifier pressed\n      value = false;\n    }\n\n    if (value !== true) {\n      // compensate for the modifier's operator\n      token = token.slice(1);\n    }\n\n    var propertyName = modifier[token];\n\n    if (!propertyName) {\n      throw new TypeError('Unknown modifier \"' + token + '\"');\n    }\n\n    expected[propertyName] = value;\n  });\n  return expected;\n}\n\nfunction resolveKey(key) {\n  var code = keycode[key] || parseInt(key, 10);\n\n  if (!code || typeof code !== 'number' || isNaN(code)) {\n    throw new TypeError('Unknown key \"' + key + '\"');\n  }\n\n  return [code].concat(keycode._alias[code] || []);\n}\n\nfunction matchModifiers(expected, event) {\n  // returns true on match\n  return !modifierSequence.some(function (prop) {\n    // returns true on mismatch\n    return typeof expected[prop] === 'boolean' && Boolean(event[prop]) !== expected[prop];\n  });\n}\n\nfunction keyBinding(text) {\n  return text.split(/\\s+/).map(function (_text) {\n    var tokens = _text.split('+');\n\n    var _modifiers = resolveModifiers(tokens.slice(0, -1));\n\n    var _keyCodes = resolveKey(tokens.slice(-1));\n\n    return {\n      keyCodes: _keyCodes,\n      modifiers: _modifiers,\n      matchModifiers: matchModifiers.bind(null, _modifiers)\n    };\n  });\n} // Node.compareDocumentPosition is available since IE9\n// see https://developer.mozilla.org/en-US/docs/Web/API/Node.compareDocumentPosition\n// callback returns true when element is contained by parent or is the parent suited for use with Array.some()\n\n/*\n  USAGE:\n    var isChildOf = getParentComparator({parent: someNode});\n    listOfElements.some(isChildOf)\n*/\n\n\nfunction getParentComparator() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      parent = _ref.parent,\n      element = _ref.element,\n      includeSelf = _ref.includeSelf;\n\n  if (parent) {\n    return function isChildOf(node) {\n      return Boolean(includeSelf && node === parent || parent.compareDocumentPosition(node) & Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n  } else if (element) {\n    return function isParentOf(node) {\n      return Boolean(includeSelf && element === node || node.compareDocumentPosition(element) & Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n  }\n\n  throw new TypeError('util/compare-position#getParentComparator required either options.parent or options.element');\n} // Bug 286933 - Key events in the autocomplete popup should be hidden from page scripts\n// @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=286933\n\n\nfunction whenKey() {\n  var map = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var bindings = {};\n  var context = nodeArray(map.context)[0] || document.documentElement;\n  delete map.context;\n  var filter = nodeArray(map.filter);\n  delete map.filter;\n  var mapKeys = Object.keys(map);\n\n  if (!mapKeys.length) {\n    throw new TypeError('when/key requires at least one option key');\n  }\n\n  var registerBinding = function registerBinding(event) {\n    event.keyCodes.forEach(function (code) {\n      if (!bindings[code]) {\n        bindings[code] = [];\n      }\n\n      bindings[code].push(event);\n    });\n  };\n\n  mapKeys.forEach(function (text) {\n    if (typeof map[text] !== 'function') {\n      throw new TypeError('when/key requires option[\"' + text + '\"] to be a function');\n    }\n\n    var addCallback = function addCallback(event) {\n      event.callback = map[text];\n      return event;\n    };\n\n    keyBinding(text).map(addCallback).forEach(registerBinding);\n  });\n\n  var handleKeyDown = function handleKeyDown(event) {\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    if (filter.length) {\n      // ignore elements within the exempted sub-trees\n      var isParentOfElement = getParentComparator({\n        element: event.target,\n        includeSelf: true\n      });\n\n      if (filter.some(isParentOfElement)) {\n        return;\n      }\n    }\n\n    var key = event.keyCode || event.which;\n\n    if (!bindings[key]) {\n      return;\n    }\n\n    bindings[key].forEach(function (_event) {\n      if (!_event.matchModifiers(event)) {\n        return;\n      }\n\n      _event.callback.call(context, event, disengage);\n    });\n  };\n\n  context.addEventListener('keydown', handleKeyDown, false);\n\n  var disengage = function disengage() {\n    context.removeEventListener('keydown', handleKeyDown, false);\n  };\n\n  return {\n    disengage: disengage\n  };\n}\n\nfunction default_1(_a) {\n  var context = (_a === void 0 ? {} : _a).context;\n\n  if (!context) {\n    context = document.documentElement;\n  } // Make sure the supports tests are run before intercepting the Tab key,\n  // or IE10 and IE11 will fail to process the first Tab key event. Not\n  // limiting this warm-up to IE because it may be a problem elsewhere, too.\n\n\n  queryTabsequence();\n  return whenKey({\n    // Safari on OSX may require ALT+TAB to reach links,\n    // see https://github.com/medialize/ally.js/issues/146\n    '?alt+?shift+tab': function altShiftTab(event) {\n      // we're completely taking over the Tab key handling\n      event.preventDefault();\n      var sequence = queryTabsequence({\n        context: context\n      });\n      var backward = event.shiftKey;\n      var first = sequence[0];\n      var last = sequence[sequence.length - 1]; // wrap around first to last, last to first\n\n      var source = backward ? first : last;\n      var target = backward ? last : first;\n\n      if (isActiveElement(source)) {\n        target.focus();\n        return;\n      } // find current position in tabsequence\n\n\n      var currentIndex = void 0;\n      var found = sequence.some(function (element, index) {\n        if (!isActiveElement(element)) {\n          return false;\n        }\n\n        currentIndex = index;\n        return true;\n      });\n\n      if (!found) {\n        // redirect to first as we're not in our tabsequence\n        first.focus();\n        return;\n      } // shift focus to previous/next element in the sequence\n\n\n      var offset = backward ? -1 : 1;\n      sequence[currentIndex + offset].focus();\n    }\n  });\n}\n\nexports[\"default\"] = default_1;","map":{"version":3,"sources":["../../../../src/internal/components/Overlay/maintain--tab-focus.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\n/* eslint-disable */\n// @ts-nocheck\n// Copied from https://github.com/medialize/ally.js\n// License: MIT\n// Copyright (c) 2015 Rodney Rehm\n//\n// Entrypoint: ally.js/maintain/tab-focus\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nexports.__esModule = true;\nvar platform_1 = __importDefault(require(\"platform\"));\nvar css_escape_1 = __importDefault(require(\"css.escape\"));\n// input may be undefined, selector-tring, Node, NodeList, HTMLCollection, array of Nodes\n// yes, to some extent this is a bad replica of jQuery's constructor function\nfunction nodeArray(input) {\n    if (!input) {\n        return [];\n    }\n    if (Array.isArray(input)) {\n        return input;\n    }\n    // instanceof Node - does not work with iframes\n    if (input.nodeType !== undefined) {\n        return [input];\n    }\n    if (typeof input === 'string') {\n        input = document.querySelectorAll(input);\n    }\n    if (input.length !== undefined) {\n        return [].slice.call(input, 0);\n    }\n    throw new TypeError('unexpected input ' + String(input));\n}\nfunction contextToElement(_ref) {\n    var context = _ref.context, _ref$label = _ref.label, label = _ref$label === undefined ? 'context-to-element' : _ref$label, resolveDocument = _ref.resolveDocument, defaultToDocument = _ref.defaultToDocument;\n    var element = nodeArray(context)[0];\n    if (resolveDocument && element && element.nodeType === Node.DOCUMENT_NODE) {\n        element = element.documentElement;\n    }\n    if (!element && defaultToDocument) {\n        return document.documentElement;\n    }\n    if (!element) {\n        throw new TypeError(label + ' requires valid options.context');\n    }\n    if (element.nodeType !== Node.ELEMENT_NODE &&\n        element.nodeType !== Node.DOCUMENT_FRAGMENT_NODE) {\n        throw new TypeError(label + ' requires options.context to be an Element');\n    }\n    return element;\n}\nfunction getShadowHost() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context;\n    var element = contextToElement({\n        label: 'get/shadow-host',\n        context: context\n    });\n    // walk up to the root\n    var container = null;\n    while (element) {\n        container = element;\n        element = element.parentNode;\n    }\n    // https://developer.mozilla.org/en-US/docs/Web/API/Node.nodeType\n    // NOTE: Firefox 34 does not expose ShadowRoot.host (but 37 does)\n    if (container.nodeType === container.DOCUMENT_FRAGMENT_NODE &&\n        container.host) {\n        // the root is attached to a fragment node that has a host\n        return container.host;\n    }\n    return null;\n}\nfunction getDocument(node) {\n    if (!node) {\n        return document;\n    }\n    if (node.nodeType === Node.DOCUMENT_NODE) {\n        return node;\n    }\n    return node.ownerDocument || document;\n}\nfunction isActiveElement(context) {\n    var element = contextToElement({\n        label: 'is/active-element',\n        resolveDocument: true,\n        context: context\n    });\n    var _document = getDocument(element);\n    if (_document.activeElement === element) {\n        return true;\n    }\n    var shadowHost = getShadowHost({ context: element });\n    if (shadowHost && shadowHost.shadowRoot.activeElement === element) {\n        return true;\n    }\n    return false;\n}\n// [elem, elem.parent, elem.parent.parent, â€¦, html]\n// will not contain the shadowRoot (DOCUMENT_FRAGMENT_NODE) and shadowHost\nfunction getParents() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context;\n    var list = [];\n    var element = contextToElement({\n        label: 'get/parents',\n        context: context\n    });\n    while (element) {\n        list.push(element);\n        // IE does know support parentElement on SVGElement\n        element = element.parentNode;\n        if (element && element.nodeType !== Node.ELEMENT_NODE) {\n            element = null;\n        }\n    }\n    return list;\n}\n// Element.prototype.matches may be available at a different name\n// https://developer.mozilla.org/en/docs/Web/API/Element/matches\nvar names = [\n    'matches',\n    'webkitMatchesSelector',\n    'mozMatchesSelector',\n    'msMatchesSelector',\n];\nvar name = null;\nfunction findMethodName(element) {\n    names.some(function (_name) {\n        if (!element[_name]) {\n            return false;\n        }\n        name = _name;\n        return true;\n    });\n}\nfunction elementMatches(element, selector) {\n    if (!name) {\n        findMethodName(element);\n    }\n    return element[name](selector);\n}\n// deep clone of original platform\nvar platform = JSON.parse(JSON.stringify(platform_1[\"default\"]));\n// operating system\nvar os = platform.os.family || '';\nvar ANDROID = os === 'Android';\nvar WINDOWS = os.slice(0, 7) === 'Windows';\nvar OSX = os === 'OS X';\nvar IOS = os === 'iOS';\n// layout\nvar BLINK = platform.layout === 'Blink';\nvar GECKO = platform.layout === 'Gecko';\nvar TRIDENT = platform.layout === 'Trident';\nvar EDGE = platform.layout === 'EdgeHTML';\nvar WEBKIT = platform.layout === 'WebKit';\n// browser version (not layout engine version!)\nvar version = parseFloat(platform.version);\nvar majorVersion = Math.floor(version);\nplatform.majorVersion = majorVersion;\nplatform.is = {\n    // operating system\n    ANDROID: ANDROID,\n    WINDOWS: WINDOWS,\n    OSX: OSX,\n    IOS: IOS,\n    // layout\n    BLINK: BLINK,\n    GECKO: GECKO,\n    TRIDENT: TRIDENT,\n    EDGE: EDGE,\n    WEBKIT: WEBKIT,\n    // INTERNET EXPLORERS\n    IE9: TRIDENT && majorVersion === 9,\n    IE10: TRIDENT && majorVersion === 10,\n    IE11: TRIDENT && majorVersion === 11\n};\nfunction before() {\n    var data = {\n        // remember what had focus to restore after test\n        activeElement: document.activeElement,\n        // remember scroll positions to restore after test\n        windowScrollTop: window.scrollTop,\n        windowScrollLeft: window.scrollLeft,\n        bodyScrollTop: document.body.scrollTop,\n        bodyScrollLeft: document.body.scrollLeft\n    };\n    // wrap tests in an element hidden from screen readers to prevent them\n    // from announcing focus, which can be quite irritating to the user\n    var iframe = document.createElement('iframe');\n    iframe.setAttribute('style', 'position:absolute; position:fixed; top:0; left:-2px; width:1px; height:1px; overflow:hidden;');\n    iframe.setAttribute('aria-live', 'off');\n    iframe.setAttribute('aria-busy', 'true');\n    iframe.setAttribute('aria-hidden', 'true');\n    document.body.appendChild(iframe);\n    var _window = iframe.contentWindow;\n    var _document = _window.document;\n    _document.open();\n    _document.close();\n    var wrapper = _document.createElement('div');\n    _document.body.appendChild(wrapper);\n    data.iframe = iframe;\n    data.wrapper = wrapper;\n    data.window = _window;\n    data.document = _document;\n    return data;\n}\n// options.element:\n//  {string} element name\n//  {function} callback(wrapper, document) to generate an element\n// options.mutate: (optional)\n//  {function} callback(element, wrapper, document) to manipulate element prior to focus-test.\n//             Can return DOMElement to define focus target (default: element)\n// options.validate: (optional)\n//  {function} callback(element, focusTarget, document) to manipulate test-result\nfunction test(data, options) {\n    // make sure we operate on a clean slate\n    data.wrapper.innerHTML = '';\n    // create dummy element to test focusability of\n    var element = typeof options.element === 'string'\n        ? data.document.createElement(options.element)\n        : options.element(data.wrapper, data.document);\n    // allow callback to further specify dummy element\n    // and optionally define element to focus\n    var focus = options.mutate && options.mutate(element, data.wrapper, data.document);\n    if (!focus && focus !== false) {\n        focus = element;\n    }\n    // element needs to be part of the DOM to be focusable\n    !element.parentNode && data.wrapper.appendChild(element);\n    // test if the element with invalid tabindex can be focused\n    focus && focus.focus && focus.focus();\n    // validate test's result\n    return options.validate\n        ? options.validate(element, focus, data.document)\n        : data.document.activeElement === focus;\n}\nfunction after(data) {\n    // restore focus to what it was before test and cleanup\n    if (data.activeElement === document.body) {\n        document.activeElement &&\n            document.activeElement.blur &&\n            document.activeElement.blur();\n        if (platform.is.IE10) {\n            // IE10 does not redirect focus to <body> when the activeElement is removed\n            document.body.focus();\n        }\n    }\n    else {\n        data.activeElement && data.activeElement.focus && data.activeElement.focus();\n    }\n    document.body.removeChild(data.iframe);\n    // restore scroll position\n    window.scrollTop = data.windowScrollTop;\n    window.scrollLeft = data.windowScrollLeft;\n    document.body.scrollTop = data.bodyScrollTop;\n    document.body.scrollLeft = data.bodyScrollLeft;\n}\nfunction detectFocus(tests) {\n    var data = before();\n    var results = {};\n    Object.keys(tests).map(function (key) {\n        results[key] = test(data, tests[key]);\n    });\n    after(data);\n    return results;\n}\n// this file is overwritten by `npm run build:pre`\nvar version$1 = '1.4.1';\n/*\n    Facility to cache test results in localStorage.\n\n    USAGE:\n      cache.get('key');\n      cache.set('key', 'value');\n */\nfunction readLocalStorage(key) {\n    // allow reading from storage to retrieve previous support results\n    // even while the document does not have focus\n    var data = void 0;\n    try {\n        data = window.localStorage && window.localStorage.getItem(key);\n        data = data ? JSON.parse(data) : {};\n    }\n    catch (e) {\n        data = {};\n    }\n    return data;\n}\nfunction writeLocalStorage(key, value) {\n    if (!document.hasFocus()) {\n        // if the document does not have focus when tests are executed, focus() may\n        // not be handled properly and events may not be dispatched immediately.\n        // This can happen when a document is reloaded while Developer Tools have focus.\n        try {\n            window.localStorage && window.localStorage.removeItem(key);\n        }\n        catch (e) {\n            // ignore\n        }\n        return;\n    }\n    try {\n        window.localStorage &&\n            window.localStorage.setItem(key, JSON.stringify(value));\n    }\n    catch (e) {\n        // ignore\n    }\n}\nvar userAgent = (typeof window !== 'undefined' && window.navigator.userAgent) || '';\nvar cacheKey = 'ally-supports-cache';\nvar cache = readLocalStorage(cacheKey);\n// update the cache if ally or the user agent changed (newer version, etc)\nif (cache.userAgent !== userAgent || cache.version !== version$1) {\n    cache = {};\n}\ncache.userAgent = userAgent;\ncache.version = version$1;\nvar cache$1 = {\n    get: function get() {\n        return cache;\n    },\n    set: function set(values) {\n        Object.keys(values).forEach(function (key) {\n            cache[key] = values[key];\n        });\n        cache.time = new Date().toISOString();\n        writeLocalStorage(cacheKey, cache);\n    }\n};\nfunction cssShadowPiercingDeepCombinator() {\n    var combinator = void 0;\n    // see https://dev.w3.org/csswg/css-scoping-1/#deep-combinator\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1117572\n    // https://code.google.com/p/chromium/issues/detail?id=446051\n    try {\n        document.querySelector('html >>> :first-child');\n        combinator = '>>>';\n    }\n    catch (noArrowArrowArrow) {\n        try {\n            // old syntax supported at least up to Chrome 41\n            // https://code.google.com/p/chromium/issues/detail?id=446051\n            document.querySelector('html /deep/ :first-child');\n            combinator = '/deep/';\n        }\n        catch (noDeep) {\n            combinator = '';\n        }\n    }\n    return combinator;\n}\nvar gif = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\nvar focusAreaImgTabindex = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML =\n            '<map name=\"image-map-tabindex-test\">' +\n                '<area shape=\"rect\" coords=\"63,19,144,45\"></map>' +\n                '<img usemap=\"#image-map-tabindex-test\" tabindex=\"-1\" alt=\"\" src=\"' +\n                gif +\n                '\">';\n        return element.querySelector('area');\n    }\n};\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\nvar focusAreaTabindex = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML =\n            '<map name=\"image-map-tabindex-test\">' +\n                '<area href=\"#void\" tabindex=\"-1\" shape=\"rect\" coords=\"63,19,144,45\"></map>' +\n                '<img usemap=\"#image-map-tabindex-test\" alt=\"\" src=\"' +\n                gif +\n                '\">';\n        return false;\n    },\n    validate: function validate(element, focusTarget, _document) {\n        if (platform.is.GECKO) {\n            // fixes https://github.com/medialize/ally.js/issues/35\n            // Firefox loads the DataURI asynchronously, causing a false-negative\n            return true;\n        }\n        var focus = element.querySelector('area');\n        focus.focus();\n        return _document.activeElement === focus;\n    }\n};\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\nvar focusAreaWithoutHref = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML =\n            '<map name=\"image-map-area-href-test\">' +\n                '<area shape=\"rect\" coords=\"63,19,144,45\"></map>' +\n                '<img usemap=\"#image-map-area-href-test\" alt=\"\" src=\"' +\n                gif +\n                '\">';\n        return element.querySelector('area');\n    },\n    validate: function validate(element, focusTarget, _document) {\n        if (platform.is.GECKO) {\n            // fixes https://github.com/medialize/ally.js/issues/35\n            // Firefox loads the DataURI asynchronously, causing a false-negative\n            return true;\n        }\n        return _document.activeElement === focusTarget;\n    }\n};\nvar focusAudioWithoutControls = {\n    name: 'can-focus-audio-without-controls',\n    element: 'audio',\n    mutate: function mutate(element) {\n        try {\n            // invalid media file can trigger warning in console, data-uri to prevent HTTP request\n            element.setAttribute('src', gif);\n        }\n        catch (e) {\n            // IE9 may throw \"Error: Not implemented\"\n        }\n    }\n};\nvar invalidGif = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ';\n// NOTE: https://github.com/medialize/ally.js/issues/35\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\nvar focusBrokenImageMap = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML =\n            '<map name=\"broken-image-map-test\"><area href=\"#void\" shape=\"rect\" coords=\"63,19,144,45\"></map>' +\n                '<img usemap=\"#broken-image-map-test\" alt=\"\" src=\"' +\n                invalidGif +\n                '\">';\n        return element.querySelector('area');\n    }\n};\n// Children of focusable elements with display:flex are focusable in IE10-11\nvar focusChildrenOfFocusableFlexbox = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.setAttribute('tabindex', '-1');\n        element.setAttribute('style', 'display: -webkit-flex; display: -ms-flexbox; display: flex;');\n        element.innerHTML = '<span style=\"display: block;\">hello</span>';\n        return element.querySelector('span');\n    }\n};\n// fieldset[tabindex=0][disabled] should not be focusable, but Blink and WebKit disagree\n// @specification https://www.w3.org/TR/html5/disabled-elements.html#concept-element-disabled\n// @browser-issue Chromium https://crbug.com/453847\n// @browser-issue WebKit https://bugs.webkit.org/show_bug.cgi?id=141086\nvar focusFieldsetDisabled = {\n    element: 'fieldset',\n    mutate: function mutate(element) {\n        element.setAttribute('tabindex', 0);\n        element.setAttribute('disabled', 'disabled');\n    }\n};\nvar focusFieldset = {\n    element: 'fieldset',\n    mutate: function mutate(element) {\n        element.innerHTML = '<legend>legend</legend><p>content</p>';\n    }\n};\n// elements with display:flex are focusable in IE10-11\nvar focusFlexboxContainer = {\n    element: 'span',\n    mutate: function mutate(element) {\n        element.setAttribute('style', 'display: -webkit-flex; display: -ms-flexbox; display: flex;');\n        element.innerHTML = '<span style=\"display: block;\">hello</span>';\n    }\n};\n// form[tabindex=0][disabled] should be focusable as the\n// specification doesn't know the disabled attribute on the form element\n// @specification https://www.w3.org/TR/html5/forms.html#the-form-element\nvar focusFormDisabled = {\n    element: 'form',\n    mutate: function mutate(element) {\n        element.setAttribute('tabindex', 0);\n        element.setAttribute('disabled', 'disabled');\n    }\n};\n// NOTE: https://github.com/medialize/ally.js/issues/35\n// fixes https://github.com/medialize/ally.js/issues/20\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-ismap\nvar focusImgIsmap = {\n    element: 'a',\n    mutate: function mutate(element) {\n        element.href = '#void';\n        element.innerHTML = '<img ismap src=\"' + gif + '\" alt=\"\">';\n        return element.querySelector('img');\n    }\n};\n// NOTE: https://github.com/medialize/ally.js/issues/35\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\nvar focusImgUsemapTabindex = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML =\n            '<map name=\"image-map-tabindex-test\"><area href=\"#void\" shape=\"rect\" coords=\"63,19,144,45\"></map>' +\n                '<img usemap=\"#image-map-tabindex-test\" tabindex=\"-1\" alt=\"\" ' +\n                'src=\"' +\n                gif +\n                '\">';\n        return element.querySelector('img');\n    }\n};\nvar focusInHiddenIframe = {\n    element: function element(wrapper, _document) {\n        var iframe = _document.createElement('iframe');\n        // iframe must be part of the DOM before accessing the contentWindow is possible\n        wrapper.appendChild(iframe);\n        // create the iframe's default document (<html><head></head><body></body></html>)\n        var iframeDocument = iframe.contentWindow.document;\n        iframeDocument.open();\n        iframeDocument.close();\n        return iframe;\n    },\n    mutate: function mutate(iframe) {\n        iframe.style.visibility = 'hidden';\n        var iframeDocument = iframe.contentWindow.document;\n        var input = iframeDocument.createElement('input');\n        iframeDocument.body.appendChild(input);\n        return input;\n    },\n    validate: function validate(iframe) {\n        var iframeDocument = iframe.contentWindow.document;\n        var focus = iframeDocument.querySelector('input');\n        return iframeDocument.activeElement === focus;\n    }\n};\nvar result = !platform.is.WEBKIT;\nfunction focusInZeroDimensionObject() {\n    return result;\n}\n// Firefox allows *any* value and treats invalid values like tabindex=\"-1\"\n// @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=1128054\nvar focusInvalidTabindex = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.setAttribute('tabindex', 'invalid-value');\n    }\n};\nvar focusLabelTabindex = {\n    element: 'label',\n    mutate: function mutate(element) {\n        element.setAttribute('tabindex', '-1');\n    },\n    validate: function validate(element, focusTarget, _document) {\n        // force layout in Chrome 49, otherwise the element won't be focusable\n        /* eslint-disable no-unused-vars */\n        var variableToPreventDeadCodeElimination = element.offsetHeight;\n        /* eslint-enable no-unused-vars */\n        element.focus();\n        return _document.activeElement === element;\n    }\n};\nvar svg = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtb' +\n    'G5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0ic3ZnIj48dGV4dCB4PSIxMCIgeT0iMjAiIGlkPSJ' +\n    'zdmctbGluay10ZXh0Ij50ZXh0PC90ZXh0Pjwvc3ZnPg==';\n// Note: IE10 on BrowserStack does not like this test\nvar focusObjectSvgHidden = {\n    element: 'object',\n    mutate: function mutate(element) {\n        element.setAttribute('type', 'image/svg+xml');\n        element.setAttribute('data', svg);\n        element.setAttribute('width', '200');\n        element.setAttribute('height', '50');\n        element.style.visibility = 'hidden';\n    }\n};\n// Note: IE10 on BrowserStack does not like this test\nvar focusObjectSvg = {\n    name: 'can-focus-object-svg',\n    element: 'object',\n    mutate: function mutate(element) {\n        element.setAttribute('type', 'image/svg+xml');\n        element.setAttribute('data', svg);\n        element.setAttribute('width', '200');\n        element.setAttribute('height', '50');\n    },\n    validate: function validate(element, focusTarget, _document) {\n        if (platform.is.GECKO) {\n            // Firefox seems to be handling the object creation asynchronously and thereby produces a false negative test result.\n            // Because we know Firefox is able to focus object elements referencing SVGs, we simply cheat by sniffing the user agent string\n            return true;\n        }\n        return _document.activeElement === element;\n    }\n};\n// Every Environment except IE9 considers SWF objects focusable\nvar result$1 = !platform.is.IE9;\nfunction focusObjectSwf() {\n    return result$1;\n}\nvar focusRedirectImgUsemap = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML =\n            '<map name=\"focus-redirect-img-usemap\"><area href=\"#void\" shape=\"rect\" coords=\"63,19,144,45\"></map>' +\n                '<img usemap=\"#focus-redirect-img-usemap\" alt=\"\" ' +\n                'src=\"' +\n                gif +\n                '\">';\n        // focus the <img>, not the <div>\n        return element.querySelector('img');\n    },\n    validate: function validate(element, focusTarget, _document) {\n        var target = element.querySelector('area');\n        return _document.activeElement === target;\n    }\n};\n// see https://jsbin.com/nenirisage/edit?html,js,console,output\nvar focusRedirectLegend = {\n    element: 'fieldset',\n    mutate: function mutate(element) {\n        element.innerHTML =\n            '<legend>legend</legend><input tabindex=\"-1\"><input tabindex=\"0\">';\n        // take care of focus in validate();\n        return false;\n    },\n    validate: function validate(element, focusTarget, _document) {\n        var focusable = element.querySelector('input[tabindex=\"-1\"]');\n        var tabbable = element.querySelector('input[tabindex=\"0\"]');\n        // Firefox requires this test to focus the <fieldset> first, while this is not necessary in\n        // https://jsbin.com/nenirisage/edit?html,js,console,output\n        element.focus();\n        element.querySelector('legend').focus();\n        return ((_document.activeElement === focusable && 'focusable') ||\n            (_document.activeElement === tabbable && 'tabbable') ||\n            '');\n    }\n};\n// https://github.com/medialize/ally.js/issues/21\nvar focusScrollBody = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.setAttribute('style', 'width: 100px; height: 50px; overflow: auto;');\n        element.innerHTML =\n            '<div style=\"width: 500px; height: 40px;\">scrollable content</div>';\n        return element.querySelector('div');\n    }\n};\n// https://github.com/medialize/ally.js/issues/21\nvar focusScrollContainerWithoutOverflow = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.setAttribute('style', 'width: 100px; height: 50px;');\n        element.innerHTML =\n            '<div style=\"width: 500px; height: 40px;\">scrollable content</div>';\n    }\n};\n// https://github.com/medialize/ally.js/issues/21\nvar focusScrollContainer = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.setAttribute('style', 'width: 100px; height: 50px; overflow: auto;');\n        element.innerHTML =\n            '<div style=\"width: 500px; height: 40px;\">scrollable content</div>';\n    }\n};\nvar focusSummary = {\n    element: 'details',\n    mutate: function mutate(element) {\n        element.innerHTML = '<summary>foo</summary><p>content</p>';\n        return element.firstElementChild;\n    }\n};\nfunction makeFocusableForeignObject() {\n    var fragment = document.createElement('div');\n    fragment.innerHTML =\n        '<svg><foreignObject width=\"30\" height=\"30\">\\n      <input type=\"text\"/>\\n  </foreignObject></svg>';\n    return fragment.firstChild.firstChild;\n}\nfunction focusSvgForeignObjectHack(element) {\n    // Edge13, Edge14: foreignObject focus hack\n    // https://jsbin.com/kunehinugi/edit?html,js,output\n    // https://jsbin.com/fajagi/3/edit?html,js,output\n    var isSvgElement = element.ownerSVGElement || element.nodeName.toLowerCase() === 'svg';\n    if (!isSvgElement) {\n        return false;\n    }\n    // inject and focus an <input> element into the SVG element to receive focus\n    var foreignObject = makeFocusableForeignObject();\n    element.appendChild(foreignObject);\n    var input = foreignObject.querySelector('input');\n    input.focus();\n    // upon disabling the activeElement, IE and Edge\n    // will not shift focus to <body> like all the other\n    // browsers, but instead find the first focusable\n    // ancestor and shift focus to that\n    input.disabled = true;\n    // clean up\n    element.removeChild(foreignObject);\n    return true;\n}\nfunction generate(element) {\n    return ('<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">' +\n        element +\n        '</svg>');\n}\nfunction focus(element) {\n    if (element.focus) {\n        return;\n    }\n    try {\n        HTMLElement.prototype.focus.call(element);\n    }\n    catch (e) {\n        focusSvgForeignObjectHack(element);\n    }\n}\nfunction validate(element, focusTarget, _document) {\n    focus(focusTarget);\n    return _document.activeElement === focusTarget;\n}\nvar focusSvgFocusableAttribute = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML = generate('<text focusable=\"true\">a</text>');\n        return element.querySelector('text');\n    },\n    validate: validate\n};\nvar focusSvgTabindexAttribute = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML = generate('<text tabindex=\"0\">a</text>');\n        return element.querySelector('text');\n    },\n    validate: validate\n};\nvar focusSvgNegativeTabindexAttribute = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML = generate('<text tabindex=\"-1\">a</text>');\n        return element.querySelector('text');\n    },\n    validate: validate\n};\nvar focusSvgUseTabindex = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML = generate([\n            '<g id=\"ally-test-target\"><a xlink:href=\"#void\"><text>link</text></a></g>',\n            '<use xlink:href=\"#ally-test-target\" x=\"0\" y=\"0\" tabindex=\"-1\" />',\n        ].join(''));\n        return element.querySelector('use');\n    },\n    validate: validate\n};\nvar focusSvgForeignobjectTabindex = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML = generate('<foreignObject tabindex=\"-1\"><input type=\"text\" /></foreignObject>');\n        // Safari 8's quersSelector() can't identify foreignObject, but getElementyByTagName() can\n        return (element.querySelector('foreignObject') ||\n            element.getElementsByTagName('foreignObject')[0]);\n    },\n    validate: validate\n};\n// Firefox seems to be handling the SVG-document-in-iframe creation asynchronously\n// and thereby produces a false negative test result. Thus the test is pointless\n// and we resort to UA sniffing once again.\n// see http://jsbin.com/vunadohoko/1/edit?js,console,output\nvar result$2 = Boolean(platform.is.GECKO &&\n    typeof SVGElement !== 'undefined' &&\n    SVGElement.prototype.focus);\nfunction focusSvgInIframe() {\n    return result$2;\n}\nvar focusSvg = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.innerHTML = generate('');\n        return element.firstChild;\n    },\n    validate: validate\n};\n// Firefox allows *any* value and treats invalid values like tabindex=\"-1\"\n// @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=1128054\nvar focusTabindexTrailingCharacters = {\n    element: 'div',\n    mutate: function mutate(element) {\n        element.setAttribute('tabindex', '3x');\n    }\n};\nvar focusTable = {\n    element: 'table',\n    mutate: function mutate(element, wrapper, _document) {\n        // IE9 has a problem replacing TBODY contents with innerHTML.\n        // https://stackoverflow.com/a/8097055/515124\n        // element.innerHTML = '<tr><td>cell</td></tr>';\n        var fragment = _document.createDocumentFragment();\n        fragment.innerHTML = '<tr><td>cell</td></tr>';\n        element.appendChild(fragment);\n    }\n};\nvar focusVideoWithoutControls = {\n    element: 'video',\n    mutate: function mutate(element) {\n        try {\n            // invalid media file can trigger warning in console, data-uri to prevent HTTP request\n            element.setAttribute('src', gif);\n        }\n        catch (e) {\n            // IE9 may throw \"Error: Not implemented\"\n        }\n    }\n};\n// https://jsbin.com/vafaba/3/edit?html,js,console,output\nvar result$3 = platform.is.GECKO || platform.is.TRIDENT || platform.is.EDGE;\nfunction tabsequenceAreaAtImgPosition() {\n    return result$3;\n}\nvar testCallbacks = {\n    cssShadowPiercingDeepCombinator: cssShadowPiercingDeepCombinator,\n    focusInZeroDimensionObject: focusInZeroDimensionObject,\n    focusObjectSwf: focusObjectSwf,\n    focusSvgInIframe: focusSvgInIframe,\n    tabsequenceAreaAtImgPosition: tabsequenceAreaAtImgPosition\n};\nvar testDescriptions = {\n    focusAreaImgTabindex: focusAreaImgTabindex,\n    focusAreaTabindex: focusAreaTabindex,\n    focusAreaWithoutHref: focusAreaWithoutHref,\n    focusAudioWithoutControls: focusAudioWithoutControls,\n    focusBrokenImageMap: focusBrokenImageMap,\n    focusChildrenOfFocusableFlexbox: focusChildrenOfFocusableFlexbox,\n    focusFieldsetDisabled: focusFieldsetDisabled,\n    focusFieldset: focusFieldset,\n    focusFlexboxContainer: focusFlexboxContainer,\n    focusFormDisabled: focusFormDisabled,\n    focusImgIsmap: focusImgIsmap,\n    focusImgUsemapTabindex: focusImgUsemapTabindex,\n    focusInHiddenIframe: focusInHiddenIframe,\n    focusInvalidTabindex: focusInvalidTabindex,\n    focusLabelTabindex: focusLabelTabindex,\n    focusObjectSvg: focusObjectSvg,\n    focusObjectSvgHidden: focusObjectSvgHidden,\n    focusRedirectImgUsemap: focusRedirectImgUsemap,\n    focusRedirectLegend: focusRedirectLegend,\n    focusScrollBody: focusScrollBody,\n    focusScrollContainerWithoutOverflow: focusScrollContainerWithoutOverflow,\n    focusScrollContainer: focusScrollContainer,\n    focusSummary: focusSummary,\n    focusSvgFocusableAttribute: focusSvgFocusableAttribute,\n    focusSvgTabindexAttribute: focusSvgTabindexAttribute,\n    focusSvgNegativeTabindexAttribute: focusSvgNegativeTabindexAttribute,\n    focusSvgUseTabindex: focusSvgUseTabindex,\n    focusSvgForeignobjectTabindex: focusSvgForeignobjectTabindex,\n    focusSvg: focusSvg,\n    focusTabindexTrailingCharacters: focusTabindexTrailingCharacters,\n    focusTable: focusTable,\n    focusVideoWithoutControls: focusVideoWithoutControls\n};\nfunction executeTests() {\n    var results = detectFocus(testDescriptions);\n    Object.keys(testCallbacks).forEach(function (key) {\n        results[key] = testCallbacks[key]();\n    });\n    return results;\n}\nvar supportsCache = null;\nfunction _supports() {\n    if (supportsCache) {\n        return supportsCache;\n    }\n    supportsCache = cache$1.get();\n    if (!supportsCache.time) {\n        cache$1.set(executeTests());\n        supportsCache = cache$1.get();\n    }\n    return supportsCache;\n}\nvar supports = void 0;\n// https://www.w3.org/TR/html5/infrastructure.html#rules-for-parsing-integers\n// NOTE: all browsers agree to allow trailing spaces as well\nvar validIntegerPatternNoTrailing = /^\\s*(-|\\+)?[0-9]+\\s*$/;\nvar validIntegerPatternWithTrailing = /^\\s*(-|\\+)?[0-9]+.*$/;\nfunction isValidTabindex(context) {\n    if (!supports) {\n        supports = _supports();\n    }\n    var validIntegerPattern = supports.focusTabindexTrailingCharacters\n        ? validIntegerPatternWithTrailing\n        : validIntegerPatternNoTrailing;\n    var element = contextToElement({\n        label: 'is/valid-tabindex',\n        resolveDocument: true,\n        context: context\n    });\n    // Edge 14 has a capitalization problem on SVG elements,\n    // see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/9282058/\n    var hasTabindex = element.hasAttribute('tabindex');\n    var hasTabIndex = element.hasAttribute('tabIndex');\n    if (!hasTabindex && !hasTabIndex) {\n        return false;\n    }\n    // older Firefox and Internet Explorer don't support tabindex on SVG elements\n    var isSvgElement = element.ownerSVGElement || element.nodeName.toLowerCase() === 'svg';\n    if (isSvgElement && !supports.focusSvgTabindexAttribute) {\n        return false;\n    }\n    // @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=1128054\n    if (supports.focusInvalidTabindex) {\n        return true;\n    }\n    // an element matches the tabindex selector even if its value is invalid\n    var tabindex = element.getAttribute(hasTabindex ? 'tabindex' : 'tabIndex');\n    // IE11 parses tabindex=\"\" as the value \"-32768\"\n    // @browser-issue Trident https://connect.microsoft.com/IE/feedback/details/1072965\n    if (tabindex === '-32768') {\n        return false;\n    }\n    return Boolean(tabindex && validIntegerPattern.test(tabindex));\n}\nfunction tabindexValue(element) {\n    if (!isValidTabindex(element)) {\n        return null;\n    }\n    // Edge 14 has a capitalization problem on SVG elements,\n    // see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/9282058/\n    var hasTabindex = element.hasAttribute('tabindex');\n    var attributeName = hasTabindex ? 'tabindex' : 'tabIndex';\n    // @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=1128054\n    var tabindex = parseInt(element.getAttribute(attributeName), 10);\n    return isNaN(tabindex) ? -1 : tabindex;\n}\n// this is a shared utility file for focus-relevant.js and tabbable.js\n// separate testing of this file's functions is not necessary,\n// as they're implicitly tested by way of the consumers\nfunction isUserModifyWritable(style) {\n    // https://www.w3.org/TR/1999/WD-css3-userint-19990916#user-modify\n    // https://github.com/medialize/ally.js/issues/17\n    var userModify = style.webkitUserModify || '';\n    return Boolean(userModify && userModify.indexOf('write') !== -1);\n}\nfunction hasCssOverflowScroll(style) {\n    return [\n        style.getPropertyValue('overflow'),\n        style.getPropertyValue('overflow-x'),\n        style.getPropertyValue('overflow-y'),\n    ].some(function (overflow) {\n        return overflow === 'auto' || overflow === 'scroll';\n    });\n}\nfunction hasCssDisplayFlex(style) {\n    return style.display.indexOf('flex') > -1;\n}\nfunction isScrollableContainer(element, nodeName, parentNodeName, parentStyle) {\n    if (nodeName !== 'div' && nodeName !== 'span') {\n        // Internet Explorer advances scrollable containers and bodies to focusable\n        // only if the scrollable container is <div> or <span> - this does *not*\n        // happen for <section>, <article>, â€¦\n        return false;\n    }\n    if (parentNodeName &&\n        parentNodeName !== 'div' &&\n        parentNodeName !== 'span' &&\n        !hasCssOverflowScroll(parentStyle)) {\n        return false;\n    }\n    return (element.offsetHeight < element.scrollHeight ||\n        element.offsetWidth < element.scrollWidth);\n}\nvar supports$1 = void 0;\nfunction isFocusRelevantRules() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, _ref$except = _ref.except, except = _ref$except === undefined\n        ? {\n            flexbox: false,\n            scrollable: false,\n            shadow: false\n        }\n        : _ref$except;\n    if (!supports$1) {\n        supports$1 = _supports();\n    }\n    var element = contextToElement({\n        label: 'is/focus-relevant',\n        resolveDocument: true,\n        context: context\n    });\n    if (!except.shadow && element.shadowRoot) {\n        // a ShadowDOM host receives focus when the focus moves to its content\n        return true;\n    }\n    var nodeName = element.nodeName.toLowerCase();\n    if (nodeName === 'input' && element.type === 'hidden') {\n        // input[type=\"hidden\"] supports.cannot be focused\n        return false;\n    }\n    if (nodeName === 'input' ||\n        nodeName === 'select' ||\n        nodeName === 'button' ||\n        nodeName === 'textarea') {\n        return true;\n    }\n    if (nodeName === 'legend' && supports$1.focusRedirectLegend) {\n        // specifics filtered in is/focusable\n        return true;\n    }\n    if (nodeName === 'label') {\n        // specifics filtered in is/focusable\n        return true;\n    }\n    if (nodeName === 'area') {\n        // specifics filtered in is/focusable\n        return true;\n    }\n    if (nodeName === 'a' && element.hasAttribute('href')) {\n        return true;\n    }\n    if (nodeName === 'object' && element.hasAttribute('usemap')) {\n        // object[usemap] is not focusable in any browser\n        return false;\n    }\n    if (nodeName === 'object') {\n        var svgType = element.getAttribute('type');\n        if (!supports$1.focusObjectSvg && svgType === 'image/svg+xml') {\n            // object[type=\"image/svg+xml\"] is not focusable in Internet Explorer\n            return false;\n        }\n        else if (!supports$1.focusObjectSwf &&\n            svgType === 'application/x-shockwave-flash') {\n            // object[type=\"application/x-shockwave-flash\"] is not focusable in Internet Explorer 9\n            return false;\n        }\n    }\n    if (nodeName === 'iframe' || nodeName === 'object') {\n        // browsing context containers\n        return true;\n    }\n    if (nodeName === 'embed' || nodeName === 'keygen') {\n        // embed is considered focus-relevant but not focusable\n        // see https://github.com/medialize/ally.js/issues/82\n        return true;\n    }\n    if (element.hasAttribute('contenteditable')) {\n        // also see CSS property user-modify below\n        return true;\n    }\n    if (nodeName === 'audio' &&\n        (supports$1.focusAudioWithoutControls || element.hasAttribute('controls'))) {\n        return true;\n    }\n    if (nodeName === 'video' &&\n        (supports$1.focusVideoWithoutControls || element.hasAttribute('controls'))) {\n        return true;\n    }\n    if (supports$1.focusSummary && nodeName === 'summary') {\n        return true;\n    }\n    var validTabindex = isValidTabindex(element);\n    if (nodeName === 'img' && element.hasAttribute('usemap')) {\n        // Gecko, Trident and Edge do not allow an image with an image map and tabindex to be focused,\n        // it appears the tabindex is overruled so focus is still forwarded to the <map>\n        return ((validTabindex && supports$1.focusImgUsemapTabindex) ||\n            supports$1.focusRedirectImgUsemap);\n    }\n    if (supports$1.focusTable && (nodeName === 'table' || nodeName === 'td')) {\n        // IE10-11 supports.can focus <table> and <td>\n        return true;\n    }\n    if (supports$1.focusFieldset && nodeName === 'fieldset') {\n        // IE10-11 supports.can focus <fieldset>\n        return true;\n    }\n    var isSvgElement = nodeName === 'svg';\n    var isSvgContent = element.ownerSVGElement;\n    var focusableAttribute = element.getAttribute('focusable');\n    var tabindex = tabindexValue(element);\n    if (nodeName === 'use' &&\n        tabindex !== null &&\n        !supports$1.focusSvgUseTabindex) {\n        // <use> cannot be made focusable by adding a tabindex attribute anywhere but Blink and WebKit\n        return false;\n    }\n    if (nodeName === 'foreignobject') {\n        // <use> can only be made focusable in Blink and WebKit\n        return tabindex !== null && supports$1.focusSvgForeignobjectTabindex;\n    }\n    if (elementMatches(element, 'svg a') && element.hasAttribute('xlink:href')) {\n        return true;\n    }\n    if ((isSvgElement || isSvgContent) &&\n        element.focus &&\n        !supports$1.focusSvgNegativeTabindexAttribute &&\n        tabindex < 0) {\n        // Firefox 51 and 52 treat any natively tabbable SVG element with\n        // tabindex=\"-1\" as tabbable and everything else as inert\n        // see https://bugzilla.mozilla.org/show_bug.cgi?id=1302340\n        return false;\n    }\n    if (isSvgElement) {\n        return (validTabindex ||\n            supports$1.focusSvg ||\n            supports$1.focusSvgInIframe ||\n            // Internet Explorer understands the focusable attribute introduced in SVG Tiny 1.2\n            Boolean(supports$1.focusSvgFocusableAttribute &&\n                focusableAttribute &&\n                focusableAttribute === 'true'));\n    }\n    if (isSvgContent) {\n        if (supports$1.focusSvgTabindexAttribute && validTabindex) {\n            return true;\n        }\n        if (supports$1.focusSvgFocusableAttribute) {\n            // Internet Explorer understands the focusable attribute introduced in SVG Tiny 1.2\n            return focusableAttribute === 'true';\n        }\n    }\n    // https://www.w3.org/TR/html5/editing.html#sequential-focus-navigation-and-the-tabindex-attribute\n    if (validTabindex) {\n        return true;\n    }\n    var style = window.getComputedStyle(element, null);\n    if (isUserModifyWritable(style)) {\n        return true;\n    }\n    if (supports$1.focusImgIsmap &&\n        nodeName === 'img' &&\n        element.hasAttribute('ismap')) {\n        // IE10-11 considers the <img> in <a href><img ismap> focusable\n        // https://github.com/medialize/ally.js/issues/20\n        var hasLinkParent = getParents({ context: element }).some(function (parent) {\n            return (parent.nodeName.toLowerCase() === 'a' && parent.hasAttribute('href'));\n        });\n        if (hasLinkParent) {\n            return true;\n        }\n    }\n    // https://github.com/medialize/ally.js/issues/21\n    if (!except.scrollable && supports$1.focusScrollContainer) {\n        if (supports$1.focusScrollContainerWithoutOverflow) {\n            // Internet Explorer does will consider the scrollable area focusable\n            // if the element is a <div> or a <span> and it is in fact scrollable,\n            // regardless of the CSS overflow property\n            if (isScrollableContainer(element, nodeName)) {\n                return true;\n            }\n        }\n        else if (hasCssOverflowScroll(style)) {\n            // Firefox requires proper overflow setting, IE does not necessarily\n            // https://developer.mozilla.org/en-US/docs/Web/CSS/overflow\n            return true;\n        }\n    }\n    if (!except.flexbox &&\n        supports$1.focusFlexboxContainer &&\n        hasCssDisplayFlex(style)) {\n        // elements with display:flex are focusable in IE10-11\n        return true;\n    }\n    var parent = element.parentElement;\n    if (!except.scrollable && parent) {\n        var parentNodeName = parent.nodeName.toLowerCase();\n        var parentStyle = window.getComputedStyle(parent, null);\n        if (supports$1.focusScrollBody &&\n            isScrollableContainer(parent, nodeName, parentNodeName, parentStyle)) {\n            // scrollable bodies are focusable Internet Explorer\n            // https://github.com/medialize/ally.js/issues/21\n            return true;\n        }\n        // Children of focusable elements with display:flex are focusable in IE10-11\n        if (supports$1.focusChildrenOfFocusableFlexbox) {\n            if (hasCssDisplayFlex(parentStyle)) {\n                return true;\n            }\n        }\n    }\n    // NOTE: elements marked as inert are not focusable,\n    // but that property is not exposed to the DOM\n    // https://www.w3.org/TR/html5/editing.html#inert\n    return false;\n}\n// bind exceptions to an iterator callback\nisFocusRelevantRules.except = function () {\n    var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var isFocusRelevant = function isFocusRelevant(context) {\n        return isFocusRelevantRules({\n            context: context,\n            except: except\n        });\n    };\n    isFocusRelevant.rules = isFocusRelevantRules;\n    return isFocusRelevant;\n};\n// provide isFocusRelevant(context) as default iterator callback\nvar isFocusRelevant = isFocusRelevantRules.except({});\nfunction findIndex(array, callback) {\n    // attempt to use native or polyfilled Array#findIndex first\n    if (array.findIndex) {\n        return array.findIndex(callback);\n    }\n    var length = array.length;\n    // shortcut if the array is empty\n    if (length === 0) {\n        return -1;\n    }\n    // otherwise loop over array\n    for (var i = 0; i < length; i++) {\n        if (callback(array[i], i, array)) {\n            return i;\n        }\n    }\n    return -1;\n}\nfunction getContentDocument(node) {\n    try {\n        // works on <object> and <iframe>\n        return (node.contentDocument ||\n            // works on <object> and <iframe>\n            (node.contentWindow && node.contentWindow.document) ||\n            // works on <object> and <iframe> that contain SVG\n            (node.getSVGDocument && node.getSVGDocument()) ||\n            null);\n    }\n    catch (e) {\n        // SecurityError: Failed to read the 'contentDocument' property from 'HTMLObjectElement'\n        // also IE may throw member not found exception e.g. on <object type=\"image/png\">\n        return null;\n    }\n}\nfunction getWindow(node) {\n    var _document = getDocument(node);\n    return _document.defaultView || window;\n}\nvar shadowPrefix = void 0;\nfunction selectInShadows(selector) {\n    if (typeof shadowPrefix !== 'string') {\n        var operator = cssShadowPiercingDeepCombinator();\n        if (operator) {\n            shadowPrefix = ', html ' + operator + ' ';\n        }\n    }\n    if (!shadowPrefix) {\n        return selector;\n    }\n    return (selector +\n        shadowPrefix +\n        selector\n            .replace(/\\s*,\\s*/g, ',')\n            .split(',')\n            .join(shadowPrefix));\n}\nvar selector = void 0;\nfunction findDocumentHostElement(_window) {\n    if (!selector) {\n        selector = selectInShadows('object, iframe');\n    }\n    if (_window._frameElement !== undefined) {\n        return _window._frameElement;\n    }\n    _window._frameElement = null;\n    var potentialHosts = _window.parent.document.querySelectorAll(selector);\n    [].some.call(potentialHosts, function (element) {\n        var _document = getContentDocument(element);\n        if (_document !== _window.document) {\n            return false;\n        }\n        _window._frameElement = element;\n        return true;\n    });\n    return _window._frameElement;\n}\nfunction getFrameElement(element) {\n    var _window = getWindow(element);\n    if (!_window.parent || _window.parent === _window) {\n        // if there is no parent browsing context,\n        // we're not going to get a frameElement either way\n        return null;\n    }\n    try {\n        // see https://developer.mozilla.org/en-US/docs/Web/API/Window/frameElement\n        // does not work within <embed> anywhere, and not within in <object> in IE\n        return _window.frameElement || findDocumentHostElement(_window);\n    }\n    catch (e) {\n        return null;\n    }\n}\n// https://www.w3.org/TR/html5/rendering.html#being-rendered\n// <area> is not rendered, but we *consider* it visible to simplfiy this function's usage\nvar notRenderedElementsPattern = /^(area)$/;\nfunction computedStyle(element, property) {\n    return window.getComputedStyle(element, null).getPropertyValue(property);\n}\nfunction notDisplayed(_path) {\n    return _path.some(function (element) {\n        // display:none is not visible (optimized away at layout)\n        return computedStyle(element, 'display') === 'none';\n    });\n}\nfunction notVisible(_path) {\n    // https://github.com/jquery/jquery-ui/blob/master/ui/core.js#L109-L114\n    // NOTE: a nested element can reverse visibility:hidden|collapse by explicitly setting visibility:visible\n    // NOTE: visibility can be [\"\", \"visible\", \"hidden\", \"collapse\"]\n    var hidden = findIndex(_path, function (element) {\n        var visibility = computedStyle(element, 'visibility');\n        return visibility === 'hidden' || visibility === 'collapse';\n    });\n    if (hidden === -1) {\n        // there is no hidden element\n        return false;\n    }\n    var visible = findIndex(_path, function (element) {\n        return computedStyle(element, 'visibility') === 'visible';\n    });\n    if (visible === -1) {\n        // there is no visible element (but a hidden element)\n        return true;\n    }\n    if (hidden < visible) {\n        // there is a hidden element and it's closer than the first visible element\n        return true;\n    }\n    // there may be a hidden element, but the closest element is visible\n    return false;\n}\nfunction collapsedParent(_path) {\n    var offset = 1;\n    if (_path[0].nodeName.toLowerCase() === 'summary') {\n        offset = 2;\n    }\n    return _path.slice(offset).some(function (element) {\n        // \"content children\" of a closed details element are not visible\n        return (element.nodeName.toLowerCase() === 'details' && element.open === false);\n    });\n}\nfunction isVisibleRules() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, _ref$except = _ref.except, except = _ref$except === undefined\n        ? {\n            notRendered: false,\n            cssDisplay: false,\n            cssVisibility: false,\n            detailsElement: false,\n            browsingContext: false\n        }\n        : _ref$except;\n    var element = contextToElement({\n        label: 'is/visible',\n        resolveDocument: true,\n        context: context\n    });\n    var nodeName = element.nodeName.toLowerCase();\n    if (!except.notRendered && notRenderedElementsPattern.test(nodeName)) {\n        return true;\n    }\n    var _path = getParents({ context: element });\n    // in Internet Explorer <audio> has a default display: none, where others have display: inline\n    // but IE allows focusing <audio style=\"display:none\">, but not <div display:none><audio>\n    // this is irrelevant to other browsers, as the controls attribute is required to make <audio> focusable\n    var isAudioWithoutControls = nodeName === 'audio' && !element.hasAttribute('controls');\n    if (!except.cssDisplay &&\n        notDisplayed(isAudioWithoutControls ? _path.slice(1) : _path)) {\n        return false;\n    }\n    if (!except.cssVisibility && notVisible(_path)) {\n        return false;\n    }\n    if (!except.detailsElement && collapsedParent(_path)) {\n        return false;\n    }\n    if (!except.browsingContext) {\n        // elements within a browsing context are affected by the\n        // browsing context host element's visibility and tabindex\n        var frameElement = getFrameElement(element);\n        var _isVisible = isVisibleRules.except(except);\n        if (frameElement && !_isVisible(frameElement)) {\n            return false;\n        }\n    }\n    return true;\n}\n// bind exceptions to an iterator callback\nisVisibleRules.except = function () {\n    var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var isVisible = function isVisible(context) {\n        return isVisibleRules({\n            context: context,\n            except: except\n        });\n    };\n    isVisible.rules = isVisibleRules;\n    return isVisible;\n};\n// provide isVisible(context) as default iterator callback\nvar isVisible = isVisibleRules.except({});\nfunction getMapByName(name, _document) {\n    // apparently getElementsByName() also considers id attribute in IE & opera\n    // https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByName\n    var map = _document.querySelector('map[name=\"' + css_escape_1[\"default\"](name) + '\"]');\n    return map || null;\n}\nfunction getImageOfArea(element) {\n    var map = element.parentElement;\n    if (!map.name || map.nodeName.toLowerCase() !== 'map') {\n        return null;\n    }\n    // NOTE: image maps can also be applied to <object> with image content,\n    // but no browser supports this at the moment\n    // HTML5 specifies HTMLMapElement.images to be an HTMLCollection of all\n    // <img> and <object> referencing the <map> element, but no browser implements this\n    //   https://www.w3.org/TR/html5/embedded-content-0.html#the-map-element\n    //   https://developer.mozilla.org/en-US/docs/Web/API/HTMLMapElement\n    // the image must be valid and loaded for the map to take effect\n    var _document = getDocument(element);\n    return (_document.querySelector('img[usemap=\"#' + css_escape_1[\"default\"](map.name) + '\"]') ||\n        null);\n}\nvar supports$2 = void 0;\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/map\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\n// https://github.com/jquery/jquery-ui/blob/master/ui/core.js#L88-L107\nfunction isValidArea(context) {\n    if (!supports$2) {\n        supports$2 = _supports();\n    }\n    var element = contextToElement({\n        label: 'is/valid-area',\n        context: context\n    });\n    var nodeName = element.nodeName.toLowerCase();\n    if (nodeName !== 'area') {\n        return false;\n    }\n    var hasTabindex = element.hasAttribute('tabindex');\n    if (!supports$2.focusAreaTabindex && hasTabindex) {\n        // Blink and WebKit do not consider <area tabindex=\"-1\" href=\"#void\"> focusable\n        return false;\n    }\n    var img = getImageOfArea(element);\n    if (!img || !isVisible(img)) {\n        return false;\n    }\n    // Firefox only allows fully loaded images to reference image maps\n    // https://stereochro.me/ideas/detecting-broken-images-js\n    if (!supports$2.focusBrokenImageMap &&\n        (!img.complete ||\n            !img.naturalHeight ||\n            img.offsetWidth <= 0 ||\n            img.offsetHeight <= 0)) {\n        return false;\n    }\n    // Firefox supports.can focus area elements even if they don't have an href attribute\n    if (!supports$2.focusAreaWithoutHref && !element.href) {\n        // Internet explorer supports.can focus area elements without href if either\n        // the area element or the image element has a tabindex attribute\n        return ((supports$2.focusAreaTabindex && hasTabindex) ||\n            (supports$2.focusAreaImgTabindex && img.hasAttribute('tabindex')));\n    }\n    // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-usemap\n    var childOfInteractive = getParents({ context: img })\n        .slice(1)\n        .some(function (_element) {\n        var name = _element.nodeName.toLowerCase();\n        return name === 'button' || name === 'a';\n    });\n    if (childOfInteractive) {\n        return false;\n    }\n    return true;\n}\nvar supports$3 = void 0;\n// https://www.w3.org/TR/html5/disabled-elements.html#concept-element-disabled\nvar disabledElementsPattern = void 0;\nvar disabledElements = {\n    input: true,\n    select: true,\n    textarea: true,\n    button: true,\n    fieldset: true,\n    form: true\n};\nfunction isNativeDisabledSupported(context) {\n    if (!supports$3) {\n        supports$3 = _supports();\n        if (supports$3.focusFieldsetDisabled) {\n            delete disabledElements.fieldset;\n        }\n        if (supports$3.focusFormDisabled) {\n            delete disabledElements.form;\n        }\n        disabledElementsPattern = new RegExp('^(' + Object.keys(disabledElements).join('|') + ')$');\n    }\n    var element = contextToElement({\n        label: 'is/native-disabled-supported',\n        context: context\n    });\n    var nodeName = element.nodeName.toLowerCase();\n    return Boolean(disabledElementsPattern.test(nodeName));\n}\nvar supports$4 = void 0;\nfunction isDisabledFieldset(element) {\n    var nodeName = element.nodeName.toLowerCase();\n    return nodeName === 'fieldset' && element.disabled;\n}\nfunction isDisabledForm(element) {\n    var nodeName = element.nodeName.toLowerCase();\n    return nodeName === 'form' && element.disabled;\n}\nfunction isDisabled(context) {\n    if (!supports$4) {\n        supports$4 = _supports();\n    }\n    var element = contextToElement({\n        label: 'is/disabled',\n        context: context\n    });\n    if (element.hasAttribute('data-ally-disabled')) {\n        // treat ally's element/disabled like the DOM native element.disabled\n        return true;\n    }\n    if (!isNativeDisabledSupported(element)) {\n        // non-form elements do not support the disabled attribute\n        return false;\n    }\n    if (element.disabled) {\n        // the element itself is disabled\n        return true;\n    }\n    var parents = getParents({ context: element });\n    if (parents.some(isDisabledFieldset)) {\n        // a parental <fieldset> is disabld and inherits the state onto this element\n        return true;\n    }\n    if (!supports$4.focusFormDisabled && parents.some(isDisabledForm)) {\n        // a parental <form> is disabld and inherits the state onto this element\n        return true;\n    }\n    return false;\n}\nfunction isOnlyTabbableRules() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, _ref$except = _ref.except, except = _ref$except === undefined\n        ? {\n            onlyFocusableBrowsingContext: false,\n            visible: false\n        }\n        : _ref$except;\n    var element = contextToElement({\n        label: 'is/only-tabbable',\n        resolveDocument: true,\n        context: context\n    });\n    if (!except.visible && !isVisible(element)) {\n        return false;\n    }\n    if (!except.onlyFocusableBrowsingContext &&\n        (platform.is.GECKO || platform.is.TRIDENT || platform.is.EDGE)) {\n        var frameElement = getFrameElement(element);\n        if (frameElement) {\n            if (tabindexValue(frameElement) < 0) {\n                // iframe[tabindex=\"-1\"] and object[tabindex=\"-1\"] inherit the\n                // tabbable demotion onto elements of their browsing contexts\n                return false;\n            }\n        }\n    }\n    var nodeName = element.nodeName.toLowerCase();\n    var tabindex = tabindexValue(element);\n    if (nodeName === 'label' && platform.is.GECKO) {\n        // Firefox cannot focus, but tab to: label[tabindex=0]\n        return tabindex !== null && tabindex >= 0;\n    }\n    // SVG Elements were keyboard focusable but not script focusable before Firefox 51.\n    // Firefox 51 added the focus management DOM API (.focus and .blur) to SVGElement,\n    // see https://bugzilla.mozilla.org/show_bug.cgi?id=778654\n    if (platform.is.GECKO && element.ownerSVGElement && !element.focus) {\n        if (nodeName === 'a' && element.hasAttribute('xlink:href')) {\n            // any focusable child of <svg> cannot be focused, but tabbed to\n            if (platform.is.GECKO) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n// bind exceptions to an iterator callback\nisOnlyTabbableRules.except = function () {\n    var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var isOnlyTabbable = function isOnlyTabbable(context) {\n        return isOnlyTabbableRules({\n            context: context,\n            except: except\n        });\n    };\n    isOnlyTabbable.rules = isOnlyTabbableRules;\n    return isOnlyTabbable;\n};\n// provide isOnlyTabbable(context) as default iterator callback\nvar isOnlyTabbable = isOnlyTabbableRules.except({});\nvar supports$5 = void 0;\nfunction isOnlyFocusRelevant(element) {\n    var nodeName = element.nodeName.toLowerCase();\n    if (nodeName === 'embed' || nodeName === 'keygen') {\n        // embed is considered focus-relevant but not focusable\n        // see https://github.com/medialize/ally.js/issues/82\n        return true;\n    }\n    var _tabindex = tabindexValue(element);\n    if (element.shadowRoot && _tabindex === null) {\n        // ShadowDOM host elements *may* receive focus\n        // even though they are not considered focuable\n        return true;\n    }\n    if (nodeName === 'label') {\n        // <label tabindex=\"0\"> is only tabbable in Firefox, not script-focusable\n        // there's no way to make an element focusable other than by adding a tabindex,\n        // and focus behavior of the label element seems hard-wired to ignore tabindex\n        // in some browsers (like Gecko, Blink and WebKit)\n        return !supports$5.focusLabelTabindex || _tabindex === null;\n    }\n    if (nodeName === 'legend') {\n        return _tabindex === null;\n    }\n    if (supports$5.focusSvgFocusableAttribute &&\n        (element.ownerSVGElement || nodeName === 'svg')) {\n        // Internet Explorer understands the focusable attribute introduced in SVG Tiny 1.2\n        var focusableAttribute = element.getAttribute('focusable');\n        return focusableAttribute && focusableAttribute === 'false';\n    }\n    if (nodeName === 'img' && element.hasAttribute('usemap')) {\n        // Gecko, Trident and Edge do not allow an image with an image map and tabindex to be focused,\n        // it appears the tabindex is overruled so focus is still forwarded to the <map>\n        return _tabindex === null || !supports$5.focusImgUsemapTabindex;\n    }\n    if (nodeName === 'area') {\n        // all <area>s are considered relevant,\n        // but only the valid <area>s are focusable\n        return !isValidArea(element);\n    }\n    return false;\n}\nfunction isFocusableRules() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, _ref$except = _ref.except, except = _ref$except === undefined\n        ? {\n            disabled: false,\n            visible: false,\n            onlyTabbable: false\n        }\n        : _ref$except;\n    if (!supports$5) {\n        supports$5 = _supports();\n    }\n    var _isOnlyTabbable = isOnlyTabbable.rules.except({\n        onlyFocusableBrowsingContext: true,\n        visible: except.visible\n    });\n    var element = contextToElement({\n        label: 'is/focusable',\n        resolveDocument: true,\n        context: context\n    });\n    var focusRelevant = isFocusRelevant.rules({\n        context: element,\n        except: except\n    });\n    if (!focusRelevant || isOnlyFocusRelevant(element)) {\n        return false;\n    }\n    if (!except.disabled && isDisabled(element)) {\n        return false;\n    }\n    if (!except.onlyTabbable && _isOnlyTabbable(element)) {\n        // some elements may be keyboard focusable, but not script focusable\n        return false;\n    }\n    // elements that are not rendered, cannot be focused\n    if (!except.visible) {\n        var visibilityOptions = {\n            context: element,\n            except: {}\n        };\n        if (supports$5.focusInHiddenIframe) {\n            // WebKit and Blink can focus content in hidden <iframe> and <object>\n            visibilityOptions.except.browsingContext = true;\n        }\n        if (supports$5.focusObjectSvgHidden) {\n            // Blink allows focusing the object element, even if it has visibility: hidden;\n            // @browser-issue Blink https://code.google.com/p/chromium/issues/detail?id=586191\n            var _nodeName2 = element.nodeName.toLowerCase();\n            if (_nodeName2 === 'object') {\n                visibilityOptions.except.cssVisibility = true;\n            }\n        }\n        if (!isVisible.rules(visibilityOptions)) {\n            return false;\n        }\n    }\n    var frameElement = getFrameElement(element);\n    if (frameElement) {\n        var _nodeName = frameElement.nodeName.toLowerCase();\n        if (_nodeName === 'object' && !supports$5.focusInZeroDimensionObject) {\n            if (!frameElement.offsetWidth || !frameElement.offsetHeight) {\n                // WebKit can not focus content in <object> if it doesn't have dimensions\n                return false;\n            }\n        }\n    }\n    var nodeName = element.nodeName.toLowerCase();\n    if (nodeName === 'svg' &&\n        supports$5.focusSvgInIframe &&\n        !frameElement &&\n        element.getAttribute('tabindex') === null) {\n        return false;\n    }\n    return true;\n}\n// bind exceptions to an iterator callback\nisFocusableRules.except = function () {\n    var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var isFocusable = function isFocusable(context) {\n        return isFocusableRules({\n            context: context,\n            except: except\n        });\n    };\n    isFocusable.rules = isFocusableRules;\n    return isFocusable;\n};\n// provide isFocusRelevant(context) as default iterator callback\nvar isFocusable = isFocusableRules.except({});\nfunction createFilter(condition) {\n    // see https://developer.mozilla.org/en-US/docs/Web/API/NodeFilter\n    var filter = function filter(node) {\n        if (node.shadowRoot) {\n            // return ShadowRoot elements regardless of them being focusable,\n            // so they can be walked recursively later\n            return NodeFilter.FILTER_ACCEPT;\n        }\n        if (condition(node)) {\n            // finds elements that could have been found by document.querySelectorAll()\n            return NodeFilter.FILTER_ACCEPT;\n        }\n        return NodeFilter.FILTER_SKIP;\n    };\n    // IE requires a function, Browsers require {acceptNode: function}\n    // see http://www.bennadel.com/blog/2607-finding-html-comment-nodes-in-the-dom-using-treewalker.htm\n    filter.acceptNode = filter;\n    return filter;\n}\nvar PossiblyFocusableFilter = createFilter(isFocusRelevant);\nfunction queryFocusableStrict() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, includeContext = _ref.includeContext, includeOnlyTabbable = _ref.includeOnlyTabbable, strategy = _ref.strategy;\n    if (!context) {\n        context = document.documentElement;\n    }\n    var _isFocusable = isFocusable.rules.except({\n        onlyTabbable: includeOnlyTabbable\n    });\n    var _document = getDocument(context);\n    // see https://developer.mozilla.org/en-US/docs/Web/API/Document/createTreeWalker\n    var walker = _document.createTreeWalker(\n    // root element to start search in\n    context, \n    // element type filter\n    NodeFilter.SHOW_ELEMENT, \n    // custom NodeFilter filter\n    strategy === 'all' ? PossiblyFocusableFilter : createFilter(_isFocusable), \n    // deprecated, but IE requires it\n    false);\n    var list = [];\n    while (walker.nextNode()) {\n        if (walker.currentNode.shadowRoot) {\n            if (_isFocusable(walker.currentNode)) {\n                list.push(walker.currentNode);\n            }\n            list = list.concat(queryFocusableStrict({\n                context: walker.currentNode.shadowRoot,\n                includeOnlyTabbable: includeOnlyTabbable,\n                strategy: strategy\n            }));\n        }\n        else {\n            list.push(walker.currentNode);\n        }\n    }\n    // add context if requested and focusable\n    if (includeContext) {\n        if (strategy === 'all') {\n            if (isFocusRelevant(context)) {\n                list.unshift(context);\n            }\n        }\n        else if (_isFocusable(context)) {\n            list.unshift(context);\n        }\n    }\n    return list;\n}\n// NOTE: this selector MUST *never* be used directly,\nvar supports$6 = void 0;\nvar selector$1 = void 0;\nfunction selector$2() {\n    if (!supports$6) {\n        supports$6 = _supports();\n    }\n    if (typeof selector$1 === 'string') {\n        return selector$1;\n    }\n    // https://www.w3.org/TR/html5/editing.html#sequential-focus-navigation-and-the-tabindex-attribute\n    selector$1 =\n        '' +\n            // IE11 supports.can focus <table> and <td>\n            (supports$6.focusTable ? 'table, td,' : '') +\n            // IE11 supports.can focus <fieldset>\n            (supports$6.focusFieldset ? 'fieldset,' : '') +\n            // Namespace problems of [xlink:href] explained in https://stackoverflow.com/a/23047888/515124\n            // svg a[*|href] does not match in IE9, but since we're filtering\n            // through is/focusable we can include all <a> from SVG\n            'svg a,' +\n            // may behave as 'svg, svg *,' in chrome as *every* svg element with a focus event listener is focusable\n            // navigational elements\n            'a[href],' +\n            // validity determined by is/valid-area.js\n            'area[href],' +\n            // validity determined by is/disabled.js\n            'input, select, textarea, button,' +\n            // browsing context containers\n            'iframe, object, embed,' +\n            // interactive content\n            'keygen,' +\n            (supports$6.focusAudioWithoutControls ? 'audio,' : 'audio[controls],') +\n            (supports$6.focusVideoWithoutControls ? 'video,' : 'video[controls],') +\n            (supports$6.focusSummary ? 'summary,' : '') +\n            // validity determined by is/valid-tabindex.js\n            '[tabindex],' +\n            // editing hosts\n            '[contenteditable]';\n    // where ShadowDOM is supported, we also want the shadowed focusable elements (via \">>>\" or \"/deep/\")\n    selector$1 = selectInShadows(selector$1);\n    return selector$1;\n}\nfunction queryFocusableQuick() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, includeContext = _ref.includeContext, includeOnlyTabbable = _ref.includeOnlyTabbable;\n    var _selector = selector$2();\n    var elements = context.querySelectorAll(_selector);\n    // the selector potentially matches more than really is focusable\n    var _isFocusable = isFocusable.rules.except({\n        onlyTabbable: includeOnlyTabbable\n    });\n    var result = [].filter.call(elements, _isFocusable);\n    // add context if requested and focusable\n    if (includeContext && _isFocusable(context)) {\n        result.unshift(context);\n    }\n    return result;\n}\nfunction queryFocusable() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, includeContext = _ref.includeContext, includeOnlyTabbable = _ref.includeOnlyTabbable, _ref$strategy = _ref.strategy, strategy = _ref$strategy === undefined ? 'quick' : _ref$strategy;\n    var element = contextToElement({\n        label: 'query/focusable',\n        resolveDocument: true,\n        defaultToDocument: true,\n        context: context\n    });\n    var options = {\n        context: element,\n        includeContext: includeContext,\n        includeOnlyTabbable: includeOnlyTabbable,\n        strategy: strategy\n    };\n    if (strategy === 'quick') {\n        return queryFocusableQuick(options);\n    }\n    else if (strategy === 'strict' || strategy === 'all') {\n        return queryFocusableStrict(options);\n    }\n    throw new TypeError('query/focusable requires option.strategy to be one of [\"quick\", \"strict\", \"all\"]');\n}\nvar supports$7 = void 0;\n// Internet Explorer 11 considers fieldset, table, td focusable, but not tabbable\n// Internet Explorer 11 considers body to have [tabindex=0], but does not allow tabbing to it\nvar focusableElementsPattern = /^(fieldset|table|td|body)$/;\nfunction isTabbableRules() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, _ref$except = _ref.except, except = _ref$except === undefined\n        ? {\n            flexbox: false,\n            scrollable: false,\n            shadow: false,\n            visible: false,\n            onlyTabbable: false\n        }\n        : _ref$except;\n    if (!supports$7) {\n        supports$7 = _supports();\n    }\n    var element = contextToElement({\n        label: 'is/tabbable',\n        resolveDocument: true,\n        context: context\n    });\n    if (platform.is.BLINK && platform.is.ANDROID && platform.majorVersion > 42) {\n        // External keyboard support worked fine in CHrome 42, but stopped working in Chrome 45.\n        // The on-screen keyboard does not provide a way to focus the next input element (like iOS does).\n        // That leaves us with no option to advance focus by keyboard, ergo nothing is tabbable (keyboard focusable).\n        return false;\n    }\n    var frameElement = getFrameElement(element);\n    if (frameElement) {\n        if (platform.is.WEBKIT && platform.is.IOS) {\n            // iOS only does not consider anything from another browsing context keyboard focusable\n            return false;\n        }\n        // iframe[tabindex=\"-1\"] and object[tabindex=\"-1\"] inherit the\n        // tabbable demotion onto elements of their browsing contexts\n        if (tabindexValue(frameElement) < 0) {\n            return false;\n        }\n        if (!except.visible &&\n            (platform.is.BLINK || platform.is.WEBKIT) &&\n            !isVisible(frameElement)) {\n            // Blink and WebKit consider elements in hidden browsing contexts focusable, but not tabbable\n            return false;\n        }\n        // Webkit and Blink don't consider anything in <object> tabbable\n        // Blink fixed that fixed in Chrome 54, Opera 41\n        var frameNodeName = frameElement.nodeName.toLowerCase();\n        if (frameNodeName === 'object') {\n            var isFixedBlink = (platform.name === 'Chrome' && platform.majorVersion >= 54) ||\n                (platform.name === 'Opera' && platform.majorVersion >= 41);\n            if (platform.is.WEBKIT || (platform.is.BLINK && !isFixedBlink)) {\n                return false;\n            }\n        }\n    }\n    var nodeName = element.nodeName.toLowerCase();\n    var _tabindex = tabindexValue(element);\n    var tabindex = _tabindex === null ? null : _tabindex >= 0;\n    if (platform.is.EDGE &&\n        platform.majorVersion >= 14 &&\n        frameElement &&\n        element.ownerSVGElement &&\n        _tabindex < 0) {\n        // Edge 14+ considers <a xlink:href=\"â€¦\" tabindex=\"-1\"> keyboard focusable\n        // if the element is in a nested browsing context\n        return true;\n    }\n    var hasTabbableTabindexOrNone = tabindex !== false;\n    var hasTabbableTabindex = _tabindex !== null && _tabindex >= 0;\n    // NOTE: Firefox 31 considers [contenteditable] to have [tabindex=-1], but allows tabbing to it\n    // fixed in Firefox 40 the latest - https://bugzilla.mozilla.org/show_bug.cgi?id=1185657\n    if (element.hasAttribute('contenteditable')) {\n        // tabbing can still be disabled by explicitly providing [tabindex=\"-1\"]\n        return hasTabbableTabindexOrNone;\n    }\n    if (focusableElementsPattern.test(nodeName) && tabindex !== true) {\n        return false;\n    }\n    if (platform.is.WEBKIT && platform.is.IOS) {\n        // iOS only considers a hand full of elements tabbable (keyboard focusable)\n        // this holds true even with external keyboards\n        var potentiallyTabbable = (nodeName === 'input' && element.type === 'text') ||\n            element.type === 'password' ||\n            nodeName === 'select' ||\n            nodeName === 'textarea' ||\n            element.hasAttribute('contenteditable');\n        if (!potentiallyTabbable) {\n            var style = window.getComputedStyle(element, null);\n            potentiallyTabbable = isUserModifyWritable(style);\n        }\n        if (!potentiallyTabbable) {\n            return false;\n        }\n    }\n    if (nodeName === 'use' && _tabindex !== null) {\n        if (platform.is.BLINK ||\n            (platform.is.WEBKIT && platform.majorVersion === 9)) {\n            // In Chrome and Safari 9 the <use> element is keyboard focusable even for tabindex=\"-1\"\n            return true;\n        }\n    }\n    if (elementMatches(element, 'svg a') && element.hasAttribute('xlink:href')) {\n        if (hasTabbableTabindexOrNone) {\n            // in Trident and Gecko SVGElement does not handle the tabIndex property properly\n            return true;\n        }\n        if (element.focus && !supports$7.focusSvgNegativeTabindexAttribute) {\n            // Firefox 51 and 52 treat any natively tabbable SVG element with\n            // tabindex=\"-1\" as tabbable and everything else as inert\n            // see https://bugzilla.mozilla.org/show_bug.cgi?id=1302340\n            return true;\n        }\n    }\n    if (nodeName === 'svg' &&\n        supports$7.focusSvgInIframe &&\n        hasTabbableTabindexOrNone) {\n        return true;\n    }\n    if (platform.is.TRIDENT || platform.is.EDGE) {\n        if (nodeName === 'svg') {\n            if (supports$7.focusSvg) {\n                // older Internet Explorers consider <svg> keyboard focusable\n                // unless they have focsable=\"false\", but then they wouldn't\n                // be focusable and thus not even reach this filter\n                return true;\n            }\n            // elements that have [focusable] are automatically keyboard focusable regardless of the attribute's value\n            return element.hasAttribute('focusable') || hasTabbableTabindex;\n        }\n        if (element.ownerSVGElement) {\n            if (supports$7.focusSvgTabindexAttribute && hasTabbableTabindex) {\n                return true;\n            }\n            // elements that have [focusable] are automatically keyboard focusable regardless of the attribute's value\n            return element.hasAttribute('focusable');\n        }\n    }\n    if (element.tabIndex === undefined) {\n        return Boolean(except.onlyTabbable);\n    }\n    if (nodeName === 'audio') {\n        if (!element.hasAttribute('controls')) {\n            // In Internet Explorer the <audio> element is focusable, but not tabbable, and tabIndex property is wrong\n            return false;\n        }\n        else if (platform.is.BLINK) {\n            // In Chrome <audio controls tabindex=\"-1\"> remains keyboard focusable\n            return true;\n        }\n    }\n    if (nodeName === 'video') {\n        if (!element.hasAttribute('controls')) {\n            if (platform.is.TRIDENT || platform.is.EDGE) {\n                // In Internet Explorer and Edge the <video> element is focusable, but not tabbable, and tabIndex property is wrong\n                return false;\n            }\n        }\n        else if (platform.is.BLINK || platform.is.GECKO) {\n            // In Chrome and Firefox <video controls tabindex=\"-1\"> remains keyboard focusable\n            return true;\n        }\n    }\n    if (nodeName === 'object') {\n        if (platform.is.BLINK || platform.is.WEBKIT) {\n            // In all Blink and WebKit based browsers <embed> and <object> are never keyboard focusable, even with tabindex=\"0\" set\n            return false;\n        }\n    }\n    if (nodeName === 'iframe') {\n        // In Internet Explorer all iframes are only focusable\n        // In WebKit, Blink and Gecko iframes may be tabbable depending on content.\n        // Since we can't reliably investigate iframe documents because of the\n        // SameOriginPolicy, we're declaring everything only focusable.\n        return false;\n    }\n    if (!except.scrollable && platform.is.GECKO) {\n        // Firefox considers scrollable containers keyboard focusable,\n        // even though their tabIndex property is -1\n        var _style = window.getComputedStyle(element, null);\n        if (hasCssOverflowScroll(_style)) {\n            return hasTabbableTabindexOrNone;\n        }\n    }\n    if (platform.is.TRIDENT || platform.is.EDGE) {\n        // IE and Edge degrade <area> to script focusable, if the image\n        // using the <map> has been given tabindex=\"-1\"\n        if (nodeName === 'area') {\n            var img = getImageOfArea(element);\n            if (img && tabindexValue(img) < 0) {\n                return false;\n            }\n        }\n        var _style2 = window.getComputedStyle(element, null);\n        if (isUserModifyWritable(_style2)) {\n            // prevent being swallowed by the overzealous isScrollableContainer() below\n            return element.tabIndex >= 0;\n        }\n        if (!except.flexbox && hasCssDisplayFlex(_style2)) {\n            if (_tabindex !== null) {\n                return hasTabbableTabindex;\n            }\n            return (isFocusRelevantWithoutFlexbox(element) &&\n                isTabbableWithoutFlexbox(element));\n        }\n        // IE considers scrollable containers script focusable only,\n        // even though their tabIndex property is 0\n        if (isScrollableContainer(element, nodeName)) {\n            return false;\n        }\n        var parent = element.parentElement;\n        if (parent) {\n            var parentNodeName = parent.nodeName.toLowerCase();\n            var parentStyle = window.getComputedStyle(parent, null);\n            // IE considers scrollable bodies script focusable only,\n            if (isScrollableContainer(parent, nodeName, parentNodeName, parentStyle)) {\n                return false;\n            }\n            // Children of focusable elements with display:flex are focusable in IE10-11,\n            // even though their tabIndex property suggests otherwise\n            if (hasCssDisplayFlex(parentStyle)) {\n                // value of tabindex takes precedence\n                return hasTabbableTabindex;\n            }\n        }\n    }\n    // https://www.w3.org/WAI/PF/aria-practices/#focus_tabindex\n    return element.tabIndex >= 0;\n}\n// bind exceptions to an iterator callback\nisTabbableRules.except = function () {\n    var except = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var isTabbable = function isTabbable(context) {\n        return isTabbableRules({\n            context: context,\n            except: except\n        });\n    };\n    isTabbable.rules = isTabbableRules;\n    return isTabbable;\n};\nvar isFocusRelevantWithoutFlexbox = isFocusRelevant.rules.except({\n    flexbox: true\n});\nvar isTabbableWithoutFlexbox = isTabbableRules.except({ flexbox: true });\n// provide isTabbable(context) as default iterator callback\nvar isTabbable = isTabbableRules.except({});\nfunction queryTabbable() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, includeContext = _ref.includeContext, includeOnlyTabbable = _ref.includeOnlyTabbable, strategy = _ref.strategy;\n    var _isTabbable = isTabbable.rules.except({\n        onlyTabbable: includeOnlyTabbable\n    });\n    return queryFocusable({\n        context: context,\n        includeContext: includeContext,\n        includeOnlyTabbable: includeOnlyTabbable,\n        strategy: strategy\n    }).filter(_isTabbable);\n}\n// sorts a list of elements according to their order in the DOM\nfunction compareDomPosition(a, b) {\n    return a.compareDocumentPosition(b) & Node.DOCUMENT_POSITION_FOLLOWING\n        ? -1\n        : 1;\n}\nfunction sortDomOrder(elements) {\n    return elements.sort(compareDomPosition);\n}\nfunction getFirstSuccessorOffset(list, target) {\n    // find the first element that comes AFTER the target element\n    return findIndex(list, function (element) {\n        return (target.compareDocumentPosition(element) & Node.DOCUMENT_POSITION_FOLLOWING);\n    });\n}\nfunction findInsertionOffsets(list, elements, resolveElement) {\n    // instead of mutating the elements list directly, remember position and map\n    // to inject later, when we can do this more efficiently\n    var insertions = [];\n    elements.forEach(function (element) {\n        var replace = true;\n        var offset = list.indexOf(element);\n        if (offset === -1) {\n            // element is not in target list\n            offset = getFirstSuccessorOffset(list, element);\n            replace = false;\n        }\n        if (offset === -1) {\n            // there is no successor in the tabsequence,\n            // meaning the image must be the last element\n            offset = list.length;\n        }\n        // allow the consumer to replace the injected element\n        var injections = nodeArray(resolveElement ? resolveElement(element) : element);\n        if (!injections.length) {\n            // we can't inject zero elements\n            return;\n        }\n        insertions.push({\n            offset: offset,\n            replace: replace,\n            elements: injections\n        });\n    });\n    return insertions;\n}\nfunction insertElementsAtOffsets(list, insertions) {\n    // remember the number of elements we have already injected\n    // so we account for the caused index offset\n    var inserted = 0;\n    // make sure that we insert the elements in sequence,\n    // otherwise the offset compensation won't work\n    insertions.sort(function (a, b) {\n        return a.offset - b.offset;\n    });\n    insertions.forEach(function (insertion) {\n        // array.splice has an annoying function signature :(\n        var remove = insertion.replace ? 1 : 0;\n        var args = [insertion.offset + inserted, remove].concat(insertion.elements);\n        list.splice.apply(list, args);\n        inserted += insertion.elements.length - remove;\n    });\n}\nfunction mergeInDomOrder() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, list = _ref.list, elements = _ref.elements, resolveElement = _ref.resolveElement;\n    // operate on a copy so we don't mutate the original array\n    var _list = list.slice(0);\n    // make sure the elements we're injecting are provided in DOM order\n    var _elements = nodeArray(elements).slice(0);\n    sortDomOrder(_elements);\n    // find the offsets within the target array (list) at which to inject\n    // each individual element (from elements)\n    var insertions = findInsertionOffsets(_list, _elements, resolveElement);\n    // actually inject the elements into the target array at the identified positions\n    insertElementsAtOffsets(_list, insertions);\n    return _list;\n}\nvar _createClass = (function () {\n    function defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if ('value' in descriptor)\n                descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n        }\n    }\n    return function (Constructor, protoProps, staticProps) {\n        if (protoProps)\n            defineProperties(Constructor.prototype, protoProps);\n        if (staticProps)\n            defineProperties(Constructor, staticProps);\n        return Constructor;\n    };\n})();\nfunction _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n        throw new TypeError('Cannot call a class as a function');\n    }\n}\nvar Maps = (function () {\n    function Maps(context) {\n        _classCallCheck(this, Maps);\n        this._document = getDocument(context);\n        this.maps = {};\n    }\n    _createClass(Maps, [\n        {\n            key: 'getAreasFor',\n            value: function getAreasFor(name) {\n                if (!this.maps[name]) {\n                    // the map is not defined within the context, so we\n                    // have to go find it elsewhere in the document\n                    this.addMapByName(name);\n                }\n                return this.maps[name];\n            }\n        },\n        {\n            key: 'addMapByName',\n            value: function addMapByName(name) {\n                var map = getMapByName(name, this._document);\n                if (!map) {\n                    // if there is no map, the img[usemap] wasn't doing anything anyway\n                    return;\n                }\n                this.maps[map.name] = queryTabbable({ context: map });\n            }\n        },\n        {\n            key: 'extractAreasFromList',\n            value: function extractAreasFromList(elements) {\n                // remove all <area> elements from the elements list,\n                // but put them the map for later retrieval\n                return elements.filter(function (element) {\n                    var nodeName = element.nodeName.toLowerCase();\n                    if (nodeName !== 'area') {\n                        return true;\n                    }\n                    var map = element.parentNode;\n                    if (!this.maps[map.name]) {\n                        this.maps[map.name] = [];\n                    }\n                    this.maps[map.name].push(element);\n                    return false;\n                }, this);\n            }\n        },\n    ]);\n    return Maps;\n})();\nfunction sortArea(elements, context) {\n    // images - unless they are focusable themselves, likely not\n    // part of the elements list, so we'll have to find them and\n    // sort them into the elements list manually\n    var usemaps = context.querySelectorAll('img[usemap]');\n    var maps = new Maps(context);\n    // remove all <area> elements from the elements list,\n    // but put them the map for later retrieval\n    var _elements = maps.extractAreasFromList(elements);\n    if (!usemaps.length) {\n        // the context does not contain any <area>s so no need\n        // to replace anything, just remove any maps\n        return _elements;\n    }\n    return mergeInDomOrder({\n        list: _elements,\n        elements: usemaps,\n        resolveElement: function resolveElement(image) {\n            var name = image.getAttribute('usemap').slice(1);\n            return maps.getAreasFor(name);\n        }\n    });\n}\nvar _createClass$1 = (function () {\n    function defineProperties(target, props) {\n        for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if ('value' in descriptor)\n                descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n        }\n    }\n    return function (Constructor, protoProps, staticProps) {\n        if (protoProps)\n            defineProperties(Constructor.prototype, protoProps);\n        if (staticProps)\n            defineProperties(Constructor, staticProps);\n        return Constructor;\n    };\n})();\nfunction _classCallCheck$1(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n        throw new TypeError('Cannot call a class as a function');\n    }\n}\nvar Shadows = (function () {\n    function Shadows(context, sortElements) {\n        _classCallCheck$1(this, Shadows);\n        // document context we're working with\n        this.context = context;\n        // callback that sorts an array of elements\n        this.sortElements = sortElements;\n        // reference to create unique IDs for each ShadowHost\n        this.hostCounter = 1;\n        // reference map for child-ShadowHosts of a ShadowHost\n        this.inHost = {};\n        // reference map for child-ShadowHost of the document\n        this.inDocument = [];\n        // reference map for ShadowHosts\n        this.hosts = {};\n        // reference map for tabbable elements of a ShadowHost\n        this.elements = {};\n    }\n    // remember which hosts we have to sort within later\n    _createClass$1(Shadows, [\n        {\n            key: '_registerHost',\n            value: function _registerHost(host) {\n                if (host._sortingId) {\n                    return;\n                }\n                // make the ShadowHost identifiable (see cleanup() for undo)\n                host._sortingId = 'shadow-' + this.hostCounter++;\n                this.hosts[host._sortingId] = host;\n                // hosts may contain other hosts\n                var parentHost = getShadowHost({ context: host });\n                if (parentHost) {\n                    this._registerHost(parentHost);\n                    this._registerHostParent(host, parentHost);\n                }\n                else {\n                    this.inDocument.push(host);\n                }\n            }\n        },\n        {\n            key: '_registerHostParent',\n            value: function _registerHostParent(host, parent) {\n                if (!this.inHost[parent._sortingId]) {\n                    this.inHost[parent._sortingId] = [];\n                }\n                this.inHost[parent._sortingId].push(host);\n            }\n        },\n        {\n            key: '_registerElement',\n            value: function _registerElement(element, host) {\n                if (!this.elements[host._sortingId]) {\n                    this.elements[host._sortingId] = [];\n                }\n                this.elements[host._sortingId].push(element);\n            }\n        },\n        {\n            key: 'extractElements',\n            value: function extractElements(elements) {\n                return elements.filter(function (element) {\n                    var host = getShadowHost({ context: element });\n                    if (!host) {\n                        return true;\n                    }\n                    this._registerHost(host);\n                    this._registerElement(element, host);\n                    return false;\n                }, this);\n            }\n        },\n        {\n            key: 'sort',\n            value: function sort(elements) {\n                var _elements = this._injectHosts(elements);\n                _elements = this._replaceHosts(_elements);\n                this._cleanup();\n                return _elements;\n            }\n        },\n        {\n            key: '_injectHosts',\n            value: function _injectHosts(elements) {\n                Object.keys(this.hosts).forEach(function (_sortingId) {\n                    var _list = this.elements[_sortingId];\n                    var _elements = this.inHost[_sortingId];\n                    var _context = this.hosts[_sortingId].shadowRoot;\n                    this.elements[_sortingId] = this._merge(_list, _elements, _context);\n                }, this);\n                return this._merge(elements, this.inDocument, this.context);\n            }\n        },\n        {\n            key: '_merge',\n            value: function _merge(list, elements, context) {\n                var merged = mergeInDomOrder({\n                    list: list,\n                    elements: elements\n                });\n                return this.sortElements(merged, context);\n            }\n        },\n        {\n            key: '_replaceHosts',\n            value: function _replaceHosts(elements) {\n                return mergeInDomOrder({\n                    list: elements,\n                    elements: this.inDocument,\n                    resolveElement: this._resolveHostElement.bind(this)\n                });\n            }\n        },\n        {\n            key: '_resolveHostElement',\n            value: function _resolveHostElement(host) {\n                var merged = mergeInDomOrder({\n                    list: this.elements[host._sortingId],\n                    elements: this.inHost[host._sortingId],\n                    resolveElement: this._resolveHostElement.bind(this)\n                });\n                var _tabindex = tabindexValue(host);\n                if (_tabindex !== null && _tabindex > -1) {\n                    return [host].concat(merged);\n                }\n                return merged;\n            }\n        },\n        {\n            key: '_cleanup',\n            value: function _cleanup() {\n                // remove those identifers we put on the ShadowHost to avoid using Map()\n                Object.keys(this.hosts).forEach(function (key) {\n                    delete this.hosts[key]._sortingId;\n                }, this);\n            }\n        },\n    ]);\n    return Shadows;\n})();\nfunction sortShadowed(elements, context, sortElements) {\n    var shadows = new Shadows(context, sortElements);\n    var _elements = shadows.extractElements(elements);\n    if (_elements.length === elements.length) {\n        // no shadowed content found, no need to continue\n        return sortElements(elements);\n    }\n    return shadows.sort(_elements);\n}\nfunction sortTabindex(elements) {\n    // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement.tabIndex\n    // elements with tabIndex \"0\" (including tabbableElements without tabIndex) should be navigated in the order they appear.\n    // elements with a positive tabIndex:\n    //   Elements that have identical tabIndexes should be navigated in the order they appear.\n    //   Navigation proceeds from the lowest tabIndex to the highest tabIndex.\n    // NOTE: sort implementation may be unstable and thus mess up DOM order,\n    // that's why we build a map that's being sorted instead. If we were able to rely\n    // on a stable sorting algorithm, sortTabindex() could be as simple as\n    // elements.sort(function(a, b) { return a.tabIndex - b.tabIndex; });\n    // at this time Chrome does not use a stable sorting algorithm\n    // see http://blog.rodneyrehm.de/archives/14-Sorting-Were-Doing-It-Wrong.html#stability\n    // NOTE: compareDocumentPosition seemed like more overhead than just sorting this with buckets\n    // https://developer.mozilla.org/en-US/docs/Web/API/Node.compareDocumentPosition\n    var map = {};\n    var indexes = [];\n    var normal = elements.filter(function (element) {\n        // in Trident and Gecko SVGElement does not know about the tabIndex property\n        var tabIndex = element.tabIndex;\n        if (tabIndex === undefined) {\n            tabIndex = tabindexValue(element);\n        }\n        // extract elements that don't need sorting\n        if (tabIndex <= 0 || tabIndex === null || tabIndex === undefined) {\n            return true;\n        }\n        if (!map[tabIndex]) {\n            // create sortable bucket for dom-order-preservation of elements with the same tabIndex\n            map[tabIndex] = [];\n            // maintain a list of unique tabIndexes\n            indexes.push(tabIndex);\n        }\n        // sort element into the proper bucket\n        map[tabIndex].push(element);\n        // element moved to sorting map, so not \"normal\" anymore\n        return false;\n    });\n    // sort the tabindex ascending,\n    // then resolve them to their appropriate buckets,\n    // then flatten the array of arrays to an array\n    var _elements = indexes\n        .sort()\n        .map(function (tabIndex) {\n        return map[tabIndex];\n    })\n        .reduceRight(function (previous, current) {\n        return current.concat(previous);\n    }, normal);\n    return _elements;\n}\nvar supports$8 = void 0;\nfunction moveContextToBeginning(elements, context) {\n    var pos = elements.indexOf(context);\n    if (pos > 0) {\n        var tmp = elements.splice(pos, 1);\n        return tmp.concat(elements);\n    }\n    return elements;\n}\nfunction sortElements(elements, _context) {\n    if (supports$8.tabsequenceAreaAtImgPosition) {\n        // Some browsers sort <area> in DOM order, some place the <area>s\n        // where the <img> referecing them would've been in DOM order.\n        // https://github.com/medialize/ally.js/issues/5\n        elements = sortArea(elements, _context);\n    }\n    elements = sortTabindex(elements);\n    return elements;\n}\nfunction queryTabsequence() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, context = _ref.context, includeContext = _ref.includeContext, includeOnlyTabbable = _ref.includeOnlyTabbable, strategy = _ref.strategy;\n    if (!supports$8) {\n        supports$8 = _supports();\n    }\n    var _context = nodeArray(context)[0] || document.documentElement;\n    var elements = queryTabbable({\n        context: _context,\n        includeContext: includeContext,\n        includeOnlyTabbable: includeOnlyTabbable,\n        strategy: strategy\n    });\n    if (document.body.createShadowRoot && platform.is.BLINK) {\n        // sort tabindex localized to shadow dom\n        // see https://github.com/medialize/ally.js/issues/6\n        elements = sortShadowed(elements, _context, sortElements);\n    }\n    else {\n        elements = sortElements(elements, _context);\n    }\n    if (includeContext) {\n        // if we include the context itself, it has to be the first\n        // element of the sequence\n        elements = moveContextToBeginning(elements, _context);\n    }\n    return elements;\n}\n// codes mostly cloned from https://github.com/keithamus/jwerty/blob/master/jwerty.js\n// deliberately not exposing characters like <,.-#* because they vary *wildly*\n// across keyboard layouts and may cause various problems\n// (e.g. \"*\" is \"Shift +\" on a German Mac keyboard)\n// (e.g. \"@\" is \"Alt L\" on a German Mac keyboard)\nvar keycode = {\n    // Element Focus\n    tab: 9,\n    // Navigation\n    left: 37,\n    up: 38,\n    right: 39,\n    down: 40,\n    pageUp: 33,\n    'page-up': 33,\n    pageDown: 34,\n    'page-down': 34,\n    end: 35,\n    home: 36,\n    // Action\n    enter: 13,\n    escape: 27,\n    space: 32,\n    // Modifier\n    shift: 16,\n    capsLock: 20,\n    'caps-lock': 20,\n    ctrl: 17,\n    alt: 18,\n    meta: 91,\n    // in firefox: 224\n    // on mac (chrome): meta-left=91, meta-right=93\n    // on win (IE11): meta-left=91, meta-right=92\n    pause: 19,\n    // Content Manipulation\n    insert: 45,\n    \"delete\": 46,\n    backspace: 8,\n    // the same logical key may be identified through different keyCodes\n    _alias: {\n        91: [92, 93, 224]\n    }\n};\n// Function keys (112 - 137)\n// NOTE: not every keyboard knows F13+\nfor (var n = 1; n < 26; n++) {\n    keycode['f' + n] = n + 111;\n}\n// Number keys (48-57, numpad 96-105)\n// NOTE: not every keyboard knows num-0+\nfor (var _n = 0; _n < 10; _n++) {\n    var code = _n + 48;\n    var numCode = _n + 96;\n    keycode[_n] = code;\n    keycode['num-' + _n] = numCode;\n    keycode._alias[code] = [numCode];\n}\n// Latin characters (65 - 90)\nfor (var _n2 = 0; _n2 < 26; _n2++) {\n    var _code = _n2 + 65;\n    var name$1 = String.fromCharCode(_code).toLowerCase();\n    keycode[name$1] = _code;\n}\nvar modifier = {\n    alt: 'altKey',\n    ctrl: 'ctrlKey',\n    meta: 'metaKey',\n    shift: 'shiftKey'\n};\nvar modifierSequence = Object.keys(modifier).map(function (name) {\n    return modifier[name];\n});\nfunction createExpectedModifiers(ignoreModifiers) {\n    var value = ignoreModifiers ? null : false;\n    return {\n        altKey: value,\n        ctrlKey: value,\n        metaKey: value,\n        shiftKey: value\n    };\n}\nfunction resolveModifiers(modifiers) {\n    var ignoreModifiers = modifiers.indexOf('*') !== -1;\n    var expected = createExpectedModifiers(ignoreModifiers);\n    modifiers.forEach(function (token) {\n        if (token === '*') {\n            // we've already covered the all-in operator\n            return;\n        }\n        // we want the modifier pressed\n        var value = true;\n        var operator = token.slice(0, 1);\n        if (operator === '?') {\n            // we don't care if the modifier is pressed\n            value = null;\n        }\n        else if (operator === '!') {\n            // we do not want the modifier pressed\n            value = false;\n        }\n        if (value !== true) {\n            // compensate for the modifier's operator\n            token = token.slice(1);\n        }\n        var propertyName = modifier[token];\n        if (!propertyName) {\n            throw new TypeError('Unknown modifier \"' + token + '\"');\n        }\n        expected[propertyName] = value;\n    });\n    return expected;\n}\nfunction resolveKey(key) {\n    var code = keycode[key] || parseInt(key, 10);\n    if (!code || typeof code !== 'number' || isNaN(code)) {\n        throw new TypeError('Unknown key \"' + key + '\"');\n    }\n    return [code].concat(keycode._alias[code] || []);\n}\nfunction matchModifiers(expected, event) {\n    // returns true on match\n    return !modifierSequence.some(function (prop) {\n        // returns true on mismatch\n        return (typeof expected[prop] === 'boolean' &&\n            Boolean(event[prop]) !== expected[prop]);\n    });\n}\nfunction keyBinding(text) {\n    return text.split(/\\s+/).map(function (_text) {\n        var tokens = _text.split('+');\n        var _modifiers = resolveModifiers(tokens.slice(0, -1));\n        var _keyCodes = resolveKey(tokens.slice(-1));\n        return {\n            keyCodes: _keyCodes,\n            modifiers: _modifiers,\n            matchModifiers: matchModifiers.bind(null, _modifiers)\n        };\n    });\n}\n// Node.compareDocumentPosition is available since IE9\n// see https://developer.mozilla.org/en-US/docs/Web/API/Node.compareDocumentPosition\n// callback returns true when element is contained by parent or is the parent suited for use with Array.some()\n/*\n  USAGE:\n    var isChildOf = getParentComparator({parent: someNode});\n    listOfElements.some(isChildOf)\n*/\nfunction getParentComparator() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}, parent = _ref.parent, element = _ref.element, includeSelf = _ref.includeSelf;\n    if (parent) {\n        return function isChildOf(node) {\n            return Boolean((includeSelf && node === parent) ||\n                parent.compareDocumentPosition(node) &\n                    Node.DOCUMENT_POSITION_CONTAINED_BY);\n        };\n    }\n    else if (element) {\n        return function isParentOf(node) {\n            return Boolean((includeSelf && element === node) ||\n                node.compareDocumentPosition(element) &\n                    Node.DOCUMENT_POSITION_CONTAINED_BY);\n        };\n    }\n    throw new TypeError('util/compare-position#getParentComparator required either options.parent or options.element');\n}\n// Bug 286933 - Key events in the autocomplete popup should be hidden from page scripts\n// @browser-issue Gecko https://bugzilla.mozilla.org/show_bug.cgi?id=286933\nfunction whenKey() {\n    var map = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var bindings = {};\n    var context = nodeArray(map.context)[0] || document.documentElement;\n    delete map.context;\n    var filter = nodeArray(map.filter);\n    delete map.filter;\n    var mapKeys = Object.keys(map);\n    if (!mapKeys.length) {\n        throw new TypeError('when/key requires at least one option key');\n    }\n    var registerBinding = function registerBinding(event) {\n        event.keyCodes.forEach(function (code) {\n            if (!bindings[code]) {\n                bindings[code] = [];\n            }\n            bindings[code].push(event);\n        });\n    };\n    mapKeys.forEach(function (text) {\n        if (typeof map[text] !== 'function') {\n            throw new TypeError('when/key requires option[\"' + text + '\"] to be a function');\n        }\n        var addCallback = function addCallback(event) {\n            event.callback = map[text];\n            return event;\n        };\n        keyBinding(text).map(addCallback).forEach(registerBinding);\n    });\n    var handleKeyDown = function handleKeyDown(event) {\n        if (event.defaultPrevented) {\n            return;\n        }\n        if (filter.length) {\n            // ignore elements within the exempted sub-trees\n            var isParentOfElement = getParentComparator({\n                element: event.target,\n                includeSelf: true\n            });\n            if (filter.some(isParentOfElement)) {\n                return;\n            }\n        }\n        var key = event.keyCode || event.which;\n        if (!bindings[key]) {\n            return;\n        }\n        bindings[key].forEach(function (_event) {\n            if (!_event.matchModifiers(event)) {\n                return;\n            }\n            _event.callback.call(context, event, disengage);\n        });\n    };\n    context.addEventListener('keydown', handleKeyDown, false);\n    var disengage = function disengage() {\n        context.removeEventListener('keydown', handleKeyDown, false);\n    };\n    return { disengage: disengage };\n}\nfunction default_1(_a) {\n    var context = (_a === void 0 ? {} : _a).context;\n    if (!context) {\n        context = document.documentElement;\n    }\n    // Make sure the supports tests are run before intercepting the Tab key,\n    // or IE10 and IE11 will fail to process the first Tab key event. Not\n    // limiting this warm-up to IE because it may be a problem elsewhere, too.\n    queryTabsequence();\n    return whenKey({\n        // Safari on OSX may require ALT+TAB to reach links,\n        // see https://github.com/medialize/ally.js/issues/146\n        '?alt+?shift+tab': function altShiftTab(event) {\n            // we're completely taking over the Tab key handling\n            event.preventDefault();\n            var sequence = queryTabsequence({\n                context: context\n            });\n            var backward = event.shiftKey;\n            var first = sequence[0];\n            var last = sequence[sequence.length - 1];\n            // wrap around first to last, last to first\n            var source = backward ? first : last;\n            var target = backward ? last : first;\n            if (isActiveElement(source)) {\n                target.focus();\n                return;\n            }\n            // find current position in tabsequence\n            var currentIndex = void 0;\n            var found = sequence.some(function (element, index) {\n                if (!isActiveElement(element)) {\n                    return false;\n                }\n                currentIndex = index;\n                return true;\n            });\n            if (!found) {\n                // redirect to first as we're not in our tabsequence\n                first.focus();\n                return;\n            }\n            // shift focus to previous/next element in the sequence\n            var offset = backward ? -1 : 1;\n            sequence[currentIndex + offset].focus();\n        }\n    });\n}\nexports[\"default\"] = default_1;\n//# sourceMappingURL=maintain--tab-focus.js.map"]},"metadata":{},"sourceType":"script"}